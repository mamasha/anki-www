var app=function(){"use strict";
/*!
   *  decimal.js v10.4.3
   *  An arbitrary-precision Decimal type for JavaScript.
   *  https://github.com/MikeMcl/decimal.js
   *  Copyright (c) 2022 Michael Mclaughlin <M8ch88l@gmail.com>
   *  MIT Licence
   */var EXP_LIMIT=9e15,MAX_DIGITS=1e9,NUMERALS="0123456789abcdef",LN10="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",PI="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",DEFAULTS={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-EXP_LIMIT,maxE:EXP_LIMIT,crypto:!1},inexact,quadrant,external=!0,decimalError="[DecimalError] ",invalidArgument=decimalError+"Invalid argument: ",precisionLimitExceeded=decimalError+"Precision limit exceeded",cryptoUnavailable=decimalError+"crypto unavailable",tag="[object Decimal]",mathfloor=Math.floor,mathpow=Math.pow,isBinary=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,isHex=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,isOctal=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,isDecimal=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,BASE=1e7,LOG_BASE=7,MAX_SAFE_INTEGER=9007199254740991,LN10_PRECISION=LN10.length-1,PI_PRECISION=PI.length-1,P={toStringTag:tag};function digitsToString(e){var t,n,r,u=e.length-1,a="",o=e[0];if(u>0){for(a+=o,t=1;t<u;t++)r=e[t]+"",(n=LOG_BASE-r.length)&&(a+=getZeroString(n)),a+=r;o=e[t],(n=LOG_BASE-(r=o+"").length)&&(a+=getZeroString(n))}else if(0===o)return"0";for(;o%10==0;)o/=10;return a+o}function checkInt32(e,t,n){if(e!==~~e||e<t||e>n)throw Error(invalidArgument+e)}function checkRoundingDigits(e,t,n,r){var u,a,o,i;for(a=e[0];a>=10;a/=10)--t;return--t<0?(t+=LOG_BASE,u=0):(u=Math.ceil((t+1)/LOG_BASE),t%=LOG_BASE),a=mathpow(10,LOG_BASE-t),i=e[u]%a|0,null==r?t<3?(0==t?i=i/100|0:1==t&&(i=i/10|0),o=n<4&&99999==i||n>3&&49999==i||5e4==i||0==i):o=(n<4&&i+1==a||n>3&&i+1==a/2)&&(e[u+1]/a/100|0)==mathpow(10,t-2)-1||(i==a/2||0==i)&&0==(e[u+1]/a/100|0):t<4?(0==t?i=i/1e3|0:1==t?i=i/100|0:2==t&&(i=i/10|0),o=(r||n<4)&&9999==i||!r&&n>3&&4999==i):o=((r||n<4)&&i+1==a||!r&&n>3&&i+1==a/2)&&(e[u+1]/a/1e3|0)==mathpow(10,t-3)-1,o}function convertBase(e,t,n){for(var r,u,a=[0],o=0,i=e.length;o<i;){for(u=a.length;u--;)a[u]*=t;for(a[0]+=NUMERALS.indexOf(e.charAt(o++)),r=0;r<a.length;r++)a[r]>n-1&&(void 0===a[r+1]&&(a[r+1]=0),a[r+1]+=a[r]/n|0,a[r]%=n)}return a.reverse()}function cosine(e,t){var n,r,u;if(t.isZero())return t;(r=t.d.length)<32?u=(1/tinyPow(4,n=Math.ceil(r/3))).toString():(n=16,u="2.3283064365386962890625e-10"),e.precision+=n,t=taylorSeries(e,1,t.times(u),new e(1));for(var a=n;a--;){var o=t.times(t);t=o.times(o).minus(o).times(8).plus(1)}return e.precision-=n,t}P.absoluteValue=P.abs=function(){var e=new this.constructor(this);return e.s<0&&(e.s=1),finalise(e)},P.ceil=function(){return finalise(new this.constructor(this),this.e+1,2)},P.clampedTo=P.clamp=function(e,t){var n=this,r=n.constructor;if(e=new r(e),t=new r(t),!e.s||!t.s)return new r(NaN);if(e.gt(t))throw Error(invalidArgument+t);return n.cmp(e)<0?e:n.cmp(t)>0?t:new r(n)},P.comparedTo=P.cmp=function(e){var t,n,r,u,a=this,o=a.d,i=(e=new a.constructor(e)).d,s=a.s,c=e.s;if(!o||!i)return s&&c?s!==c?s:o===i?0:!o^s<0?1:-1:NaN;if(!o[0]||!i[0])return o[0]?s:i[0]?-c:0;if(s!==c)return s;if(a.e!==e.e)return a.e>e.e^s<0?1:-1;for(t=0,n=(r=o.length)<(u=i.length)?r:u;t<n;++t)if(o[t]!==i[t])return o[t]>i[t]^s<0?1:-1;return r===u?0:r>u^s<0?1:-1},P.cosine=P.cos=function(){var e,t,n=this,r=n.constructor;return n.d?n.d[0]?(e=r.precision,t=r.rounding,r.precision=e+Math.max(n.e,n.sd())+LOG_BASE,r.rounding=1,n=cosine(r,toLessThanHalfPi(r,n)),r.precision=e,r.rounding=t,finalise(2==quadrant||3==quadrant?n.neg():n,e,t,!0)):new r(1):new r(NaN)},P.cubeRoot=P.cbrt=function(){var e,t,n,r,u,a,o,i,s,c,l=this,f=l.constructor;if(!l.isFinite()||l.isZero())return new f(l);for(external=!1,(a=l.s*mathpow(l.s*l,1/3))&&Math.abs(a)!=1/0?r=new f(a.toString()):(n=digitsToString(l.d),(a=((e=l.e)-n.length+1)%3)&&(n+=1==a||-2==a?"0":"00"),a=mathpow(n,1/3),e=mathfloor((e+1)/3)-(e%3==(e<0?-1:2)),(r=new f(n=a==1/0?"5e"+e:(n=a.toExponential()).slice(0,n.indexOf("e")+1)+e)).s=l.s),o=(e=f.precision)+3;;)if(c=(s=(i=r).times(i).times(i)).plus(l),r=divide(c.plus(l).times(i),c.plus(s),o+2,1),digitsToString(i.d).slice(0,o)===(n=digitsToString(r.d)).slice(0,o)){if("9999"!=(n=n.slice(o-3,o+1))&&(u||"4999"!=n)){+n&&(+n.slice(1)||"5"!=n.charAt(0))||(finalise(r,e+1,1),t=!r.times(r).times(r).eq(l));break}if(!u&&(finalise(i,e+1,0),i.times(i).times(i).eq(l))){r=i;break}o+=4,u=1}return external=!0,finalise(r,e,f.rounding,t)},P.decimalPlaces=P.dp=function(){var e,t=this.d,n=NaN;if(t){if(n=((e=t.length-1)-mathfloor(this.e/LOG_BASE))*LOG_BASE,e=t[e])for(;e%10==0;e/=10)n--;n<0&&(n=0)}return n},P.dividedBy=P.div=function(e){return divide(this,new this.constructor(e))},P.dividedToIntegerBy=P.divToInt=function(e){var t=this.constructor;return finalise(divide(this,new t(e),0,1,1),t.precision,t.rounding)},P.equals=P.eq=function(e){return 0===this.cmp(e)},P.floor=function(){return finalise(new this.constructor(this),this.e+1,3)},P.greaterThan=P.gt=function(e){return this.cmp(e)>0},P.greaterThanOrEqualTo=P.gte=function(e){var t=this.cmp(e);return 1==t||0===t},P.hyperbolicCosine=P.cosh=function(){var e,t,n,r,u,a=this,o=a.constructor,i=new o(1);if(!a.isFinite())return new o(a.s?1/0:NaN);if(a.isZero())return i;n=o.precision,r=o.rounding,o.precision=n+Math.max(a.e,a.sd())+4,o.rounding=1,(u=a.d.length)<32?t=(1/tinyPow(4,e=Math.ceil(u/3))).toString():(e=16,t="2.3283064365386962890625e-10"),a=taylorSeries(o,1,a.times(t),new o(1),!0);for(var s,c=e,l=new o(8);c--;)s=a.times(a),a=i.minus(s.times(l.minus(s.times(l))));return finalise(a,o.precision=n,o.rounding=r,!0)},P.hyperbolicSine=P.sinh=function(){var e,t,n,r,u=this,a=u.constructor;if(!u.isFinite()||u.isZero())return new a(u);if(t=a.precision,n=a.rounding,a.precision=t+Math.max(u.e,u.sd())+4,a.rounding=1,(r=u.d.length)<3)u=taylorSeries(a,2,u,u,!0);else{e=(e=1.4*Math.sqrt(r))>16?16:0|e,u=taylorSeries(a,2,u=u.times(1/tinyPow(5,e)),u,!0);for(var o,i=new a(5),s=new a(16),c=new a(20);e--;)o=u.times(u),u=u.times(i.plus(o.times(s.times(o).plus(c))))}return a.precision=t,a.rounding=n,finalise(u,t,n,!0)},P.hyperbolicTangent=P.tanh=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+7,r.rounding=1,divide(n.sinh(),n.cosh(),r.precision=e,r.rounding=t)):new r(n.s)},P.inverseCosine=P.acos=function(){var e,t=this,n=t.constructor,r=t.abs().cmp(1),u=n.precision,a=n.rounding;return-1!==r?0===r?t.isNeg()?getPi(n,u,a):new n(0):new n(NaN):t.isZero()?getPi(n,u+4,a).times(.5):(n.precision=u+6,n.rounding=1,t=t.asin(),e=getPi(n,u+4,a).times(.5),n.precision=u,n.rounding=a,e.minus(t))},P.inverseHyperbolicCosine=P.acosh=function(){var e,t,n=this,r=n.constructor;return n.lte(1)?new r(n.eq(1)?0:NaN):n.isFinite()?(e=r.precision,t=r.rounding,r.precision=e+Math.max(Math.abs(n.e),n.sd())+4,r.rounding=1,external=!1,n=n.times(n).minus(1).sqrt().plus(n),external=!0,r.precision=e,r.rounding=t,n.ln()):new r(n)},P.inverseHyperbolicSine=P.asinh=function(){var e,t,n=this,r=n.constructor;return!n.isFinite()||n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+2*Math.max(Math.abs(n.e),n.sd())+6,r.rounding=1,external=!1,n=n.times(n).plus(1).sqrt().plus(n),external=!0,r.precision=e,r.rounding=t,n.ln())},P.inverseHyperbolicTangent=P.atanh=function(){var e,t,n,r,u=this,a=u.constructor;return u.isFinite()?u.e>=0?new a(u.abs().eq(1)?u.s/0:u.isZero()?u:NaN):(e=a.precision,t=a.rounding,r=u.sd(),Math.max(r,e)<2*-u.e-1?finalise(new a(u),e,t,!0):(a.precision=n=r-u.e,u=divide(u.plus(1),new a(1).minus(u),n+e,1),a.precision=e+4,a.rounding=1,u=u.ln(),a.precision=e,a.rounding=t,u.times(.5))):new a(NaN)},P.inverseSine=P.asin=function(){var e,t,n,r,u=this,a=u.constructor;return u.isZero()?new a(u):(t=u.abs().cmp(1),n=a.precision,r=a.rounding,-1!==t?0===t?((e=getPi(a,n+4,r).times(.5)).s=u.s,e):new a(NaN):(a.precision=n+6,a.rounding=1,u=u.div(new a(1).minus(u.times(u)).sqrt().plus(1)).atan(),a.precision=n,a.rounding=r,u.times(2)))},P.inverseTangent=P.atan=function(){var e,t,n,r,u,a,o,i,s,c=this,l=c.constructor,f=l.precision,d=l.rounding;if(c.isFinite()){if(c.isZero())return new l(c);if(c.abs().eq(1)&&f+4<=PI_PRECISION)return(o=getPi(l,f+4,d).times(.25)).s=c.s,o}else{if(!c.s)return new l(NaN);if(f+4<=PI_PRECISION)return(o=getPi(l,f+4,d).times(.5)).s=c.s,o}for(l.precision=i=f+10,l.rounding=1,e=n=Math.min(28,i/LOG_BASE+2|0);e;--e)c=c.div(c.times(c).plus(1).sqrt().plus(1));for(external=!1,t=Math.ceil(i/LOG_BASE),r=1,s=c.times(c),o=new l(c),u=c;-1!==e;)if(u=u.times(s),a=o.minus(u.div(r+=2)),u=u.times(s),void 0!==(o=a.plus(u.div(r+=2))).d[t])for(e=t;o.d[e]===a.d[e]&&e--;);return n&&(o=o.times(2<<n-1)),external=!0,finalise(o,l.precision=f,l.rounding=d,!0)},P.isFinite=function(){return!!this.d},P.isInteger=P.isInt=function(){return!!this.d&&mathfloor(this.e/LOG_BASE)>this.d.length-2},P.isNaN=function(){return!this.s},P.isNegative=P.isNeg=function(){return this.s<0},P.isPositive=P.isPos=function(){return this.s>0},P.isZero=function(){return!!this.d&&0===this.d[0]},P.lessThan=P.lt=function(e){return this.cmp(e)<0},P.lessThanOrEqualTo=P.lte=function(e){return this.cmp(e)<1},P.logarithm=P.log=function(e){var t,n,r,u,a,o,i,s,c=this,l=c.constructor,f=l.precision,d=l.rounding;if(null==e)e=new l(10),t=!0;else{if(n=(e=new l(e)).d,e.s<0||!n||!n[0]||e.eq(1))return new l(NaN);t=e.eq(10)}if(n=c.d,c.s<0||!n||!n[0]||c.eq(1))return new l(n&&!n[0]?-1/0:1!=c.s?NaN:n?0:1/0);if(t)if(n.length>1)a=!0;else{for(u=n[0];u%10==0;)u/=10;a=1!==u}if(external=!1,o=naturalLogarithm(c,i=f+5),r=t?getLn10(l,i+10):naturalLogarithm(e,i),checkRoundingDigits((s=divide(o,r,i,1)).d,u=f,d))do{if(o=naturalLogarithm(c,i+=10),r=t?getLn10(l,i+10):naturalLogarithm(e,i),s=divide(o,r,i,1),!a){+digitsToString(s.d).slice(u+1,u+15)+1==1e14&&(s=finalise(s,f+1,0));break}}while(checkRoundingDigits(s.d,u+=10,d));return external=!0,finalise(s,f,d)},P.minus=P.sub=function(e){var t,n,r,u,a,o,i,s,c,l,f,d,p=this,m=p.constructor;if(e=new m(e),!p.d||!e.d)return p.s&&e.s?p.d?e.s=-e.s:e=new m(e.d||p.s!==e.s?p:NaN):e=new m(NaN),e;if(p.s!=e.s)return e.s=-e.s,p.plus(e);if(c=p.d,d=e.d,i=m.precision,s=m.rounding,!c[0]||!d[0]){if(d[0])e.s=-e.s;else{if(!c[0])return new m(3===s?-0:0);e=new m(p)}return external?finalise(e,i,s):e}if(n=mathfloor(e.e/LOG_BASE),l=mathfloor(p.e/LOG_BASE),c=c.slice(),a=l-n){for((f=a<0)?(t=c,a=-a,o=d.length):(t=d,n=l,o=c.length),a>(r=Math.max(Math.ceil(i/LOG_BASE),o)+2)&&(a=r,t.length=1),t.reverse(),r=a;r--;)t.push(0);t.reverse()}else{for((f=(r=c.length)<(o=d.length))&&(o=r),r=0;r<o;r++)if(c[r]!=d[r]){f=c[r]<d[r];break}a=0}for(f&&(t=c,c=d,d=t,e.s=-e.s),o=c.length,r=d.length-o;r>0;--r)c[o++]=0;for(r=d.length;r>a;){if(c[--r]<d[r]){for(u=r;u&&0===c[--u];)c[u]=BASE-1;--c[u],c[r]+=BASE}c[r]-=d[r]}for(;0===c[--o];)c.pop();for(;0===c[0];c.shift())--n;return c[0]?(e.d=c,e.e=getBase10Exponent(c,n),external?finalise(e,i,s):e):new m(3===s?-0:0)},P.modulo=P.mod=function(e){var t,n=this,r=n.constructor;return e=new r(e),!n.d||!e.s||e.d&&!e.d[0]?new r(NaN):!e.d||n.d&&!n.d[0]?finalise(new r(n),r.precision,r.rounding):(external=!1,9==r.modulo?(t=divide(n,e.abs(),0,3,1)).s*=e.s:t=divide(n,e,0,r.modulo,1),t=t.times(e),external=!0,n.minus(t))},P.naturalExponential=P.exp=function(){return naturalExponential(this)},P.naturalLogarithm=P.ln=function(){return naturalLogarithm(this)},P.negated=P.neg=function(){var e=new this.constructor(this);return e.s=-e.s,finalise(e)},P.plus=P.add=function(e){var t,n,r,u,a,o,i,s,c,l,f=this,d=f.constructor;if(e=new d(e),!f.d||!e.d)return f.s&&e.s?f.d||(e=new d(e.d||f.s===e.s?f:NaN)):e=new d(NaN),e;if(f.s!=e.s)return e.s=-e.s,f.minus(e);if(c=f.d,l=e.d,i=d.precision,s=d.rounding,!c[0]||!l[0])return l[0]||(e=new d(f)),external?finalise(e,i,s):e;if(a=mathfloor(f.e/LOG_BASE),r=mathfloor(e.e/LOG_BASE),c=c.slice(),u=a-r){for(u<0?(n=c,u=-u,o=l.length):(n=l,r=a,o=c.length),u>(o=(a=Math.ceil(i/LOG_BASE))>o?a+1:o+1)&&(u=o,n.length=1),n.reverse();u--;)n.push(0);n.reverse()}for((o=c.length)-(u=l.length)<0&&(u=o,n=l,l=c,c=n),t=0;u;)t=(c[--u]=c[u]+l[u]+t)/BASE|0,c[u]%=BASE;for(t&&(c.unshift(t),++r),o=c.length;0==c[--o];)c.pop();return e.d=c,e.e=getBase10Exponent(c,r),external?finalise(e,i,s):e},P.precision=P.sd=function(e){var t,n=this;if(void 0!==e&&e!==!!e&&1!==e&&0!==e)throw Error(invalidArgument+e);return n.d?(t=getPrecision(n.d),e&&n.e+1>t&&(t=n.e+1)):t=NaN,t},P.round=function(){var e=this,t=e.constructor;return finalise(new t(e),e.e+1,t.rounding)},P.sine=P.sin=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+Math.max(n.e,n.sd())+LOG_BASE,r.rounding=1,n=sine(r,toLessThanHalfPi(r,n)),r.precision=e,r.rounding=t,finalise(quadrant>2?n.neg():n,e,t,!0)):new r(NaN)},P.squareRoot=P.sqrt=function(){var e,t,n,r,u,a,o=this,i=o.d,s=o.e,c=o.s,l=o.constructor;if(1!==c||!i||!i[0])return new l(!c||c<0&&(!i||i[0])?NaN:i?o:1/0);for(external=!1,0==(c=Math.sqrt(+o))||c==1/0?(((t=digitsToString(i)).length+s)%2==0&&(t+="0"),c=Math.sqrt(t),s=mathfloor((s+1)/2)-(s<0||s%2),r=new l(t=c==1/0?"5e"+s:(t=c.toExponential()).slice(0,t.indexOf("e")+1)+s)):r=new l(c.toString()),n=(s=l.precision)+3;;)if(r=(a=r).plus(divide(o,a,n+2,1)).times(.5),digitsToString(a.d).slice(0,n)===(t=digitsToString(r.d)).slice(0,n)){if("9999"!=(t=t.slice(n-3,n+1))&&(u||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(finalise(r,s+1,1),e=!r.times(r).eq(o));break}if(!u&&(finalise(a,s+1,0),a.times(a).eq(o))){r=a;break}n+=4,u=1}return external=!0,finalise(r,s,l.rounding,e)},P.tangent=P.tan=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+10,r.rounding=1,(n=n.sin()).s=1,n=divide(n,new r(1).minus(n.times(n)).sqrt(),e+10,0),r.precision=e,r.rounding=t,finalise(2==quadrant||4==quadrant?n.neg():n,e,t,!0)):new r(NaN)},P.times=P.mul=function(e){var t,n,r,u,a,o,i,s,c,l=this,f=l.constructor,d=l.d,p=(e=new f(e)).d;if(e.s*=l.s,!(d&&d[0]&&p&&p[0]))return new f(!e.s||d&&!d[0]&&!p||p&&!p[0]&&!d?NaN:d&&p?0*e.s:e.s/0);for(n=mathfloor(l.e/LOG_BASE)+mathfloor(e.e/LOG_BASE),(s=d.length)<(c=p.length)&&(a=d,d=p,p=a,o=s,s=c,c=o),a=[],r=o=s+c;r--;)a.push(0);for(r=c;--r>=0;){for(t=0,u=s+r;u>r;)i=a[u]+p[r]*d[u-r-1]+t,a[u--]=i%BASE|0,t=i/BASE|0;a[u]=(a[u]+t)%BASE|0}for(;!a[--o];)a.pop();return t?++n:a.shift(),e.d=a,e.e=getBase10Exponent(a,n),external?finalise(e,f.precision,f.rounding):e},P.toBinary=function(e,t){return toStringBinary(this,2,e,t)},P.toDecimalPlaces=P.toDP=function(e,t){var n=this,r=n.constructor;return n=new r(n),void 0===e?n:(checkInt32(e,0,MAX_DIGITS),void 0===t?t=r.rounding:checkInt32(t,0,8),finalise(n,e+n.e+1,t))},P.toExponential=function(e,t){var n,r=this,u=r.constructor;return void 0===e?n=finiteToString(r,!0):(checkInt32(e,0,MAX_DIGITS),void 0===t?t=u.rounding:checkInt32(t,0,8),n=finiteToString(r=finalise(new u(r),e+1,t),!0,e+1)),r.isNeg()&&!r.isZero()?"-"+n:n},P.toFixed=function(e,t){var n,r,u=this,a=u.constructor;return void 0===e?n=finiteToString(u):(checkInt32(e,0,MAX_DIGITS),void 0===t?t=a.rounding:checkInt32(t,0,8),n=finiteToString(r=finalise(new a(u),e+u.e+1,t),!1,e+r.e+1)),u.isNeg()&&!u.isZero()?"-"+n:n},P.toFraction=function(e){var t,n,r,u,a,o,i,s,c,l,f,d,p=this,m=p.d,g=p.constructor;if(!m)return new g(p);if(c=n=new g(1),r=s=new g(0),o=(a=(t=new g(r)).e=getPrecision(m)-p.e-1)%LOG_BASE,t.d[0]=mathpow(10,o<0?LOG_BASE+o:o),null==e)e=a>0?t:c;else{if(!(i=new g(e)).isInt()||i.lt(c))throw Error(invalidArgument+i);e=i.gt(t)?a>0?t:c:i}for(external=!1,i=new g(digitsToString(m)),l=g.precision,g.precision=a=m.length*LOG_BASE*2;f=divide(i,t,0,1,1),1!=(u=n.plus(f.times(r))).cmp(e);)n=r,r=u,u=c,c=s.plus(f.times(u)),s=u,u=t,t=i.minus(f.times(u)),i=u;return u=divide(e.minus(n),r,0,1,1),s=s.plus(u.times(c)),n=n.plus(u.times(r)),s.s=c.s=p.s,d=divide(c,r,a,1).minus(p).abs().cmp(divide(s,n,a,1).minus(p).abs())<1?[c,r]:[s,n],g.precision=l,external=!0,d},P.toHexadecimal=P.toHex=function(e,t){return toStringBinary(this,16,e,t)},P.toNearest=function(e,t){var n=this,r=n.constructor;if(n=new r(n),null==e){if(!n.d)return n;e=new r(1),t=r.rounding}else{if(e=new r(e),void 0===t?t=r.rounding:checkInt32(t,0,8),!n.d)return e.s?n:e;if(!e.d)return e.s&&(e.s=n.s),e}return e.d[0]?(external=!1,n=divide(n,e,0,t,1).times(e),external=!0,finalise(n)):(e.s=n.s,n=e),n},P.toNumber=function(){return+this},P.toOctal=function(e,t){return toStringBinary(this,8,e,t)},P.toPower=P.pow=function(e){var t,n,r,u,a,o,i=this,s=i.constructor,c=+(e=new s(e));if(!(i.d&&e.d&&i.d[0]&&e.d[0]))return new s(mathpow(+i,c));if((i=new s(i)).eq(1))return i;if(r=s.precision,a=s.rounding,e.eq(1))return finalise(i,r,a);if((t=mathfloor(e.e/LOG_BASE))>=e.d.length-1&&(n=c<0?-c:c)<=MAX_SAFE_INTEGER)return u=intPow(s,i,n,r),e.s<0?new s(1).div(u):finalise(u,r,a);if((o=i.s)<0){if(t<e.d.length-1)return new s(NaN);if(0==(1&e.d[t])&&(o=1),0==i.e&&1==i.d[0]&&1==i.d.length)return i.s=o,i}return(t=0!=(n=mathpow(+i,c))&&isFinite(n)?new s(n+"").e:mathfloor(c*(Math.log("0."+digitsToString(i.d))/Math.LN10+i.e+1)))>s.maxE+1||t<s.minE-1?new s(t>0?o/0:0):(external=!1,s.rounding=i.s=1,n=Math.min(12,(t+"").length),(u=naturalExponential(e.times(naturalLogarithm(i,r+n)),r)).d&&checkRoundingDigits((u=finalise(u,r+5,1)).d,r,a)&&(t=r+10,+digitsToString((u=finalise(naturalExponential(e.times(naturalLogarithm(i,t+n)),t),t+5,1)).d).slice(r+1,r+15)+1==1e14&&(u=finalise(u,r+1,0))),u.s=o,external=!0,s.rounding=a,finalise(u,r,a))},P.toPrecision=function(e,t){var n,r=this,u=r.constructor;return void 0===e?n=finiteToString(r,r.e<=u.toExpNeg||r.e>=u.toExpPos):(checkInt32(e,1,MAX_DIGITS),void 0===t?t=u.rounding:checkInt32(t,0,8),n=finiteToString(r=finalise(new u(r),e,t),e<=r.e||r.e<=u.toExpNeg,e)),r.isNeg()&&!r.isZero()?"-"+n:n},P.toSignificantDigits=P.toSD=function(e,t){var n=this.constructor;return void 0===e?(e=n.precision,t=n.rounding):(checkInt32(e,1,MAX_DIGITS),void 0===t?t=n.rounding:checkInt32(t,0,8)),finalise(new n(this),e,t)},P.toString=function(){var e=this,t=e.constructor,n=finiteToString(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()&&!e.isZero()?"-"+n:n},P.truncated=P.trunc=function(){return finalise(new this.constructor(this),this.e+1,1)},P.valueOf=P.toJSON=function(){var e=this,t=e.constructor,n=finiteToString(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()?"-"+n:n};var divide=function(){function e(e,t,n){var r,u=0,a=e.length;for(e=e.slice();a--;)r=e[a]*t+u,e[a]=r%n|0,u=r/n|0;return u&&e.unshift(u),e}function t(e,t,n,r){var u,a;if(n!=r)a=n>r?1:-1;else for(u=a=0;u<n;u++)if(e[u]!=t[u]){a=e[u]>t[u]?1:-1;break}return a}function n(e,t,n,r){for(var u=0;n--;)e[n]-=u,u=e[n]<t[n]?1:0,e[n]=u*r+e[n]-t[n];for(;!e[0]&&e.length>1;)e.shift()}return function(r,u,a,o,i,s){var c,l,f,d,p,m,g,h,_,D,$,y,v,b,A,w,F,C,E,x,k=r.constructor,B=r.s==u.s?1:-1,S=r.d,N=u.d;if(!(S&&S[0]&&N&&N[0]))return new k(r.s&&u.s&&(S?!N||S[0]!=N[0]:N)?S&&0==S[0]||!N?0*B:B/0:NaN);for(s?(p=1,l=r.e-u.e):(s=BASE,p=LOG_BASE,l=mathfloor(r.e/p)-mathfloor(u.e/p)),E=N.length,F=S.length,D=(_=new k(B)).d=[],f=0;N[f]==(S[f]||0);f++);if(N[f]>(S[f]||0)&&l--,null==a?(b=a=k.precision,o=k.rounding):b=i?a+(r.e-u.e)+1:a,b<0)D.push(1),m=!0;else{if(b=b/p+2|0,f=0,1==E){for(d=0,N=N[0],b++;(f<F||d)&&b--;f++)A=d*s+(S[f]||0),D[f]=A/N|0,d=A%N|0;m=d||f<F}else{for((d=s/(N[0]+1)|0)>1&&(N=e(N,d,s),S=e(S,d,s),E=N.length,F=S.length),w=E,y=($=S.slice(0,E)).length;y<E;)$[y++]=0;(x=N.slice()).unshift(0),C=N[0],N[1]>=s/2&&++C;do{d=0,(c=t(N,$,E,y))<0?(v=$[0],E!=y&&(v=v*s+($[1]||0)),(d=v/C|0)>1?(d>=s&&(d=s-1),1==(c=t(g=e(N,d,s),$,h=g.length,y=$.length))&&(d--,n(g,E<h?x:N,h,s))):(0==d&&(c=d=1),g=N.slice()),(h=g.length)<y&&g.unshift(0),n($,g,y,s),-1==c&&(c=t(N,$,E,y=$.length))<1&&(d++,n($,E<y?x:N,y,s)),y=$.length):0===c&&(d++,$=[0]),D[f++]=d,c&&$[0]?$[y++]=S[w]||0:($=[S[w]],y=1)}while((w++<F||void 0!==$[0])&&b--);m=void 0!==$[0]}D[0]||D.shift()}if(1==p)_.e=l,inexact=m;else{for(f=1,d=D[0];d>=10;d/=10)f++;_.e=f+l*p-1,finalise(_,i?a+_.e+1:a,o,m)}return _}}();function finalise(e,t,n,r){var u,a,o,i,s,c,l,f,d,p=e.constructor;e:if(null!=t){if(!(f=e.d))return e;for(u=1,i=f[0];i>=10;i/=10)u++;if((a=t-u)<0)a+=LOG_BASE,o=t,s=(l=f[d=0])/mathpow(10,u-o-1)%10|0;else if((d=Math.ceil((a+1)/LOG_BASE))>=(i=f.length)){if(!r)break e;for(;i++<=d;)f.push(0);l=s=0,u=1,o=(a%=LOG_BASE)-LOG_BASE+1}else{for(l=i=f[d],u=1;i>=10;i/=10)u++;s=(o=(a%=LOG_BASE)-LOG_BASE+u)<0?0:l/mathpow(10,u-o-1)%10|0}if(r=r||t<0||void 0!==f[d+1]||(o<0?l:l%mathpow(10,u-o-1)),c=n<4?(s||r)&&(0==n||n==(e.s<0?3:2)):s>5||5==s&&(4==n||r||6==n&&(a>0?o>0?l/mathpow(10,u-o):0:f[d-1])%10&1||n==(e.s<0?8:7)),t<1||!f[0])return f.length=0,c?(t-=e.e+1,f[0]=mathpow(10,(LOG_BASE-t%LOG_BASE)%LOG_BASE),e.e=-t||0):f[0]=e.e=0,e;if(0==a?(f.length=d,i=1,d--):(f.length=d+1,i=mathpow(10,LOG_BASE-a),f[d]=o>0?(l/mathpow(10,u-o)%mathpow(10,o)|0)*i:0),c)for(;;){if(0==d){for(a=1,o=f[0];o>=10;o/=10)a++;for(o=f[0]+=i,i=1;o>=10;o/=10)i++;a!=i&&(e.e++,f[0]==BASE&&(f[0]=1));break}if(f[d]+=i,f[d]!=BASE)break;f[d--]=0,i=1}for(a=f.length;0===f[--a];)f.pop()}return external&&(e.e>p.maxE?(e.d=null,e.e=NaN):e.e<p.minE&&(e.e=0,e.d=[0])),e}function finiteToString(e,t,n){if(!e.isFinite())return nonFiniteToString(e);var r,u=e.e,a=digitsToString(e.d),o=a.length;return t?(n&&(r=n-o)>0?a=a.charAt(0)+"."+a.slice(1)+getZeroString(r):o>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(e.e<0?"e":"e+")+e.e):u<0?(a="0."+getZeroString(-u-1)+a,n&&(r=n-o)>0&&(a+=getZeroString(r))):u>=o?(a+=getZeroString(u+1-o),n&&(r=n-u-1)>0&&(a=a+"."+getZeroString(r))):((r=u+1)<o&&(a=a.slice(0,r)+"."+a.slice(r)),n&&(r=n-o)>0&&(u+1===o&&(a+="."),a+=getZeroString(r))),a}function getBase10Exponent(e,t){var n=e[0];for(t*=LOG_BASE;n>=10;n/=10)t++;return t}function getLn10(e,t,n){if(t>LN10_PRECISION)throw external=!0,n&&(e.precision=n),Error(precisionLimitExceeded);return finalise(new e(LN10),t,1,!0)}function getPi(e,t,n){if(t>PI_PRECISION)throw Error(precisionLimitExceeded);return finalise(new e(PI),t,n,!0)}function getPrecision(e){var t=e.length-1,n=t*LOG_BASE+1;if(t=e[t]){for(;t%10==0;t/=10)n--;for(t=e[0];t>=10;t/=10)n++}return n}function getZeroString(e){for(var t="";e--;)t+="0";return t}function intPow(e,t,n,r){var u,a=new e(1),o=Math.ceil(r/LOG_BASE+4);for(external=!1;;){if(n%2&&truncate((a=a.times(t)).d,o)&&(u=!0),0===(n=mathfloor(n/2))){n=a.d.length-1,u&&0===a.d[n]&&++a.d[n];break}truncate((t=t.times(t)).d,o)}return external=!0,a}function isOdd(e){return 1&e.d[e.d.length-1]}function maxOrMin(e,t,n){for(var r,u=new e(t[0]),a=0;++a<t.length;){if(!(r=new e(t[a])).s){u=r;break}u[n](r)&&(u=r)}return u}function naturalExponential(e,t){var n,r,u,a,o,i,s,c=0,l=0,f=0,d=e.constructor,p=d.rounding,m=d.precision;if(!e.d||!e.d[0]||e.e>17)return new d(e.d?e.d[0]?e.s<0?0:1/0:1:e.s?e.s<0?0:e:NaN);for(null==t?(external=!1,s=m):s=t,i=new d(.03125);e.e>-2;)e=e.times(i),f+=5;for(s+=r=Math.log(mathpow(2,f))/Math.LN10*2+5|0,n=a=o=new d(1),d.precision=s;;){if(a=finalise(a.times(e),s,1),n=n.times(++l),digitsToString((i=o.plus(divide(a,n,s,1))).d).slice(0,s)===digitsToString(o.d).slice(0,s)){for(u=f;u--;)o=finalise(o.times(o),s,1);if(null!=t)return d.precision=m,o;if(!(c<3&&checkRoundingDigits(o.d,s-r,p,c)))return finalise(o,d.precision=m,p,external=!0);d.precision=s+=10,n=a=i=new d(1),l=0,c++}o=i}}function naturalLogarithm(e,t){var n,r,u,a,o,i,s,c,l,f,d,p=1,m=e,g=m.d,h=m.constructor,_=h.rounding,D=h.precision;if(m.s<0||!g||!g[0]||!m.e&&1==g[0]&&1==g.length)return new h(g&&!g[0]?-1/0:1!=m.s?NaN:g?0:m);if(null==t?(external=!1,l=D):l=t,h.precision=l+=10,r=(n=digitsToString(g)).charAt(0),!(Math.abs(a=m.e)<15e14))return c=getLn10(h,l+2,D).times(a+""),m=naturalLogarithm(new h(r+"."+n.slice(1)),l-10).plus(c),h.precision=D,null==t?finalise(m,D,_,external=!0):m;for(;r<7&&1!=r||1==r&&n.charAt(1)>3;)r=(n=digitsToString((m=m.times(e)).d)).charAt(0),p++;for(a=m.e,r>1?(m=new h("0."+n),a++):m=new h(r+"."+n.slice(1)),f=m,s=o=m=divide(m.minus(1),m.plus(1),l,1),d=finalise(m.times(m),l,1),u=3;;){if(o=finalise(o.times(d),l,1),digitsToString((c=s.plus(divide(o,new h(u),l,1))).d).slice(0,l)===digitsToString(s.d).slice(0,l)){if(s=s.times(2),0!==a&&(s=s.plus(getLn10(h,l+2,D).times(a+""))),s=divide(s,new h(p),l,1),null!=t)return h.precision=D,s;if(!checkRoundingDigits(s.d,l-10,_,i))return finalise(s,h.precision=D,_,external=!0);h.precision=l+=10,c=o=m=divide(f.minus(1),f.plus(1),l,1),d=finalise(m.times(m),l,1),u=i=1}s=c,u+=2}}function nonFiniteToString(e){return String(e.s*e.s/0)}function parseDecimal$1(e,t){var n,r,u;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;48===t.charCodeAt(r);r++);for(u=t.length;48===t.charCodeAt(u-1);--u);if(t=t.slice(r,u)){if(u-=r,e.e=n=n-r-1,e.d=[],r=(n+1)%LOG_BASE,n<0&&(r+=LOG_BASE),r<u){for(r&&e.d.push(+t.slice(0,r)),u-=LOG_BASE;r<u;)e.d.push(+t.slice(r,r+=LOG_BASE));t=t.slice(r),r=LOG_BASE-t.length}else r-=u;for(;r--;)t+="0";e.d.push(+t),external&&(e.e>e.constructor.maxE?(e.d=null,e.e=NaN):e.e<e.constructor.minE&&(e.e=0,e.d=[0]))}else e.e=0,e.d=[0];return e}function parseOther(e,t){var n,r,u,a,o,i,s,c,l;if(t.indexOf("_")>-1){if(t=t.replace(/(\d)_(?=\d)/g,"$1"),isDecimal.test(t))return parseDecimal$1(e,t)}else if("Infinity"===t||"NaN"===t)return+t||(e.s=NaN),e.e=NaN,e.d=null,e;if(isHex.test(t))n=16,t=t.toLowerCase();else if(isBinary.test(t))n=2;else{if(!isOctal.test(t))throw Error(invalidArgument+t);n=8}for((a=t.search(/p/i))>0?(s=+t.slice(a+1),t=t.substring(2,a)):t=t.slice(2),o=(a=t.indexOf("."))>=0,r=e.constructor,o&&(a=(i=(t=t.replace(".","")).length)-a,u=intPow(r,new r(n),a,2*a)),a=l=(c=convertBase(t,n,BASE)).length-1;0===c[a];--a)c.pop();return a<0?new r(0*e.s):(e.e=getBase10Exponent(c,l),e.d=c,external=!1,o&&(e=divide(e,u,4*i)),s&&(e=e.times(Math.abs(s)<54?mathpow(2,s):Decimal.pow(2,s))),external=!0,e)}function sine(e,t){var n,r=t.d.length;if(r<3)return t.isZero()?t:taylorSeries(e,2,t,t);n=(n=1.4*Math.sqrt(r))>16?16:0|n,t=taylorSeries(e,2,t=t.times(1/tinyPow(5,n)),t);for(var u,a=new e(5),o=new e(16),i=new e(20);n--;)u=t.times(t),t=t.times(a.plus(u.times(o.times(u).minus(i))));return t}function taylorSeries(e,t,n,r,u){var a,o,i,s,c=e.precision,l=Math.ceil(c/LOG_BASE);for(external=!1,s=n.times(n),i=new e(r);;){if(o=divide(i.times(s),new e(t++*t++),c,1),i=u?r.plus(o):r.minus(o),r=divide(o.times(s),new e(t++*t++),c,1),void 0!==(o=i.plus(r)).d[l]){for(a=l;o.d[a]===i.d[a]&&a--;);if(-1==a)break}a=i,i=r,r=o,o=a}return external=!0,o.d.length=l+1,o}function tinyPow(e,t){for(var n=e;--t;)n*=e;return n}function toLessThanHalfPi(e,t){var n,r=t.s<0,u=getPi(e,e.precision,1),a=u.times(.5);if((t=t.abs()).lte(a))return quadrant=r?4:1,t;if((n=t.divToInt(u)).isZero())quadrant=r?3:2;else{if((t=t.minus(n.times(u))).lte(a))return quadrant=isOdd(n)?r?2:3:r?4:1,t;quadrant=isOdd(n)?r?1:4:r?3:2}return t.minus(u).abs()}function toStringBinary(e,t,n,r){var u,a,o,i,s,c,l,f,d,p=e.constructor,m=void 0!==n;if(m?(checkInt32(n,1,MAX_DIGITS),void 0===r?r=p.rounding:checkInt32(r,0,8)):(n=p.precision,r=p.rounding),e.isFinite()){for(m?(u=2,16==t?n=4*n-3:8==t&&(n=3*n-2)):u=t,(o=(l=finiteToString(e)).indexOf("."))>=0&&(l=l.replace(".",""),(d=new p(1)).e=l.length-o,d.d=convertBase(finiteToString(d),10,u),d.e=d.d.length),a=s=(f=convertBase(l,10,u)).length;0==f[--s];)f.pop();if(f[0]){if(o<0?a--:((e=new p(e)).d=f,e.e=a,f=(e=divide(e,d,n,r,0,u)).d,a=e.e,c=inexact),o=f[n],i=u/2,c=c||void 0!==f[n+1],c=r<4?(void 0!==o||c)&&(0===r||r===(e.s<0?3:2)):o>i||o===i&&(4===r||c||6===r&&1&f[n-1]||r===(e.s<0?8:7)),f.length=n,c)for(;++f[--n]>u-1;)f[n]=0,n||(++a,f.unshift(1));for(s=f.length;!f[s-1];--s);for(o=0,l="";o<s;o++)l+=NUMERALS.charAt(f[o]);if(m){if(s>1)if(16==t||8==t){for(o=16==t?4:3,--s;s%o;s++)l+="0";for(s=(f=convertBase(l,u,t)).length;!f[s-1];--s);for(o=1,l="1.";o<s;o++)l+=NUMERALS.charAt(f[o])}else l=l.charAt(0)+"."+l.slice(1);l=l+(a<0?"p":"p+")+a}else if(a<0){for(;++a;)l="0"+l;l="0."+l}else if(++a>s)for(a-=s;a--;)l+="0";else a<s&&(l=l.slice(0,a)+"."+l.slice(a))}else l=m?"0p+0":"0";l=(16==t?"0x":2==t?"0b":8==t?"0o":"")+l}else l=nonFiniteToString(e);return e.s<0?"-"+l:l}function truncate(e,t){if(e.length>t)return e.length=t,!0}function abs(e){return new this(e).abs()}function acos(e){return new this(e).acos()}function acosh(e){return new this(e).acosh()}function add(e,t){return new this(e).plus(t)}function asin(e){return new this(e).asin()}function asinh(e){return new this(e).asinh()}function atan(e){return new this(e).atan()}function atanh(e){return new this(e).atanh()}function atan2(e,t){e=new this(e),t=new this(t);var n,r=this.precision,u=this.rounding,a=r+4;return e.s&&t.s?e.d||t.d?!t.d||e.isZero()?(n=t.s<0?getPi(this,r,u):new this(0)).s=e.s:!e.d||t.isZero()?(n=getPi(this,a,1).times(.5)).s=e.s:t.s<0?(this.precision=a,this.rounding=1,n=this.atan(divide(e,t,a,1)),t=getPi(this,a,1),this.precision=r,this.rounding=u,n=e.s<0?n.minus(t):n.plus(t)):n=this.atan(divide(e,t,a,1)):(n=getPi(this,a,1).times(t.s>0?.25:.75)).s=e.s:n=new this(NaN),n}function cbrt(e){return new this(e).cbrt()}function ceil(e){return finalise(e=new this(e),e.e+1,2)}function clamp(e,t,n){return new this(e).clamp(t,n)}function config(e){if(!e||"object"!=typeof e)throw Error(decimalError+"Object expected");var t,n,r,u=!0===e.defaults,a=["precision",1,MAX_DIGITS,"rounding",0,8,"toExpNeg",-EXP_LIMIT,0,"toExpPos",0,EXP_LIMIT,"maxE",0,EXP_LIMIT,"minE",-EXP_LIMIT,0,"modulo",0,9];for(t=0;t<a.length;t+=3)if(n=a[t],u&&(this[n]=DEFAULTS[n]),void 0!==(r=e[n])){if(!(mathfloor(r)===r&&r>=a[t+1]&&r<=a[t+2]))throw Error(invalidArgument+n+": "+r);this[n]=r}if(n="crypto",u&&(this[n]=DEFAULTS[n]),void 0!==(r=e[n])){if(!0!==r&&!1!==r&&0!==r&&1!==r)throw Error(invalidArgument+n+": "+r);if(r){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw Error(cryptoUnavailable);this[n]=!0}else this[n]=!1}return this}function cos(e){return new this(e).cos()}function cosh(e){return new this(e).cosh()}function clone(e){var t,n,r;function u(e){var t,n,r,a=this;if(!(a instanceof u))return new u(e);if(a.constructor=u,isDecimalInstance(e))return a.s=e.s,void(external?!e.d||e.e>u.maxE?(a.e=NaN,a.d=null):e.e<u.minE?(a.e=0,a.d=[0]):(a.e=e.e,a.d=e.d.slice()):(a.e=e.e,a.d=e.d?e.d.slice():e.d));if("number"===(r=typeof e)){if(0===e)return a.s=1/e<0?-1:1,a.e=0,void(a.d=[0]);if(e<0?(e=-e,a.s=-1):a.s=1,e===~~e&&e<1e7){for(t=0,n=e;n>=10;n/=10)t++;return void(external?t>u.maxE?(a.e=NaN,a.d=null):t<u.minE?(a.e=0,a.d=[0]):(a.e=t,a.d=[e]):(a.e=t,a.d=[e]))}return 0*e!=0?(e||(a.s=NaN),a.e=NaN,void(a.d=null)):parseDecimal$1(a,e.toString())}if("string"!==r)throw Error(invalidArgument+e);return 45===(n=e.charCodeAt(0))?(e=e.slice(1),a.s=-1):(43===n&&(e=e.slice(1)),a.s=1),isDecimal.test(e)?parseDecimal$1(a,e):parseOther(a,e)}if(u.prototype=P,u.ROUND_UP=0,u.ROUND_DOWN=1,u.ROUND_CEIL=2,u.ROUND_FLOOR=3,u.ROUND_HALF_UP=4,u.ROUND_HALF_DOWN=5,u.ROUND_HALF_EVEN=6,u.ROUND_HALF_CEIL=7,u.ROUND_HALF_FLOOR=8,u.EUCLID=9,u.config=u.set=config,u.clone=clone,u.isDecimal=isDecimalInstance,u.abs=abs,u.acos=acos,u.acosh=acosh,u.add=add,u.asin=asin,u.asinh=asinh,u.atan=atan,u.atanh=atanh,u.atan2=atan2,u.cbrt=cbrt,u.ceil=ceil,u.clamp=clamp,u.cos=cos,u.cosh=cosh,u.div=div,u.exp=exp,u.floor=floor,u.hypot=hypot,u.ln=ln,u.log=log$1,u.log10=log10,u.log2=log2,u.max=max,u.min=min,u.mod=mod,u.mul=mul,u.pow=pow,u.random=random,u.round=round,u.sign=sign,u.sin=sin,u.sinh=sinh,u.sqrt=sqrt,u.sub=sub,u.sum=sum,u.tan=tan,u.tanh=tanh,u.trunc=trunc,void 0===e&&(e={}),e&&!0!==e.defaults)for(r=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],t=0;t<r.length;)e.hasOwnProperty(n=r[t++])||(e[n]=this[n]);return u.config(e),u}function div(e,t){return new this(e).div(t)}function exp(e){return new this(e).exp()}function floor(e){return finalise(e=new this(e),e.e+1,3)}function hypot(){var e,t,n=new this(0);for(external=!1,e=0;e<arguments.length;)if((t=new this(arguments[e++])).d)n.d&&(n=n.plus(t.times(t)));else{if(t.s)return external=!0,new this(1/0);n=t}return external=!0,n.sqrt()}function isDecimalInstance(e){return e instanceof Decimal||e&&e.toStringTag===tag||!1}function ln(e){return new this(e).ln()}function log$1(e,t){return new this(e).log(t)}function log2(e){return new this(e).log(2)}function log10(e){return new this(e).log(10)}function max(){return maxOrMin(this,arguments,"lt")}function min(){return maxOrMin(this,arguments,"gt")}function mod(e,t){return new this(e).mod(t)}function mul(e,t){return new this(e).mul(t)}function pow(e,t){return new this(e).pow(t)}function random(e){var t,n,r,u,a=0,o=new this(1),i=[];if(void 0===e?e=this.precision:checkInt32(e,1,MAX_DIGITS),r=Math.ceil(e/LOG_BASE),this.crypto)if(crypto.getRandomValues)for(t=crypto.getRandomValues(new Uint32Array(r));a<r;)(u=t[a])>=429e7?t[a]=crypto.getRandomValues(new Uint32Array(1))[0]:i[a++]=u%1e7;else{if(!crypto.randomBytes)throw Error(cryptoUnavailable);for(t=crypto.randomBytes(r*=4);a<r;)(u=t[a]+(t[a+1]<<8)+(t[a+2]<<16)+((127&t[a+3])<<24))>=214e7?crypto.randomBytes(4).copy(t,a):(i.push(u%1e7),a+=4);a=r/4}else for(;a<r;)i[a++]=1e7*Math.random()|0;for(r=i[--a],e%=LOG_BASE,r&&e&&(u=mathpow(10,LOG_BASE-e),i[a]=(r/u|0)*u);0===i[a];a--)i.pop();if(a<0)n=0,i=[0];else{for(n=-1;0===i[0];n-=LOG_BASE)i.shift();for(r=1,u=i[0];u>=10;u/=10)r++;r<LOG_BASE&&(n-=LOG_BASE-r)}return o.e=n,o.d=i,o}function round(e){return finalise(e=new this(e),e.e+1,this.rounding)}function sign(e){return(e=new this(e)).d?e.d[0]?e.s:0*e.s:e.s||NaN}function sin(e){return new this(e).sin()}function sinh(e){return new this(e).sinh()}function sqrt(e){return new this(e).sqrt()}function sub(e,t){return new this(e).sub(t)}function sum(){var e=0,t=arguments,n=new this(t[e]);for(external=!1;n.s&&++e<t.length;)n=n.plus(t[e]);return external=!0,finalise(n,this.precision,this.rounding)}function tan(e){return new this(e).tan()}function tanh(e){return new this(e).tanh()}function trunc(e){return finalise(e=new this(e),e.e+1,1)}P[Symbol.for("nodejs.util.inspect.custom")]=P.toString,P[Symbol.toStringTag]="Decimal";var Decimal=P.constructor=clone(DEFAULTS);function noop(){}LN10=new Decimal(LN10),PI=new Decimal(PI);const identity=e=>e;function assign(e,t){for(const n in t)e[n]=t[n];return e}function run$1(e){return e()}function blank_object(){return Object.create(null)}function run_all(e){e.forEach(run$1)}function is_function(e){return"function"==typeof e}function safe_not_equal(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function is_empty(e){return 0===Object.keys(e).length}function subscribe(e,...t){if(null==e)return noop;const n=e.subscribe(...t);return n.unsubscribe?()=>n.unsubscribe():n}function component_subscribe(e,t,n){e.$$.on_destroy.push(subscribe(t,n))}function create_slot(e,t,n,r){if(e){const u=get_slot_context(e,t,n,r);return e[0](u)}}function get_slot_context(e,t,n,r){return e[1]&&r?assign(n.ctx.slice(),e[1](r(t))):n.ctx}function get_slot_changes(e,t,n,r){if(e[2]&&r){const u=e[2](r(n));if(void 0===t.dirty)return u;if("object"==typeof u){const e=[],n=Math.max(t.dirty.length,u.length);for(let r=0;r<n;r+=1)e[r]=t.dirty[r]|u[r];return e}return t.dirty|u}return t.dirty}function update_slot_base(e,t,n,r,u,a){if(u){const o=get_slot_context(t,n,r,a);e.p(o,u)}}function get_all_dirty_from_scope(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let e=0;e<n;e++)t[e]=-1;return t}return-1}function null_to_empty(e){return null==e?"":e}function action_destroyer(e){return e&&is_function(e.destroy)?e.destroy:noop}const is_client="undefined"!=typeof window;let now=is_client?()=>window.performance.now():()=>Date.now(),raf=is_client?e=>requestAnimationFrame(e):noop;const tasks=new Set;function run_tasks(e){tasks.forEach((t=>{t.c(e)||(tasks.delete(t),t.f())})),0!==tasks.size&&raf(run_tasks)}function loop(e){let t;return 0===tasks.size&&raf(run_tasks),{promise:new Promise((n=>{tasks.add(t={c:e,f:n})})),abort(){tasks.delete(t)}}}function append(e,t){e.appendChild(t)}function get_root_for_style(e){if(!e)return document;const t=e.getRootNode?e.getRootNode():e.ownerDocument;return t&&t.host?t:e.ownerDocument}function append_empty_stylesheet(e){const t=element("style");return append_stylesheet(get_root_for_style(e),t),t.sheet}function append_stylesheet(e,t){return append(e.head||e,t),t.sheet}function insert(e,t,n){e.insertBefore(t,n||null)}function detach(e){e.parentNode&&e.parentNode.removeChild(e)}function destroy_each(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function element(e){return document.createElement(e)}function svg_element(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function text(e){return document.createTextNode(e)}function space(){return text(" ")}function empty(){return text("")}function listen(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function self$1(e){return function(t){t.target===this&&e.call(this,t)}}function attr(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function children(e){return Array.from(e.childNodes)}function set_data(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function set_style(e,t,n,r){null===n?e.style.removeProperty(t):e.style.setProperty(t,n,r?"important":"")}function toggle_class(e,t,n){e.classList[n?"add":"remove"](t)}function custom_event(e,t,{bubbles:n=!1,cancelable:r=!1}={}){const u=document.createEvent("CustomEvent");return u.initCustomEvent(e,n,r,t),u}function construct_svelte_component(e,t){return new e(t)}const managed_styles=new Map;let active=0,current_component;function hash(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}function create_style_information(e,t){const n={stylesheet:append_empty_stylesheet(t),rules:{}};return managed_styles.set(e,n),n}function create_rule(e,t,n,r,u,a,o,i=0){const s=16.666/r;let c="{\n";for(let e=0;e<=1;e+=s){const r=t+(n-t)*a(e);c+=100*e+`%{${o(r,1-r)}}\n`}const l=c+`100% {${o(n,1-n)}}\n}`,f=`__svelte_${hash(l)}_${i}`,d=get_root_for_style(e),{stylesheet:p,rules:m}=managed_styles.get(d)||create_style_information(d,e);m[f]||(m[f]=!0,p.insertRule(`@keyframes ${f} ${l}`,p.cssRules.length));const g=e.style.animation||"";return e.style.animation=`${g?`${g}, `:""}${f} ${r}ms linear ${u}ms 1 both`,active+=1,f}function delete_rule(e,t){const n=(e.style.animation||"").split(", "),r=n.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),u=n.length-r.length;u&&(e.style.animation=r.join(", "),active-=u,active||clear_rules())}function clear_rules(){raf((()=>{active||(managed_styles.forEach((e=>{const{ownerNode:t}=e.stylesheet;t&&detach(t)})),managed_styles.clear())}))}function set_current_component(e){current_component=e}function get_current_component(){if(!current_component)throw new Error("Function called outside component initialization");return current_component}function onMount(e){get_current_component().$$.on_mount.push(e)}function onDestroy(e){get_current_component().$$.on_destroy.push(e)}function setContext(e,t){return get_current_component().$$.context.set(e,t),t}function getContext(e){return get_current_component().$$.context.get(e)}function bubble(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach((e=>e.call(this,t)))}const dirty_components=[],binding_callbacks=[],render_callbacks=[],flush_callbacks=[],resolved_promise=Promise.resolve();let update_scheduled=!1;function schedule_update(){update_scheduled||(update_scheduled=!0,resolved_promise.then(flush))}function tick(){return schedule_update(),resolved_promise}function add_render_callback(e){render_callbacks.push(e)}const seen_callbacks=new Set;let flushidx=0,promise;function flush(){const e=current_component;do{for(;flushidx<dirty_components.length;){const e=dirty_components[flushidx];flushidx++,set_current_component(e),update(e.$$)}for(set_current_component(null),dirty_components.length=0,flushidx=0;binding_callbacks.length;)binding_callbacks.pop()();for(let e=0;e<render_callbacks.length;e+=1){const t=render_callbacks[e];seen_callbacks.has(t)||(seen_callbacks.add(t),t())}render_callbacks.length=0}while(dirty_components.length);for(;flush_callbacks.length;)flush_callbacks.pop()();update_scheduled=!1,seen_callbacks.clear(),set_current_component(e)}function update(e){if(null!==e.fragment){e.update(),run_all(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(add_render_callback)}}function wait(){return promise||(promise=Promise.resolve(),promise.then((()=>{promise=null}))),promise}function dispatch(e,t,n){e.dispatchEvent(custom_event(`${t?"intro":"outro"}${n}`))}const outroing=new Set;let outros;function group_outros(){outros={r:0,c:[],p:outros}}function check_outros(){outros.r||run_all(outros.c),outros=outros.p}function transition_in(e,t){e&&e.i&&(outroing.delete(e),e.i(t))}function transition_out(e,t,n,r){if(e&&e.o){if(outroing.has(e))return;outroing.add(e),outros.c.push((()=>{outroing.delete(e),r&&(n&&e.d(1),r())})),e.o(t)}else r&&r()}const null_transition={duration:0};function create_bidirectional_transition(e,t,n,r){const u={direction:"both"};let a=t(e,n,u),o=r?0:1,i=null,s=null,c=null;function l(){c&&delete_rule(e,c)}function f(e,t){const n=e.b-o;return t*=Math.abs(n),{a:o,b:e.b,d:n,duration:t,start:e.start,end:e.start+t,group:e.group}}function d(t){const{delay:n=0,duration:r=300,easing:u=identity,tick:d=noop,css:p}=a||null_transition,m={start:now()+n,b:t};t||(m.group=outros,outros.r+=1),i||s?s=m:(p&&(l(),c=create_rule(e,o,t,r,n,u,p)),t&&d(0,1),i=f(m,r),add_render_callback((()=>dispatch(e,t,"start"))),loop((t=>{if(s&&t>s.start&&(i=f(s,r),s=null,dispatch(e,i.b,"start"),p&&(l(),c=create_rule(e,o,i.b,i.duration,0,u,a.css))),i)if(t>=i.end)d(o=i.b,1-o),dispatch(e,i.b,"end"),s||(i.b?l():--i.group.r||run_all(i.group.c)),i=null;else if(t>=i.start){const e=t-i.start;o=i.a+i.d*u(e/i.duration),d(o,1-o)}return!(!i&&!s)})))}return{run(e){is_function(a)?wait().then((()=>{a=a(u),d(e)})):d(e)},end(){l(),i=s=null}}}function outro_and_destroy_block(e,t){transition_out(e,1,1,(()=>{t.delete(e.key)}))}function update_keyed_each(e,t,n,r,u,a,o,i,s,c,l,f){let d=e.length,p=a.length,m=d;const g={};for(;m--;)g[e[m].key]=m;const h=[],_=new Map,D=new Map;for(m=p;m--;){const e=f(u,a,m),i=n(e);let s=o.get(i);s?r&&s.p(e,t):(s=c(i,e),s.c()),_.set(i,h[m]=s),i in g&&D.set(i,Math.abs(m-g[i]))}const $=new Set,y=new Set;function v(e){transition_in(e,1),e.m(i,l),o.set(e.key,e),l=e.first,p--}for(;d&&p;){const t=h[p-1],n=e[d-1],r=t.key,u=n.key;t===n?(l=t.first,d--,p--):_.has(u)?!o.has(r)||$.has(r)?v(t):y.has(u)?d--:D.get(r)>D.get(u)?(y.add(r),v(t)):($.add(u),d--):(s(n,o),d--)}for(;d--;){const t=e[d];_.has(t.key)||s(t,o)}for(;p;)v(h[p-1]);return h}function create_component(e){e&&e.c()}function mount_component(e,t,n,r){const{fragment:u,after_update:a}=e.$$;u&&u.m(t,n),r||add_render_callback((()=>{const t=e.$$.on_mount.map(run$1).filter(is_function);e.$$.on_destroy?e.$$.on_destroy.push(...t):run_all(t),e.$$.on_mount=[]})),a.forEach(add_render_callback)}function destroy_component(e,t){const n=e.$$;null!==n.fragment&&(run_all(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function make_dirty(e,t){-1===e.$$.dirty[0]&&(dirty_components.push(e),schedule_update(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function init(e,t,n,r,u,a,o,i=[-1]){const s=current_component;set_current_component(e);const c=e.$$={fragment:null,ctx:[],props:a,update:noop,not_equal:u,bound:blank_object(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(s?s.$$.context:[])),callbacks:blank_object(),dirty:i,skip_bound:!1,root:t.target||s.$$.root};o&&o(c.root);let l=!1;if(c.ctx=n?n(e,t.props||{},((t,n,...r)=>{const a=r.length?r[0]:n;return c.ctx&&u(c.ctx[t],c.ctx[t]=a)&&(!c.skip_bound&&c.bound[t]&&c.bound[t](a),l&&make_dirty(e,t)),n})):[],c.update(),l=!0,run_all(c.before_update),c.fragment=!!r&&r(c.ctx),t.target){if(t.hydrate){const e=children(t.target);c.fragment&&c.fragment.l(e),e.forEach(detach)}else c.fragment&&c.fragment.c();t.intro&&transition_in(e.$$.fragment),mount_component(e,t.target,t.anchor,t.customElement),flush()}set_current_component(s)}class SvelteComponent{$destroy(){destroy_component(this,1),this.$destroy=noop}$on(e,t){if(!is_function(t))return noop;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){this.$$set&&!is_empty(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const subscriber_queue=[];function readable(e,t){return{subscribe:writable(e,t).subscribe}}function writable(e,t=noop){let n;const r=new Set;function u(t){if(safe_not_equal(e,t)&&(e=t,n)){const t=!subscriber_queue.length;for(const t of r)t[1](),subscriber_queue.push(t,e);if(t){for(let e=0;e<subscriber_queue.length;e+=2)subscriber_queue[e][0](subscriber_queue[e+1]);subscriber_queue.length=0}}}return{set:u,update:function(t){u(t(e))},subscribe:function(a,o=noop){const i=[a,o];return r.add(i),1===r.size&&(n=t(u)||noop),a(e),()=>{r.delete(i),0===r.size&&(n(),n=null)}}}}function newLogger(){let e=[],t=()=>{},n=!0;function r(r,u,a,o){let i=`${r} ${u}`,s=a&&"function"!=typeof a?a.message:void 0;s&&(i+=` (${s})`),o??=a&&"function"==typeof a?a:e=>console.log(e),n&&o(i),e.push(i),t(e)}let u=new Set;function a(e,t){u.has(e)||(u.add(e),n&&(t(e),console.trace()))}return{lines:readable(e,(e=>(t=e,()=>t=()=>{}))),info:(e,t,n)=>{r("I",e,t,n)},error:(e,t,n)=>{t&&t instanceof Error&&a(t,n),r("E",e,t,n)},noConsoleLog:()=>n=!1,onerror:function(e,t){try{return e()}catch(e){throw a(e,t),e}}}}const log=newLogger(),_l=console.log;function throwError(e,t){throw log.error(e,t),new Error(e)}function assert(e,t,n){if(e)return;let r="Assertion failed";t&&"function"!=typeof t&&(r+=`: (${t})`),n??=t&&"function"==typeof t?t:void 0,throwError(r,n)}function create_fragment$F(e){let t;return{c(){t=element("p"),t.textContent="Oops..."},m(e,n){insert(e,t,n)},p:noop,i:noop,o:noop,d(e){e&&detach(t)}}}Array.prototype.str=function(e,t){return e??=",",`[${(t?this.map((e=>t(e))):this).join(e)}]`},Array.prototype.take=function(e){return this.slice(0,e)},Array.prototype.removeDuplicates=function(e){e??=(e,t)=>e===t,1===e.length&&throwError("Compare by key is not implemented yet");var t=[];return this.forEach((n=>{for(let r of t)if(e(n,r))return;t.push(n)})),t},Array.prototype.hasUniqueValues=function(e){let t=this;if(0===t.length)return!0;e??=t[0]instanceof Decimal?(e,t)=>e.eq(t):(e,t)=>e===t,1===e.length&&throwError("Compare by key is not implemented yet");for(let n=0;n<t.length;n++)for(let r=n+1;r<this.length;r++)if(e(t[n],t[r]))return!1;return!0},Set.prototype.diff=function(e){let t=new Set(this);for(let n of e)t.delete(n);return t},Set.prototype.includes=function(e){for(let t of e)if(!this.has(t))return!1;return!0},Set.prototype.include=function(e){for(let t of e)this.add(t)},Set.prototype.str=function(e=","){return`[${[...this].join(e)}]`},String.prototype.splitTrim=function(e){return this.split(e).map((e=>e.trim()))},String.prototype.splitTrimNoEmpties=function(e){return this.split(e).map((e=>e.trim())).filter((e=>e.length>0))},String.prototype.isAsciiMath=function(){return this.startsWith("`")&&this.endsWith("`")},String.prototype.toAsciiMath=function(){return`\`${this.replaceAll("`","")}\``};class Oops extends SvelteComponent{constructor(e){super(),init(this,e,null,create_fragment$F,safe_not_equal,{})}}function get_each_context$a(e,t,n){const r=e.slice();return r[2]=t[n],r}function create_each_block$a(e){let t,n,r,u=e[2]+"";return{c(){t=element("p"),n=text(u),r=space(),attr(t,"class","text-xs text-left")},m(e,u){insert(e,t,u),append(t,n),append(t,r)},p(e,t){1&t&&u!==(u=e[2]+"")&&set_data(n,u)},d(e){e&&detach(t)}}}function create_fragment$E(e){let t,n=e[0],r=[];for(let t=0;t<n.length;t+=1)r[t]=create_each_block$a(get_each_context$a(e,n,t));return{c(){for(let e=0;e<r.length;e+=1)r[e].c();t=empty()},m(e,n){for(let t=0;t<r.length;t+=1)r[t].m(e,n);insert(e,t,n)},p(e,[u]){if(1&u){let a;for(n=e[0],a=0;a<n.length;a+=1){const o=get_each_context$a(e,n,a);r[a]?r[a].p(o,u):(r[a]=create_each_block$a(o),r[a].c(),r[a].m(t.parentNode,t))}for(;a<r.length;a+=1)r[a].d(1);r.length=n.length}},i:noop,o:noop,d(e){destroy_each(r,e),e&&detach(t)}}}function instance$E(e,t,n){let r,{lines:u}=log;return component_subscribe(e,u,(e=>n(0,r=e))),[r,u]}class Logger extends SvelteComponent{constructor(e){super(),init(this,e,instance$E,create_fragment$E,safe_not_equal,{})}}function create_fragment$D(e){let t,n,r,u,a,o;const i=e[6].default,s=create_slot(i,e,e[5],null);return{c(){t=element("div"),s&&s.c(),attr(t,"class",n="my-grid w-full h-full "+e[2]+" "+e[3]+" svelte-ytrcuc"),attr(t,"style",r="grid-area:"+e[1]+"; --areas: "+e[0].areas+"; --cols: "+e[0].cols+"; --rows: "+e[0].rows+"; "+e[4])},m(n,r){insert(n,t,r),s&&s.m(t,null),u=!0,a||(o=listen(t,"click",self$1(e[7])),a=!0)},p(e,[a]){s&&s.p&&(!u||32&a)&&update_slot_base(s,i,e,e[5],u?get_slot_changes(i,e[5],a,null):get_all_dirty_from_scope(e[5]),null),(!u||12&a&&n!==(n="my-grid w-full h-full "+e[2]+" "+e[3]+" svelte-ytrcuc"))&&attr(t,"class",n),(!u||19&a&&r!==(r="grid-area:"+e[1]+"; --areas: "+e[0].areas+"; --cols: "+e[0].cols+"; --rows: "+e[0].rows+"; "+e[4]))&&attr(t,"style",r)},i(e){u||(transition_in(s,e),u=!0)},o(e){transition_out(s,e),u=!1},d(e){e&&detach(t),s&&s.d(e),a=!1,o()}}}function getBgColor(e,t){let n=getContext("get-bg-color");return n?n(e,t):t??"bg-transparent"}function instance$D(e,t,n){let{$$slots:r={},$$scope:u}=t,{layout:a}=t,{ga:o="unset"}=t,{bgColor:i=getBgColor(o)}=t,{clazz:s=""}=t,{style:c=""}=t;return setContext("get-bg-color",(function(e,t){return a.bgColors?a.bgColors[e]??t??"bg-transparent":t??"bg-transparent"})),e.$$set=e=>{"layout"in e&&n(0,a=e.layout),"ga"in e&&n(1,o=e.ga),"bgColor"in e&&n(2,i=e.bgColor),"clazz"in e&&n(3,s=e.clazz),"style"in e&&n(4,c=e.style),"$$scope"in e&&n(5,u=e.$$scope)},[a,o,i,s,c,u,r,function(t){bubble.call(this,e,t)}]}class Grid extends SvelteComponent{constructor(e){super(),init(this,e,instance$D,create_fragment$D,safe_not_equal,{layout:0,ga:1,bgColor:2,clazz:3,style:4})}}function createVersions(){let e,t=[],n=0;function r(){e(t.length>0?t[n%t.length]:"")}return{current:readable("",(t=>{e=t})),add:(e,u=!1)=>{onMount((()=>(t.push(e),u&&(n=t.length-1),r(),()=>{t=t.filter((t=>t!==e)),r()})))},next:()=>{n++,r()}}}const versions=createVersions();function create_fragment$C(e){let t,n,r,u;return{c(){t=element("span"),n=text(e[1]),attr(t,"class","text-xs text-gray-300"),set_style(t,"grid-area",e[0])},m(a,o){insert(a,t,o),append(t,n),r||(u=listen(t,"click",e[4]),r=!0)},p(e,[r]){2&r&&set_data(n,e[1]),1&r&&set_style(t,"grid-area",e[0])},i:noop,o:noop,d(e){e&&detach(t),r=!1,u()}}}function instance$C(e,t,n){let r,{ga:u}=t,{v:a}=t;versions.add(a,!0);let{current:o}=versions;component_subscribe(e,o,(e=>n(1,r=e)));return e.$$set=e=>{"ga"in e&&n(0,u=e.ga),"v"in e&&n(3,a=e.v)},[u,r,o,a,()=>versions.next()]}class Version extends SvelteComponent{constructor(e){super(),init(this,e,instance$C,create_fragment$C,safe_not_equal,{ga:0,v:3})}}function create_fragment$B(e){let t,n;return{c(){t=element("span"),n=text(e[1]),attr(t,"class","text-xs text-gray-400"),set_style(t,"grid-area",e[0])},m(e,r){insert(e,t,r),append(t,n)},p(e,[r]){2&r&&set_data(n,e[1]),1&r&&set_style(t,"grid-area",e[0])},i:noop,o:noop,d(e){e&&detach(t)}}}function instance$B(e,t,n){let{ga:r}=t,{text:u}=t;return e.$$set=e=>{"ga"in e&&n(0,r=e.ga),"text"in e&&n(1,u=e.text)},[r,u]}class Powered extends SvelteComponent{constructor(e){super(),init(this,e,instance$B,create_fragment$B,safe_not_equal,{ga:0,text:1})}}var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function createCommonjsModule(e){var t={exports:{}};return e(t,t.exports),t.exports}var dist=createCommonjsModule((function(e,t){e.exports=function(){function e(e,t){return e(t={exports:{}},t.exports),t.exports}var t=e((function(e){var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)})),n=e((function(e){var t=e.exports={version:"2.6.5"};"number"==typeof __e&&(__e=t)}));n.version;var r=function(e){return"object"==typeof e?null!==e:"function"==typeof e},u=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e},a=function(e){try{return!!e()}catch(e){return!0}},o=!a((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})),i=t.document,s=r(i)&&r(i.createElement),c=function(e){return s?i.createElement(e):{}},l=!o&&!a((function(){return 7!=Object.defineProperty(c("div"),"a",{get:function(){return 7}}).a})),f=function(e,t){if(!r(e))return e;var n,u;if(t&&"function"==typeof(n=e.toString)&&!r(u=n.call(e)))return u;if("function"==typeof(n=e.valueOf)&&!r(u=n.call(e)))return u;if(!t&&"function"==typeof(n=e.toString)&&!r(u=n.call(e)))return u;throw TypeError("Can't convert object to primitive value")},d=Object.defineProperty,p=o?Object.defineProperty:function(e,t,n){if(u(e),t=f(t,!0),u(n),l)try{return d(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e},m={f:p},g=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},h=o?function(e,t,n){return m.f(e,t,g(1,n))}:function(e,t,n){return e[t]=n,e},_={}.hasOwnProperty,D=function(e,t){return _.call(e,t)},$=0,y=Math.random(),v=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++$+y).toString(36))},b=e((function(e){var r="__core-js_shared__",u=t[r]||(t[r]={});(e.exports=function(e,t){return u[e]||(u[e]=void 0!==t?t:{})})("versions",[]).push({version:n.version,mode:"global",copyright:" 2019 Denis Pushkarev (zloirock.ru)"})})),A=b("native-function-to-string",Function.toString),w=e((function(e){var r=v("src"),u="toString",a=(""+A).split(u);n.inspectSource=function(e){return A.call(e)},(e.exports=function(e,n,u,o){var i="function"==typeof u;i&&(D(u,"name")||h(u,"name",n)),e[n]!==u&&(i&&(D(u,r)||h(u,r,e[n]?""+e[n]:a.join(String(n)))),e===t?e[n]=u:o?e[n]?e[n]=u:h(e,n,u):(delete e[n],h(e,n,u)))})(Function.prototype,u,(function(){return"function"==typeof this&&this[r]||A.call(this)}))})),F=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e},C=function(e,t,n){if(F(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,u){return e.call(t,n,r,u)}}return function(){return e.apply(t,arguments)}},E="prototype",x=function(e,r,u){var a,o,i,s,c=e&x.F,l=e&x.G,f=e&x.S,d=e&x.P,p=e&x.B,m=l?t:f?t[r]||(t[r]={}):(t[r]||{})[E],g=l?n:n[r]||(n[r]={}),_=g[E]||(g[E]={});for(a in l&&(u=r),u)i=((o=!c&&m&&void 0!==m[a])?m:u)[a],s=p&&o?C(i,t):d&&"function"==typeof i?C(Function.call,i):i,m&&w(m,a,i,e&x.U),g[a]!=i&&h(g,a,s),d&&_[a]!=i&&(_[a]=i)};t.core=n,x.F=1,x.G=2,x.S=4,x.P=8,x.B=16,x.W=32,x.U=64,x.R=128;var k,B=x,S=Math.ceil,N=Math.floor,M=function(e){return isNaN(e=+e)?0:(e>0?N:S)(e)},P=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e},T=(k=!1,function(e,t){var n,r,u=String(P(e)),a=M(t),o=u.length;return a<0||a>=o?k?"":void 0:(n=u.charCodeAt(a))<55296||n>56319||a+1===o||(r=u.charCodeAt(a+1))<56320||r>57343?k?u.charAt(a):n:k?u.slice(a,a+2):r-56320+(n-55296<<10)+65536});B(B.P,"String",{codePointAt:function(e){return T(this,e)}}),n.String.codePointAt;var O=Math.max,q=Math.min,L=function(e,t){return(e=M(e))<0?O(e+t,0):q(e,t)},I=String.fromCharCode,V=String.fromCodePoint;B(B.S+B.F*(!!V&&1!=V.length),"String",{fromCodePoint:function(e){for(var t,n=arguments,r=[],u=arguments.length,a=0;u>a;){if(t=+n[a++],L(t,1114111)!==t)throw RangeError(t+" is not a valid code point");r.push(t<65536?I(t):I(55296+((t-=65536)>>10),t%1024+56320))}return r.join("")}}),n.String.fromCodePoint;var z,H,R,G,j,U,W,Z,X,J,Y,Q,K,ee,te={Space_Separator:/[\u1680\u2000-\u200A\u202F\u205F\u3000]/,ID_Start:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE83\uDE86-\uDE89\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]/,ID_Continue:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u09FC\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9-\u0AFF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D00-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19D9\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF9\u1D00-\u1DF9\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099\u309A\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDE00-\uDE3E\uDE47\uDE50-\uDE83\uDE86-\uDE99\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD47\uDD50-\uDD59]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4A\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/},ne={isSpaceSeparator:function(e){return"string"==typeof e&&te.Space_Separator.test(e)},isIdStartChar:function(e){return"string"==typeof e&&(e>="a"&&e<="z"||e>="A"&&e<="Z"||"$"===e||"_"===e||te.ID_Start.test(e))},isIdContinueChar:function(e){return"string"==typeof e&&(e>="a"&&e<="z"||e>="A"&&e<="Z"||e>="0"&&e<="9"||"$"===e||"_"===e||""===e||""===e||te.ID_Continue.test(e))},isDigit:function(e){return"string"==typeof e&&/[0-9]/.test(e)},isHexDigit:function(e){return"string"==typeof e&&/[0-9A-Fa-f]/.test(e)}},re=function(e,t){z=String(e),H="start",R=[],G=0,j=1,U=0,W=void 0,Z=void 0,X=void 0;do{W=ae(),me[H]()}while("eof"!==W.type);return"function"==typeof t?ue({"":X},"",t):X};function ue(e,t,n){var r=e[t];if(null!=r&&"object"==typeof r)for(var u in r){var a=ue(r,u,n);void 0===a?delete r[u]:r[u]=a}return n.call(e,t,r)}function ae(){for(J="default",Y="",Q=!1,K=1;;){ee=oe();var e=se[J]();if(e)return e}}function oe(){if(z[G])return String.fromCodePoint(z.codePointAt(G))}function ie(){var e=oe();return"\n"===e?(j++,U=0):e?U+=e.length:U++,e&&(G+=e.length),e}var se={default:function(){switch(ee){case"\t":case"\v":case"\f":case" ":case"":case"\ufeff":case"\n":case"\r":case"\u2028":case"\u2029":return void ie();case"/":return ie(),void(J="comment");case void 0:return ie(),ce("eof")}if(!ne.isSpaceSeparator(ee))return se[H]();ie()},comment:function(){switch(ee){case"*":return ie(),void(J="multiLineComment");case"/":return ie(),void(J="singleLineComment")}throw _e(ie())},multiLineComment:function(){switch(ee){case"*":return ie(),void(J="multiLineCommentAsterisk");case void 0:throw _e(ie())}ie()},multiLineCommentAsterisk:function(){switch(ee){case"*":return void ie();case"/":return ie(),void(J="default");case void 0:throw _e(ie())}ie(),J="multiLineComment"},singleLineComment:function(){switch(ee){case"\n":case"\r":case"\u2028":case"\u2029":return ie(),void(J="default");case void 0:return ie(),ce("eof")}ie()},value:function(){switch(ee){case"{":case"[":return ce("punctuator",ie());case"n":return ie(),le("ull"),ce("null",null);case"t":return ie(),le("rue"),ce("boolean",!0);case"f":return ie(),le("alse"),ce("boolean",!1);case"-":case"+":return"-"===ie()&&(K=-1),void(J="sign");case".":return Y=ie(),void(J="decimalPointLeading");case"0":return Y=ie(),void(J="zero");case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return Y=ie(),void(J="decimalInteger");case"I":return ie(),le("nfinity"),ce("numeric",1/0);case"N":return ie(),le("aN"),ce("numeric",NaN);case'"':case"'":return Q='"'===ie(),Y="",void(J="string")}throw _e(ie())},identifierNameStartEscape:function(){if("u"!==ee)throw _e(ie());ie();var e=pe();switch(e){case"$":case"_":break;default:if(!ne.isIdStartChar(e))throw $e()}Y+=e,J="identifierName"},identifierName:function(){switch(ee){case"$":case"_":case"":case"":return void(Y+=ie());case"\\":return ie(),void(J="identifierNameEscape")}if(!ne.isIdContinueChar(ee))return ce("identifier",Y);Y+=ie()},identifierNameEscape:function(){if("u"!==ee)throw _e(ie());ie();var e=pe();switch(e){case"$":case"_":case"":case"":break;default:if(!ne.isIdContinueChar(e))throw $e()}Y+=e,J="identifierName"},sign:function(){switch(ee){case".":return Y=ie(),void(J="decimalPointLeading");case"0":return Y=ie(),void(J="zero");case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return Y=ie(),void(J="decimalInteger");case"I":return ie(),le("nfinity"),ce("numeric",K*(1/0));case"N":return ie(),le("aN"),ce("numeric",NaN)}throw _e(ie())},zero:function(){switch(ee){case".":return Y+=ie(),void(J="decimalPoint");case"e":case"E":return Y+=ie(),void(J="decimalExponent");case"x":case"X":return Y+=ie(),void(J="hexadecimal")}return ce("numeric",0*K)},decimalInteger:function(){switch(ee){case".":return Y+=ie(),void(J="decimalPoint");case"e":case"E":return Y+=ie(),void(J="decimalExponent")}if(!ne.isDigit(ee))return ce("numeric",K*Number(Y));Y+=ie()},decimalPointLeading:function(){if(ne.isDigit(ee))return Y+=ie(),void(J="decimalFraction");throw _e(ie())},decimalPoint:function(){switch(ee){case"e":case"E":return Y+=ie(),void(J="decimalExponent")}return ne.isDigit(ee)?(Y+=ie(),void(J="decimalFraction")):ce("numeric",K*Number(Y))},decimalFraction:function(){switch(ee){case"e":case"E":return Y+=ie(),void(J="decimalExponent")}if(!ne.isDigit(ee))return ce("numeric",K*Number(Y));Y+=ie()},decimalExponent:function(){switch(ee){case"+":case"-":return Y+=ie(),void(J="decimalExponentSign")}if(ne.isDigit(ee))return Y+=ie(),void(J="decimalExponentInteger");throw _e(ie())},decimalExponentSign:function(){if(ne.isDigit(ee))return Y+=ie(),void(J="decimalExponentInteger");throw _e(ie())},decimalExponentInteger:function(){if(!ne.isDigit(ee))return ce("numeric",K*Number(Y));Y+=ie()},hexadecimal:function(){if(ne.isHexDigit(ee))return Y+=ie(),void(J="hexadecimalInteger");throw _e(ie())},hexadecimalInteger:function(){if(!ne.isHexDigit(ee))return ce("numeric",K*Number(Y));Y+=ie()},string:function(){switch(ee){case"\\":return ie(),void(Y+=fe());case'"':return Q?(ie(),ce("string",Y)):void(Y+=ie());case"'":return Q?void(Y+=ie()):(ie(),ce("string",Y));case"\n":case"\r":throw _e(ie());case"\u2028":case"\u2029":ye(ee);break;case void 0:throw _e(ie())}Y+=ie()},start:function(){switch(ee){case"{":case"[":return ce("punctuator",ie())}J="value"},beforePropertyName:function(){switch(ee){case"$":case"_":return Y=ie(),void(J="identifierName");case"\\":return ie(),void(J="identifierNameStartEscape");case"}":return ce("punctuator",ie());case'"':case"'":return Q='"'===ie(),void(J="string")}if(ne.isIdStartChar(ee))return Y+=ie(),void(J="identifierName");throw _e(ie())},afterPropertyName:function(){if(":"===ee)return ce("punctuator",ie());throw _e(ie())},beforePropertyValue:function(){J="value"},afterPropertyValue:function(){switch(ee){case",":case"}":return ce("punctuator",ie())}throw _e(ie())},beforeArrayValue:function(){if("]"===ee)return ce("punctuator",ie());J="value"},afterArrayValue:function(){switch(ee){case",":case"]":return ce("punctuator",ie())}throw _e(ie())},end:function(){throw _e(ie())}};function ce(e,t){return{type:e,value:t,line:j,column:U}}function le(e){for(var t=0,n=e;t<n.length;t+=1){var r=n[t];if(oe()!==r)throw _e(ie());ie()}}function fe(){switch(oe()){case"b":return ie(),"\b";case"f":return ie(),"\f";case"n":return ie(),"\n";case"r":return ie(),"\r";case"t":return ie(),"\t";case"v":return ie(),"\v";case"0":if(ie(),ne.isDigit(oe()))throw _e(ie());return"\0";case"x":return ie(),de();case"u":return ie(),pe();case"\n":case"\u2028":case"\u2029":return ie(),"";case"\r":return ie(),"\n"===oe()&&ie(),"";case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case void 0:throw _e(ie())}return ie()}function de(){var e="",t=oe();if(!ne.isHexDigit(t))throw _e(ie());if(e+=ie(),t=oe(),!ne.isHexDigit(t))throw _e(ie());return e+=ie(),String.fromCodePoint(parseInt(e,16))}function pe(){for(var e="",t=4;t-- >0;){var n=oe();if(!ne.isHexDigit(n))throw _e(ie());e+=ie()}return String.fromCodePoint(parseInt(e,16))}var me={start:function(){if("eof"===W.type)throw De();ge()},beforePropertyName:function(){switch(W.type){case"identifier":case"string":return Z=W.value,void(H="afterPropertyName");case"punctuator":return void he();case"eof":throw De()}},afterPropertyName:function(){if("eof"===W.type)throw De();H="beforePropertyValue"},beforePropertyValue:function(){if("eof"===W.type)throw De();ge()},beforeArrayValue:function(){if("eof"===W.type)throw De();"punctuator"!==W.type||"]"!==W.value?ge():he()},afterPropertyValue:function(){if("eof"===W.type)throw De();switch(W.value){case",":return void(H="beforePropertyName");case"}":he()}},afterArrayValue:function(){if("eof"===W.type)throw De();switch(W.value){case",":return void(H="beforeArrayValue");case"]":he()}},end:function(){}};function ge(){var e;switch(W.type){case"punctuator":switch(W.value){case"{":e={};break;case"[":e=[]}break;case"null":case"boolean":case"numeric":case"string":e=W.value}if(void 0===X)X=e;else{var t=R[R.length-1];Array.isArray(t)?t.push(e):t[Z]=e}if(null!==e&&"object"==typeof e)R.push(e),H=Array.isArray(e)?"beforeArrayValue":"beforePropertyName";else{var n=R[R.length-1];H=null==n?"end":Array.isArray(n)?"afterArrayValue":"afterPropertyValue"}}function he(){R.pop();var e=R[R.length-1];H=null==e?"end":Array.isArray(e)?"afterArrayValue":"afterPropertyValue"}function _e(e){return be(void 0===e?"JSON5: invalid end of input at "+j+":"+U:"JSON5: invalid character '"+ve(e)+"' at "+j+":"+U)}function De(){return be("JSON5: invalid end of input at "+j+":"+U)}function $e(){return be("JSON5: invalid identifier character at "+j+":"+(U-=5))}function ye(e){console.warn("JSON5: '"+ve(e)+"' in strings is not valid ECMAScript; consider escaping")}function ve(e){var t={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"};if(t[e])return t[e];if(e<" "){var n=e.charCodeAt(0).toString(16);return"\\x"+("00"+n).substring(n.length)}return e}function be(e){var t=new SyntaxError(e);return t.lineNumber=j,t.columnNumber=U,t}var Ae=function(e,t,n){var r,u,a,o=[],i="",s="";if(null==t||"object"!=typeof t||Array.isArray(t)||(n=t.space,a=t.quote,t=t.replacer),"function"==typeof t)u=t;else if(Array.isArray(t)){r=[];for(var c=0,l=t;c<l.length;c+=1){var f=l[c],d=void 0;"string"==typeof f?d=f:("number"==typeof f||f instanceof String||f instanceof Number)&&(d=String(f)),void 0!==d&&r.indexOf(d)<0&&r.push(d)}}return n instanceof Number?n=Number(n):n instanceof String&&(n=String(n)),"number"==typeof n?n>0&&(n=Math.min(10,Math.floor(n)),s="          ".substr(0,n)):"string"==typeof n&&(s=n.substr(0,10)),p("",{"":e});function p(e,t){var n=t[e];switch(null!=n&&("function"==typeof n.toJSON5?n=n.toJSON5(e):"function"==typeof n.toJSON&&(n=n.toJSON(e))),u&&(n=u.call(t,e,n)),n instanceof Number?n=Number(n):n instanceof String?n=String(n):n instanceof Boolean&&(n=n.valueOf()),n){case null:return"null";case!0:return"true";case!1:return"false"}return"string"==typeof n?m(n):"number"==typeof n?String(n):"object"==typeof n?Array.isArray(n)?_(n):g(n):void 0}function m(e){for(var t={"'":.1,'"':.2},n={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"},r="",u=0;u<e.length;u++){var o=e[u];switch(o){case"'":case'"':t[o]++,r+=o;continue;case"\0":if(ne.isDigit(e[u+1])){r+="\\x00";continue}}if(n[o])r+=n[o];else if(o<" "){var i=o.charCodeAt(0).toString(16);r+="\\x"+("00"+i).substring(i.length)}else r+=o}var s=a||Object.keys(t).reduce((function(e,n){return t[e]<t[n]?e:n}));return s+(r=r.replace(new RegExp(s,"g"),n[s]))+s}function g(e){if(o.indexOf(e)>=0)throw TypeError("Converting circular structure to JSON5");o.push(e);var t=i;i+=s;for(var n,u,a=[],c=0,l=r||Object.keys(e);c<l.length;c+=1){var f=l[c],d=p(f,e);if(void 0!==d){var m=h(f)+":";""!==s&&(m+=" "),m+=d,a.push(m)}}if(0===a.length)n="{}";else if(""===s)n="{"+(u=a.join(","))+"}";else{var g=",\n"+i;u=a.join(g),n="{\n"+i+u+",\n"+t+"}"}return o.pop(),i=t,n}function h(e){if(0===e.length)return m(e);var t=String.fromCodePoint(e.codePointAt(0));if(!ne.isIdStartChar(t))return m(e);for(var n=t.length;n<e.length;n++)if(!ne.isIdContinueChar(String.fromCodePoint(e.codePointAt(n))))return m(e);return e}function _(e){if(o.indexOf(e)>=0)throw TypeError("Converting circular structure to JSON5");o.push(e);var t=i;i+=s;for(var n,r=[],u=0;u<e.length;u++){var a=p(String(u),e);r.push(void 0!==a?a:"null")}if(0===r.length)n="[]";else if(""===s)n="["+r.join(",")+"]";else{var c=",\n"+i,l=r.join(c);n="[\n"+i+l+",\n"+t+"]"}return o.pop(),i=t,n}};return{parse:re,stringify:Ae}}()}));const run=e=>setTimeout(e,0),delay=e=>new Promise((t=>setTimeout(t,e))),_range=(e,t)=>Array.from({length:t-e},((t,n)=>n+e)),range=(e,t)=>t?_range(e,t):_range(0,e);function safe(e,t){try{return e()}catch(n){let r=e.name;return""===r&&(r="unknown"),log.error(`Error in ${r}`,n,(e=>_l(e))),t}}const splitNoEmpty=(e,t)=>e.split(t??" ").filter(Boolean).map((e=>e.trim()));function allAreUnique(e){let t=new Set;for(let n of e){let e=`${n}`;if(t.has(e))return!1;t.add(e)}return!0}function one2many(e){return void 0===e?[]:Array.isArray(e)?e:[e]}function fixCrInCells(e,t){return e.replaceAll(/\"([\s\S]*?)\"/g,((e,n)=>n.splitTrim("\n").join(t)))}function takeIf(e,t,n){let r=t();for(let u=e-1;u-- >0;){if(n(r))return r;r=t()}return log.error(`Can't find a satisfying variant (maxLoops=${e})`),r}class CAnki{hideLoader(){document.getElementById("loader").style.display="none"}getCard(){return ankiCard}getConfig(){try{let e=ankiCard.config?.trim();return e&&0!==e.length||(e=ankiCard.defaultConfig?.trim()),dist.parse(e)}catch(e){return log.error("Can't get config from Anki card",e,(e=>_l(e))),{}}}*commands(){if(!ankiCard.content.replaceAll("\n"," ").includes(";"))return;let e=ankiCard.content.split(";")[0];for(let t of splitNoEmpty(e,","))yield splitNoEmpty(t," ")}tokens(){let e=ankiCard.content.replaceAll("\n"," "),t=e.includes(";")?e.split(";")[1]:e;return splitNoEmpty(t,",")}}const Anki=new CAnki;let _initialized=!1,_refreshIsRequested=!1;function refresh(){_refreshIsRequested&&(_refreshIsRequested=!1,safe((()=>MathJax.typeset())))}function refreshMath(){_refreshIsRequested=!0,_initialized&&run(refresh)}function initMath(){run((async()=>{await delay(2e3),_initialized=!0,refresh()}))}function _rand(e,t){return e=Math.ceil(e),t=Math.floor(t+1),Math.floor(Math.random()*(t-e)+e)}function rand(e,t){return"number"==typeof e?void 0!==t?_rand(e,t):_rand(0,e):Array.isArray(e)?_rand(e[0],e[1]):_rand(e.min,e.max)}function randFrom(e){return e[_rand(0,e.length-1)]}function randFromIf(e,t){let n=e.filter(t);return n[_rand(0,n.length-1)]}const trueFalse=()=>0==_rand(0,1),randSign=()=>0==_rand(0,1)?1:-1;function pm(e){let t=0==_rand(0,1)?1:-1;return"number"==typeof e?e*t:e.mul(t)}function randId(e,t){t??="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var n="",r=0;r<e;r++){var u=Math.floor(Math.random()*t.length);n+=t.charAt(u)}return n}function shuffle(e){let t=[...e];for(let e=t.length-1;e>0;e--){const n=Math.floor(Math.random()*(e+1));[t[e],t[n]]=[t[n],t[e]]}return t}const names=["yes","no","done","idle","sound-on","sound-off","on-drag-start","on-drag-end","time-is-up"];let _library=new Map,_soundOn=!0;function loadFrom(e){function t(e,n,r){let u=new Audio(""===e?`${n}-${r}.mp3`:`${e}/${n}-${r}.mp3`);u.addEventListener("canplaythrough",(a=>{_library.get(n).push(u),run((()=>t(e,n,r+1)))}),{once:!0})}names.forEach((n=>{_library.set(n,[]),run((()=>t(e,n,1)))}))}function play(e){let t=_library.get(e);t&&0!==t.length&&randFrom(t).play().catch((e=>{}))}class CMp3{play(e){_soundOn&&play(e)}buildMp3Library(e,t){_soundOn=t,run((()=>loadFrom(""))),run((()=>loadFrom(e)))}soundSwitch(e){_soundOn!==e&&(play(e?"sound-on":"sound-off"),_soundOn=e)}playRandom(){_soundOn&&play(randFrom(names))}get soundIsOn(){return _soundOn}}const Mp3=new CMp3;let _activeDrags=new Set;function beingDragged(e){return _activeDrags.has(e)}function handleDragEvents(e,t){let n={id:t?.id??randId(5),snapTo:t?.snapTo??[1,1]},r=-1,u={x:0,y:0},a={x:0,y:0},o=0;function i(t,n){switch(t){case"drag:start":_activeDrags.add(e);break;case"drag:end":_activeDrags.delete(e)}e.dispatchEvent(new CustomEvent(t,{detail:n}))}function s(e,t){let r={x:.5+e.clientX|0,y:.5+e.clientY|0};t??=r;let u={x:r.x-t.x,y:r.y-t.y};return{id:n.id,start:t,offset:u}}function c(e){if(-1!==r)return i("drag:other");let t=e.changedTouches[0],n=s(t);r=t.identifier,u=n.start,a=n.offset,o=0,i("drag:start",n)}function l(e){let t=e.changedTouches[0];if(r!==t.identifier)return o++;let c=s(t,u);if(!function(e,t){return!(Math.abs(t.x-e.offset.x)<n.snapTo[0]&&Math.abs(t.y-e.offset.y)<n.snapTo[1]||(e.offset.x-=e.offset.x%n.snapTo[0],e.offset.y-=e.offset.y%n.snapTo[1],0))}(c,a))return o++;a=c.offset,i("drag:move",c)}async function f(e){let t=e.changedTouches[0];if(r!==t.identifier)return i("drag:other");let n=s(t,u);r=-1,i("drag:end",n)}return e.addEventListener("touchstart",c,{passive:!0}),e.addEventListener("touchmove",l,{passive:!0}),e.addEventListener("touchend",f,{passive:!0}),e.addEventListener("touchcancel",f,{passive:!0}),{destroy(){e.removeEventListener("touchstart",c),e.removeEventListener("touchmove",l),e.removeEventListener("touchend",f),e.removeEventListener("touchcancel",f)}}}let Config$1={duration:500,interval:1e4,jitter:7e3},zoomOut=[{transform:"scale(1, 1)"},{transform:"scale(1.03, 1.03)"},{transform:"scale(1, 1)"}],zoomIn=[{transform:"scale(1, 1)"},{transform:"scale(0.98, 0.98)"},{transform:"scale(1, 1)"}],xShift=[{transform:"translate(0px, 0px)"},{transform:"translate(-1px, 0px)"},{transform:"translate(+1px, 0px)"},{transform:"translate(0px, 0px)"}],yShift=[{transform:"translate(0px, 0px)"},{transform:"translate(0px, -1px)"},{transform:"translate(0px, +1px)"},{transform:"translate(0px, 0px)"}],xyShift=[{transform:"translate(0px, 0px)"},{transform:"translate(-1px, -1px)"},{transform:"translate(+1px, +1px)"},{transform:"translate(0px, 0px)"}],yxShift=[{transform:"translate(0px, 0px)"},{transform:"translate(+1px, -1px)"},{transform:"translate(-1px, +1px)"},{transform:"translate(0px, 0px)"}],rotate=[{transform:"rotate(0deg)"},{transform:"rotate(-2deg)"},{transform:"rotate(+2deg)"},{transform:"rotate(0deg)"}],pulses=[zoomOut,zoomIn,xShift,yShift,xyShift,yxShift,rotate];async function startPulsing(e,t){for(;;){let{interval:n,jitter:r,duration:u}=t,a=rand(n-r,n+r);if(await delay(a),beingDragged(e))continue;let o=randFrom(pulses);e.animate(o,u)}}function pulse(e,t){run((()=>startPulsing(e,t??Config$1)))}function bounceOnDrag(e,t){function n(t){let n=[{transform:"translate3d(0px, 0px, 0px)"}];e.animate(n,{duration:100,easing:"cubic-bezier(.87,.74,.96,1.83)"}).onfinish=()=>{e.style.transform=null}}function r(e){Mp3.play("on-drag-start")}function u(t){var n;n=t.detail.offset,e.style.transform=`translate3d(${n.x}px, ${n.y}px, 0px)`}function a(e){Mp3.play("on-drag-end"),n(e.detail.offset)}t??={},t.snapTo??=[5,5],e.addEventListener("drag:start",r),e.addEventListener("drag:move",u),e.addEventListener("drag:end",a);let o=handleDragEvents(e,t);return{destroy(){o.destroy(),e.removeEventListener("drag:start",r),e.removeEventListener("drag:move",u),e.removeEventListener("drag:end",a)}}}function soundsOnDrag(e,t){function n(e){Mp3.play(t.get("drag:start"))}function r(e){Mp3.play(t.get("drag:end"))}t??=new Map,e.addEventListener("drag:start",n),e.addEventListener("drag:end",r);let u=handleDragEvents(e);return{destroy(){u.destroy(),e.removeEventListener("drag:start",n),e.removeEventListener("drag:end",r)}}}function get_each_context$9(e,t,n){const r=e.slice();return r[7]=t[n],r}function get_each_context_1$1(e,t,n){const r=e.slice();return r[10]=t[n],r}function create_each_block_1$1(e){let t;return{c(){t=svg_element("line"),attr(t,"class","minor svelte-3bw95i"),attr(t,"y1","42"),attr(t,"y2","45"),attr(t,"transform","rotate("+6*(e[7]+e[10])+")")},m(e,n){insert(e,t,n)},p:noop,d(e){e&&detach(t)}}}function create_each_block$9(e){let t,n,r=[1,2,3,4],u=[];for(let t=0;t<4;t+=1)u[t]=create_each_block_1$1(get_each_context_1$1(e,r,t));return{c(){t=svg_element("line");for(let e=0;e<4;e+=1)u[e].c();n=empty(),attr(t,"class","major svelte-3bw95i"),attr(t,"y1","35"),attr(t,"y2","45"),attr(t,"transform","rotate("+30*e[7]+")")},m(e,r){insert(e,t,r);for(let t=0;t<4;t+=1)u[t].m(e,r);insert(e,n,r)},p:noop,d(e){e&&detach(t),destroy_each(u,e),e&&detach(n)}}}function create_fragment$A(e){let t,n,r,u,a,o,i,s,c,l,f,d,p,m=[0,5,10,15,20,25,30,35,40,45,50,55],g=[];for(let t=0;t<12;t+=1)g[t]=create_each_block$9(get_each_context$9(e,m,t));return{c(){t=svg_element("svg"),n=svg_element("circle");for(let e=0;e<12;e+=1)g[e].c();u=svg_element("line"),o=svg_element("line"),s=svg_element("g"),c=svg_element("line"),l=svg_element("line"),attr(n,"class",r=null_to_empty(e[1]?"clock-face-enabled":"clock-face-disabled")+" svelte-3bw95i"),attr(n,"r","48"),attr(u,"class","hour svelte-3bw95i"),attr(u,"y1","2"),attr(u,"y2","-20"),attr(u,"transform",a="rotate("+(30*e[4]+e[3]/2)+")"),attr(o,"class","minute svelte-3bw95i"),attr(o,"y1","4"),attr(o,"y2","-30"),attr(o,"transform",i="rotate("+(6*e[3]+e[2]/10)+")"),attr(c,"class","second svelte-3bw95i"),attr(c,"y1","10"),attr(c,"y2","-38"),attr(l,"class","second-counterweight svelte-3bw95i"),attr(l,"y1","10"),attr(l,"y2","2"),attr(s,"transform",f="rotate("+6*e[2]+")"),attr(t,"viewBox","-50 -50 100 100"),set_style(t,"grid-area",e[0]),attr(t,"class","svelte-3bw95i")},m(r,a){insert(r,t,a),append(t,n);for(let e=0;e<12;e+=1)g[e].m(t,null);append(t,u),append(t,o),append(t,s),append(s,c),append(s,l),d||(p=[listen(t,"click",e[5]),action_destroyer(pulse.call(null,t)),action_destroyer(bounceOnDrag.call(null,t))],d=!0)},p(e,[c]){2&c&&r!==(r=null_to_empty(e[1]?"clock-face-enabled":"clock-face-disabled")+" svelte-3bw95i")&&attr(n,"class",r),24&c&&a!==(a="rotate("+(30*e[4]+e[3]/2)+")")&&attr(u,"transform",a),12&c&&i!==(i="rotate("+(6*e[3]+e[2]/10)+")")&&attr(o,"transform",i),4&c&&f!==(f="rotate("+6*e[2]+")")&&attr(s,"transform",f),1&c&&set_style(t,"grid-area",e[0])},i:noop,o:noop,d(e){e&&detach(t),destroy_each(g,e),d=!1,run_all(p)}}}function instance$A(e,t,n){let r,u,a,{ga:o}=t,i=Mp3.soundIsOn,s=new Date;return onMount((()=>{const e=setInterval((()=>{n(6,s=new Date)}),1e3);return()=>{clearInterval(e)}})),e.$$set=e=>{"ga"in e&&n(0,o=e.ga)},e.$$.update=()=>{64&e.$$.dirty&&n(4,r=s.getHours()),64&e.$$.dirty&&n(3,u=s.getMinutes()),64&e.$$.dirty&&n(2,a=s.getSeconds())},[o,i,a,u,r,function(){n(1,i^=!0),Mp3.soundSwitch(i)},s]}class Clock extends SvelteComponent{constructor(e){super(),init(this,e,instance$A,create_fragment$A,safe_not_equal,{ga:0})}}var defaultInstanceSettings={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0},defaultTweenSettings={duration:1e3,delay:0,endDelay:0,easing:"easeOutElastic(1, .5)",round:0},validTransforms=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],cache={CSS:{},springs:{}};function minMax(e,t,n){return Math.min(Math.max(e,t),n)}function stringContains(e,t){return e.indexOf(t)>-1}function applyArguments(e,t){return e.apply(null,t)}var is={arr:function(e){return Array.isArray(e)},obj:function(e){return stringContains(Object.prototype.toString.call(e),"Object")},pth:function(e){return is.obj(e)&&e.hasOwnProperty("totalLength")},svg:function(e){return e instanceof SVGElement},inp:function(e){return e instanceof HTMLInputElement},dom:function(e){return e.nodeType||is.svg(e)},str:function(e){return"string"==typeof e},fnc:function(e){return"function"==typeof e},und:function(e){return void 0===e},nil:function(e){return is.und(e)||null===e},hex:function(e){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)},rgb:function(e){return/^rgb/.test(e)},hsl:function(e){return/^hsl/.test(e)},col:function(e){return is.hex(e)||is.rgb(e)||is.hsl(e)},key:function(e){return!defaultInstanceSettings.hasOwnProperty(e)&&!defaultTweenSettings.hasOwnProperty(e)&&"targets"!==e&&"keyframes"!==e}};function parseEasingParameters(e){var t=/\(([^)]+)\)/.exec(e);return t?t[1].split(",").map((function(e){return parseFloat(e)})):[]}function spring(e,t){var n=parseEasingParameters(e),r=minMax(is.und(n[0])?1:n[0],.1,100),u=minMax(is.und(n[1])?100:n[1],.1,100),a=minMax(is.und(n[2])?10:n[2],.1,100),o=minMax(is.und(n[3])?0:n[3],.1,100),i=Math.sqrt(u/r),s=a/(2*Math.sqrt(u*r)),c=s<1?i*Math.sqrt(1-s*s):0,l=s<1?(s*i-o)/c:-o+i;function f(e){var n=t?t*e/1e3:e;return n=s<1?Math.exp(-n*s*i)*(1*Math.cos(c*n)+l*Math.sin(c*n)):(1+l*n)*Math.exp(-n*i),0===e||1===e?e:1-n}return t?f:function(){var t=cache.springs[e];if(t)return t;for(var n=1/6,r=0,u=0;;)if(1===f(r+=n)){if(++u>=16)break}else u=0;var a=r*n*1e3;return cache.springs[e]=a,a}}function steps(e){return void 0===e&&(e=10),function(t){return Math.ceil(minMax(t,1e-6,1)*e)*(1/e)}}var bezier=function(){var e=.1;function t(e,t){return 1-3*t+3*e}function n(e,t){return 3*t-6*e}function r(e){return 3*e}function u(e,u,a){return((t(u,a)*e+n(u,a))*e+r(u))*e}function a(e,u,a){return 3*t(u,a)*e*e+2*n(u,a)*e+r(u)}return function(t,n,r,o){if(0<=t&&t<=1&&0<=r&&r<=1){var i=new Float32Array(11);if(t!==n||r!==o)for(var s=0;s<11;++s)i[s]=u(s*e,t,r);return function(e){return t===n&&r===o||0===e||1===e?e:u(c(e),n,o)}}function c(n){for(var o=0,s=1;10!==s&&i[s]<=n;++s)o+=e;--s;var c=o+(n-i[s])/(i[s+1]-i[s])*e,l=a(c,t,r);return l>=.001?function(e,t,n,r){for(var o=0;o<4;++o){var i=a(t,n,r);if(0===i)return t;t-=(u(t,n,r)-e)/i}return t}(n,c,t,r):0===l?c:function(e,t,n,r,a){var o,i,s=0;do{(o=u(i=t+(n-t)/2,r,a)-e)>0?n=i:t=i}while(Math.abs(o)>1e-7&&++s<10);return i}(n,o,o+e,t,r)}}}(),penner=(eases={linear:function(){return function(e){return e}}},functionEasings={Sine:function(){return function(e){return 1-Math.cos(e*Math.PI/2)}},Circ:function(){return function(e){return 1-Math.sqrt(1-e*e)}},Back:function(){return function(e){return e*e*(3*e-2)}},Bounce:function(){return function(e){for(var t,n=4;e<((t=Math.pow(2,--n))-1)/11;);return 1/Math.pow(4,3-n)-7.5625*Math.pow((3*t-2)/22-e,2)}},Elastic:function(e,t){void 0===e&&(e=1),void 0===t&&(t=.5);var n=minMax(e,1,10),r=minMax(t,.1,2);return function(e){return 0===e||1===e?e:-n*Math.pow(2,10*(e-1))*Math.sin((e-1-r/(2*Math.PI)*Math.asin(1/n))*(2*Math.PI)/r)}}},["Quad","Cubic","Quart","Quint","Expo"].forEach((function(e,t){functionEasings[e]=function(){return function(e){return Math.pow(e,t+2)}}})),Object.keys(functionEasings).forEach((function(e){var t=functionEasings[e];eases["easeIn"+e]=t,eases["easeOut"+e]=function(e,n){return function(r){return 1-t(e,n)(1-r)}},eases["easeInOut"+e]=function(e,n){return function(r){return r<.5?t(e,n)(2*r)/2:1-t(e,n)(-2*r+2)/2}},eases["easeOutIn"+e]=function(e,n){return function(r){return r<.5?(1-t(e,n)(1-2*r))/2:(t(e,n)(2*r-1)+1)/2}}})),eases),eases,functionEasings;function parseEasings(e,t){if(is.fnc(e))return e;var n=e.split("(")[0],r=penner[n],u=parseEasingParameters(e);switch(n){case"spring":return spring(e,t);case"cubicBezier":return applyArguments(bezier,u);case"steps":return applyArguments(steps,u);default:return applyArguments(r,u)}}function selectString(e){try{return document.querySelectorAll(e)}catch(e){return}}function filterArray(e,t){for(var n=e.length,r=arguments.length>=2?arguments[1]:void 0,u=[],a=0;a<n;a++)if(a in e){var o=e[a];t.call(r,o,a,e)&&u.push(o)}return u}function flattenArray(e){return e.reduce((function(e,t){return e.concat(is.arr(t)?flattenArray(t):t)}),[])}function toArray(e){return is.arr(e)?e:(is.str(e)&&(e=selectString(e)||e),e instanceof NodeList||e instanceof HTMLCollection?[].slice.call(e):[e])}function arrayContains(e,t){return e.some((function(e){return e===t}))}function cloneObject(e){var t={};for(var n in e)t[n]=e[n];return t}function replaceObjectProps(e,t){var n=cloneObject(e);for(var r in e)n[r]=t.hasOwnProperty(r)?t[r]:e[r];return n}function mergeObjects(e,t){var n=cloneObject(e);for(var r in t)n[r]=is.und(e[r])?t[r]:e[r];return n}function rgbToRgba(e){var t=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(e);return t?"rgba("+t[1]+",1)":e}function hexToRgba(e){var t=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(e,t,n,r){return t+t+n+n+r+r})),n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return"rgba("+parseInt(n[1],16)+","+parseInt(n[2],16)+","+parseInt(n[3],16)+",1)"}function hslToRgba(e){var t,n,r,u=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(e)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(e),a=parseInt(u[1],10)/360,o=parseInt(u[2],10)/100,i=parseInt(u[3],10)/100,s=u[4]||1;function c(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}if(0==o)t=n=r=i;else{var l=i<.5?i*(1+o):i+o-i*o,f=2*i-l;t=c(f,l,a+1/3),n=c(f,l,a),r=c(f,l,a-1/3)}return"rgba("+255*t+","+255*n+","+255*r+","+s+")"}function colorToRgb(e){return is.rgb(e)?rgbToRgba(e):is.hex(e)?hexToRgba(e):is.hsl(e)?hslToRgba(e):void 0}function getUnit(e){var t=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(e);if(t)return t[1]}function getTransformUnit(e){return stringContains(e,"translate")||"perspective"===e?"px":stringContains(e,"rotate")||stringContains(e,"skew")?"deg":void 0}function getFunctionValue(e,t){return is.fnc(e)?e(t.target,t.id,t.total):e}function getAttribute(e,t){return e.getAttribute(t)}function convertPxToUnit(e,t,n){if(arrayContains([n,"deg","rad","turn"],getUnit(t)))return t;var r=cache.CSS[t+n];if(!is.und(r))return r;var u=document.createElement(e.tagName),a=e.parentNode&&e.parentNode!==document?e.parentNode:document.body;a.appendChild(u),u.style.position="absolute",u.style.width=100+n;var o=100/u.offsetWidth;a.removeChild(u);var i=o*parseFloat(t);return cache.CSS[t+n]=i,i}function getCSSValue(e,t,n){if(t in e.style){var r=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),u=e.style[t]||getComputedStyle(e).getPropertyValue(r)||"0";return n?convertPxToUnit(e,u,n):u}}function getAnimationType(e,t){return is.dom(e)&&!is.inp(e)&&(!is.nil(getAttribute(e,t))||is.svg(e)&&e[t])?"attribute":is.dom(e)&&arrayContains(validTransforms,t)?"transform":is.dom(e)&&"transform"!==t&&getCSSValue(e,t)?"css":null!=e[t]?"object":void 0}function getElementTransforms(e){if(is.dom(e)){for(var t,n=e.style.transform||"",r=/(\w+)\(([^)]*)\)/g,u=new Map;t=r.exec(n);)u.set(t[1],t[2]);return u}}function getTransformValue(e,t,n,r){var u=stringContains(t,"scale")?1:0+getTransformUnit(t),a=getElementTransforms(e).get(t)||u;return n&&(n.transforms.list.set(t,a),n.transforms.last=t),r?convertPxToUnit(e,a,r):a}function getOriginalTargetValue(e,t,n,r){switch(getAnimationType(e,t)){case"transform":return getTransformValue(e,t,r,n);case"css":return getCSSValue(e,t,n);case"attribute":return getAttribute(e,t);default:return e[t]||0}}function getRelativeValue(e,t){var n=/^(\*=|\+=|-=)/.exec(e);if(!n)return e;var r=getUnit(e)||0,u=parseFloat(t),a=parseFloat(e.replace(n[0],""));switch(n[0][0]){case"+":return u+a+r;case"-":return u-a+r;case"*":return u*a+r}}function validateValue(e,t){if(is.col(e))return colorToRgb(e);if(/\s/g.test(e))return e;var n=getUnit(e),r=n?e.substr(0,e.length-n.length):e;return t?r+t:r}function getDistance(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function getCircleLength(e){return 2*Math.PI*getAttribute(e,"r")}function getRectLength(e){return 2*getAttribute(e,"width")+2*getAttribute(e,"height")}function getLineLength(e){return getDistance({x:getAttribute(e,"x1"),y:getAttribute(e,"y1")},{x:getAttribute(e,"x2"),y:getAttribute(e,"y2")})}function getPolylineLength(e){for(var t,n=e.points,r=0,u=0;u<n.numberOfItems;u++){var a=n.getItem(u);u>0&&(r+=getDistance(t,a)),t=a}return r}function getPolygonLength(e){var t=e.points;return getPolylineLength(e)+getDistance(t.getItem(t.numberOfItems-1),t.getItem(0))}function getTotalLength(e){if(e.getTotalLength)return e.getTotalLength();switch(e.tagName.toLowerCase()){case"circle":return getCircleLength(e);case"rect":return getRectLength(e);case"line":return getLineLength(e);case"polyline":return getPolylineLength(e);case"polygon":return getPolygonLength(e)}}function setDashoffset(e){var t=getTotalLength(e);return e.setAttribute("stroke-dasharray",t),t}function getParentSvgEl(e){for(var t=e.parentNode;is.svg(t)&&is.svg(t.parentNode);)t=t.parentNode;return t}function getParentSvg(e,t){var n=t||{},r=n.el||getParentSvgEl(e),u=r.getBoundingClientRect(),a=getAttribute(r,"viewBox"),o=u.width,i=u.height,s=n.viewBox||(a?a.split(" "):[0,0,o,i]);return{el:r,viewBox:s,x:s[0]/1,y:s[1]/1,w:o,h:i,vW:s[2],vH:s[3]}}function getPath(e,t){var n=is.str(e)?selectString(e)[0]:e,r=t||100;return function(e){return{property:e,el:n,svg:getParentSvg(n),totalLength:getTotalLength(n)*(r/100)}}}function getPathProgress(e,t,n){function r(n){void 0===n&&(n=0);var r=t+n>=1?t+n:0;return e.el.getPointAtLength(r)}var u=getParentSvg(e.el,e.svg),a=r(),o=r(-1),i=r(1),s=n?1:u.w/u.vW,c=n?1:u.h/u.vH;switch(e.property){case"x":return(a.x-u.x)*s;case"y":return(a.y-u.y)*c;case"angle":return 180*Math.atan2(i.y-o.y,i.x-o.x)/Math.PI}}function decomposeValue(e,t){var n=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g,r=validateValue(is.pth(e)?e.totalLength:e,t)+"";return{original:r,numbers:r.match(n)?r.match(n).map(Number):[0],strings:is.str(e)||t?r.split(n):[]}}function parseTargets(e){return filterArray(e?flattenArray(is.arr(e)?e.map(toArray):toArray(e)):[],(function(e,t,n){return n.indexOf(e)===t}))}function getAnimatables(e){var t=parseTargets(e);return t.map((function(e,n){return{target:e,id:n,total:t.length,transforms:{list:getElementTransforms(e)}}}))}function normalizePropertyTweens(e,t){var n=cloneObject(t);if(/^spring/.test(n.easing)&&(n.duration=spring(n.easing)),is.arr(e)){var r=e.length;2===r&&!is.obj(e[0])?e={value:e}:is.fnc(t.duration)||(n.duration=t.duration/r)}var u=is.arr(e)?e:[e];return u.map((function(e,n){var r=is.obj(e)&&!is.pth(e)?e:{value:e};return is.und(r.delay)&&(r.delay=n?0:t.delay),is.und(r.endDelay)&&(r.endDelay=n===u.length-1?t.endDelay:0),r})).map((function(e){return mergeObjects(e,n)}))}function flattenKeyframes(e){for(var t=filterArray(flattenArray(e.map((function(e){return Object.keys(e)}))),(function(e){return is.key(e)})).reduce((function(e,t){return e.indexOf(t)<0&&e.push(t),e}),[]),n={},r=function(r){var u=t[r];n[u]=e.map((function(e){var t={};for(var n in e)is.key(n)?n==u&&(t.value=e[n]):t[n]=e[n];return t}))},u=0;u<t.length;u++)r(u);return n}function getProperties(e,t){var n=[],r=t.keyframes;for(var u in r&&(t=mergeObjects(flattenKeyframes(r),t)),t)is.key(u)&&n.push({name:u,tweens:normalizePropertyTweens(t[u],e)});return n}function normalizeTweenValues(e,t){var n={};for(var r in e){var u=getFunctionValue(e[r],t);is.arr(u)&&1===(u=u.map((function(e){return getFunctionValue(e,t)}))).length&&(u=u[0]),n[r]=u}return n.duration=parseFloat(n.duration),n.delay=parseFloat(n.delay),n}function normalizeTweens(e,t){var n;return e.tweens.map((function(r){var u=normalizeTweenValues(r,t),a=u.value,o=is.arr(a)?a[1]:a,i=getUnit(o),s=getOriginalTargetValue(t.target,e.name,i,t),c=n?n.to.original:s,l=is.arr(a)?a[0]:c,f=getUnit(l)||getUnit(s),d=i||f;return is.und(o)&&(o=c),u.from=decomposeValue(l,d),u.to=decomposeValue(getRelativeValue(o,l),d),u.start=n?n.end:0,u.end=u.start+u.delay+u.duration+u.endDelay,u.easing=parseEasings(u.easing,u.duration),u.isPath=is.pth(a),u.isPathTargetInsideSVG=u.isPath&&is.svg(t.target),u.isColor=is.col(u.from.original),u.isColor&&(u.round=1),n=u,u}))}var setProgressValue={css:function(e,t,n){return e.style[t]=n},attribute:function(e,t,n){return e.setAttribute(t,n)},object:function(e,t,n){return e[t]=n},transform:function(e,t,n,r,u){if(r.list.set(t,n),t===r.last||u){var a="";r.list.forEach((function(e,t){a+=t+"("+e+") "})),e.style.transform=a}}};function setTargetsValue(e,t){getAnimatables(e).forEach((function(e){for(var n in t){var r=getFunctionValue(t[n],e),u=e.target,a=getUnit(r),o=getOriginalTargetValue(u,n,a,e),i=getRelativeValue(validateValue(r,a||getUnit(o)),o),s=getAnimationType(u,n);setProgressValue[s](u,n,i,e.transforms,!0)}}))}function createAnimation(e,t){var n=getAnimationType(e.target,t.name);if(n){var r=normalizeTweens(t,e),u=r[r.length-1];return{type:n,property:t.name,animatable:e,tweens:r,duration:u.end,delay:r[0].delay,endDelay:u.endDelay}}}function getAnimations(e,t){return filterArray(flattenArray(e.map((function(e){return t.map((function(t){return createAnimation(e,t)}))}))),(function(e){return!is.und(e)}))}function getInstanceTimings(e,t){var n=e.length,r=function(e){return e.timelineOffset?e.timelineOffset:0},u={};return u.duration=n?Math.max.apply(Math,e.map((function(e){return r(e)+e.duration}))):t.duration,u.delay=n?Math.min.apply(Math,e.map((function(e){return r(e)+e.delay}))):t.delay,u.endDelay=n?u.duration-Math.max.apply(Math,e.map((function(e){return r(e)+e.duration-e.endDelay}))):t.endDelay,u}var instanceID=0;function createNewInstance(e){var t=replaceObjectProps(defaultInstanceSettings,e),n=replaceObjectProps(defaultTweenSettings,e),r=getProperties(n,e),u=getAnimatables(e.targets),a=getAnimations(u,r),o=getInstanceTimings(a,n),i=instanceID;return instanceID++,mergeObjects(t,{id:i,children:[],animatables:u,animations:a,duration:o.duration,delay:o.delay,endDelay:o.endDelay})}var activeInstances=[],engine=function(){var e;function t(n){for(var r=activeInstances.length,u=0;u<r;){var a=activeInstances[u];a.paused?(activeInstances.splice(u,1),r--):(a.tick(n),u++)}e=u>0?requestAnimationFrame(t):void 0}return"undefined"!=typeof document&&document.addEventListener("visibilitychange",(function(){anime.suspendWhenDocumentHidden&&(isDocumentHidden()?e=cancelAnimationFrame(e):(activeInstances.forEach((function(e){return e._onDocumentVisibility()})),engine()))})),function(){e||isDocumentHidden()&&anime.suspendWhenDocumentHidden||!(activeInstances.length>0)||(e=requestAnimationFrame(t))}}();function isDocumentHidden(){return!!document&&document.hidden}function anime(e){void 0===e&&(e={});var t,n=0,r=0,u=0,a=0,o=null;function i(e){var t=window.Promise&&new Promise((function(e){return o=e}));return e.finished=t,t}var s=createNewInstance(e);function c(){var e=s.direction;"alternate"!==e&&(s.direction="normal"!==e?"normal":"reverse"),s.reversed=!s.reversed,t.forEach((function(e){return e.reversed=s.reversed}))}function l(e){return s.reversed?s.duration-e:e}function f(){n=0,r=l(s.currentTime)*(1/anime.speed)}function d(e,t){t&&t.seek(e-t.timelineOffset)}function p(e){for(var t=0,n=s.animations,r=n.length;t<r;){var u=n[t],a=u.animatable,o=u.tweens,i=o.length-1,c=o[i];i&&(c=filterArray(o,(function(t){return e<t.end}))[0]||c);for(var l=minMax(e-c.start-c.delay,0,c.duration)/c.duration,f=isNaN(l)?1:c.easing(l),d=c.to.strings,p=c.round,m=[],g=c.to.numbers.length,h=void 0,_=0;_<g;_++){var D=void 0,$=c.to.numbers[_],y=c.from.numbers[_]||0;D=c.isPath?getPathProgress(c.value,f*$,c.isPathTargetInsideSVG):y+f*($-y),p&&(c.isColor&&_>2||(D=Math.round(D*p)/p)),m.push(D)}var v=d.length;if(v){h=d[0];for(var b=0;b<v;b++){d[b];var A=d[b+1],w=m[b];isNaN(w)||(h+=A?w+A:w+" ")}}else h=m[0];setProgressValue[u.type](a.target,u.property,h,a.transforms),u.currentValue=h,t++}}function m(e){s[e]&&!s.passThrough&&s[e](s)}function g(e){var f=s.duration,g=s.delay,h=f-s.endDelay,_=l(e);s.progress=minMax(_/f*100,0,100),s.reversePlayback=_<s.currentTime,t&&function(e){if(s.reversePlayback)for(var n=a;n--;)d(e,t[n]);else for(var r=0;r<a;r++)d(e,t[r])}(_),!s.began&&s.currentTime>0&&(s.began=!0,m("begin")),!s.loopBegan&&s.currentTime>0&&(s.loopBegan=!0,m("loopBegin")),_<=g&&0!==s.currentTime&&p(0),(_>=h&&s.currentTime!==f||!f)&&p(f),_>g&&_<h?(s.changeBegan||(s.changeBegan=!0,s.changeCompleted=!1,m("changeBegin")),m("change"),p(_)):s.changeBegan&&(s.changeCompleted=!0,s.changeBegan=!1,m("changeComplete")),s.currentTime=minMax(_,0,f),s.began&&m("update"),e>=f&&(r=0,s.remaining&&!0!==s.remaining&&s.remaining--,s.remaining?(n=u,m("loopComplete"),s.loopBegan=!1,"alternate"===s.direction&&c()):(s.paused=!0,s.completed||(s.completed=!0,m("loopComplete"),m("complete"),!s.passThrough&&"Promise"in window&&(o(),i(s)))))}return i(s),s.reset=function(){var e=s.direction;s.passThrough=!1,s.currentTime=0,s.progress=0,s.paused=!0,s.began=!1,s.loopBegan=!1,s.changeBegan=!1,s.completed=!1,s.changeCompleted=!1,s.reversePlayback=!1,s.reversed="reverse"===e,s.remaining=s.loop,t=s.children;for(var n=a=t.length;n--;)s.children[n].reset();(s.reversed&&!0!==s.loop||"alternate"===e&&1===s.loop)&&s.remaining++,p(s.reversed?s.duration:0)},s._onDocumentVisibility=f,s.set=function(e,t){return setTargetsValue(e,t),s},s.tick=function(e){u=e,n||(n=u),g((u+(r-n))*anime.speed)},s.seek=function(e){g(l(e))},s.pause=function(){s.paused=!0,f()},s.play=function(){s.paused&&(s.completed&&s.reset(),s.paused=!1,activeInstances.push(s),f(),engine())},s.reverse=function(){c(),s.completed=!s.reversed,f()},s.restart=function(){s.reset(),s.play()},s.remove=function(e){removeTargetsFromInstance(parseTargets(e),s)},s.reset(),s.autoplay&&s.play(),s}function removeTargetsFromAnimations(e,t){for(var n=t.length;n--;)arrayContains(e,t[n].animatable.target)&&t.splice(n,1)}function removeTargetsFromInstance(e,t){var n=t.animations,r=t.children;removeTargetsFromAnimations(e,n);for(var u=r.length;u--;){var a=r[u],o=a.animations;removeTargetsFromAnimations(e,o),o.length||a.children.length||r.splice(u,1)}n.length||r.length||t.pause()}function removeTargetsFromActiveInstances(e){for(var t=parseTargets(e),n=activeInstances.length;n--;){removeTargetsFromInstance(t,activeInstances[n])}}function stagger(e,t){void 0===t&&(t={});var n=t.direction||"normal",r=t.easing?parseEasings(t.easing):null,u=t.grid,a=t.axis,o=t.from||0,i="first"===o,s="center"===o,c="last"===o,l=is.arr(e),f=l?parseFloat(e[0]):parseFloat(e),d=l?parseFloat(e[1]):0,p=getUnit(l?e[1]:e)||0,m=t.start||0+(l?f:0),g=[],h=0;return function(e,t,_){if(i&&(o=0),s&&(o=(_-1)/2),c&&(o=_-1),!g.length){for(var D=0;D<_;D++){if(u){var $=s?(u[0]-1)/2:o%u[0],y=s?(u[1]-1)/2:Math.floor(o/u[0]),v=$-D%u[0],b=y-Math.floor(D/u[0]),A=Math.sqrt(v*v+b*b);"x"===a&&(A=-v),"y"===a&&(A=-b),g.push(A)}else g.push(Math.abs(o-D));h=Math.max.apply(Math,g)}r&&(g=g.map((function(e){return r(e/h)*h}))),"reverse"===n&&(g=g.map((function(e){return a?e<0?-1*e:-e:Math.abs(h-e)})))}return m+(l?(d-f)/h:f)*(Math.round(100*g[t])/100)+p}}function timeline(e){void 0===e&&(e={});var t=anime(e);return t.duration=0,t.add=function(n,r){var u=activeInstances.indexOf(t),a=t.children;function o(e){e.passThrough=!0}u>-1&&activeInstances.splice(u,1);for(var i=0;i<a.length;i++)o(a[i]);var s=mergeObjects(n,replaceObjectProps(defaultTweenSettings,e));s.targets=s.targets||e.targets;var c=t.duration;s.autoplay=!1,s.direction=t.direction,s.timelineOffset=is.und(r)?c:getRelativeValue(r,c),o(t),t.seek(s.timelineOffset);var l=anime(s);o(l),a.push(l);var f=getInstanceTimings(a,e);return t.delay=f.delay,t.endDelay=f.endDelay,t.duration=f.duration,t.seek(0),t.reset(),t.autoplay&&t.play(),t},t}function get_each_context$8(e,t,n){const r=e.slice();return r[7]=t[n],r[8]=t,r[9]=n,r}function create_each_block$8(e){let t,n,r,u,a,o,i=e[8],s=e[9];const c=()=>e[5](t,i,s),l=()=>e[5](null,i,s);return{c(){t=element("div"),n=svg_element("svg"),r=svg_element("polygon"),o=space(),attr(r,"fill",u=e[7].color),attr(r,"stroke",a=e[7].color),attr(r,"stroke-width","37.6152"),attr(r,"stroke-linecap","round"),attr(r,"stroke-linejoin","round"),attr(r,"stroke-miterlimit","10"),attr(r,"points","259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 \r\n                            401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 \r\n                            29.274,197.007 188.165,173.919"),attr(n,"xmlns","http://www.w3.org/2000/svg"),attr(n,"viewBox","0 0 512 512"),attr(t,"class","box svelte-moqp60"),set_style(t,"--size",e[2].size+"px"),set_style(t,"--left",e[2].pos[0]+"px"),set_style(t,"--top",e[2].pos[1]+"px")},m(e,u){insert(e,t,u),append(t,n),append(n,r),append(t,o),c()},p(t,n){e=t,1&n&&u!==(u=e[7].color)&&attr(r,"fill",u),1&n&&a!==(a=e[7].color)&&attr(r,"stroke",a),i===e[8]&&s===e[9]||(l(),i=e[8],s=e[9],c())},d(e){e&&detach(t),l()}}}function create_fragment$z(e){let t,n=e[0],r=[];for(let t=0;t<n.length;t+=1)r[t]=create_each_block$8(get_each_context$8(e,n,t));return{c(){t=element("div");for(let e=0;e<r.length;e+=1)r[e].c();attr(t,"class","svelte-moqp60"),toggle_class(t,"hidden",e[1])},m(e,n){insert(e,t,n);for(let e=0;e<r.length;e+=1)r[e].m(t,null)},p(e,[u]){if(5&u){let a;for(n=e[0],a=0;a<n.length;a+=1){const o=get_each_context$8(e,n,a);r[a]?r[a].p(o,u):(r[a]=create_each_block$8(o),r[a].c(),r[a].m(t,null))}for(;a<r.length;a+=1)r[a].d(1);r.length=n.length}2&u&&toggle_class(t,"hidden",e[1])},i:noop,o:noop,d(e){e&&detach(t),destroy_each(r,e)}}}function instance$z(e,t,n){let r,u={size:18,pos:[100,120],xSeed:[20,100],ySeed:[20,120],duration:1500},a=!0;function o(){anime({targets:r.map((e=>e.box)),translateX:0,translateY:0,rotate:0,opacity:1,duration:0})}let{noOfStars:i=150}=t;return r=range(0,i).map((()=>({box:void 0,color:randFrom(["yellow","orange","red"])}))),onMount(o),e.$$set=e=>{"noOfStars"in e&&n(4,i=e.noOfStars)},[r,a,u,function(){o(),n(1,a=!1),anime({targets:r.map((e=>e.box)),translateX:()=>randFrom([1,-1])*(u.xSeed[0]+rand(0,u.xSeed[1])),translateY:()=>randFrom([1,-1])*(u.ySeed[0]+rand(0,u.ySeed[1])),rotate:()=>rand(200,360),scale:()=>1+rand(1,10)/10,delay:()=>rand(150,300),opacity:{value:0,easing:"linear",delay:u.duration-200,duration:500},easing:"easeOutElastic",duration:u.duration,complete:()=>n(1,a=!0)})},i,function(e,t,u){binding_callbacks[e?"unshift":"push"]((()=>{t[u].box=e,n(0,r)}))}]}anime.version="3.2.1",anime.speed=1,anime.suspendWhenDocumentHidden=!0,anime.running=activeInstances,anime.remove=removeTargetsFromActiveInstances,anime.get=getOriginalTargetValue,anime.set=setTargetsValue,anime.convertPx=convertPxToUnit,anime.path=getPath,anime.setDashoffset=setDashoffset,anime.stagger=stagger,anime.timeline=timeline,anime.easing=parseEasings,anime.penner=penner,anime.random=function(e,t){return Math.floor(Math.random()*(t-e+1))+e};class Congrats extends SvelteComponent{constructor(e){super(),init(this,e,instance$z,create_fragment$z,safe_not_equal,{play:3,noOfStars:4})}get play(){return this.$$.ctx[3]}}let callbacks={},_game$1;function onAny(e,t){let n=callbacks[e]??[];n.push(t),callbacks[e]=n}function fireAny(e,t){(callbacks[e]??[]).forEach((e=>setTimeout((()=>e(t)),0)))}class CTimedCmd{constructor(e,t,n){this._cmd=e,this._timeout=t,this._jitter=n??0}set(){let e=rand(this._timeout-this._jitter,this._timeout+this._jitter);this._timeoutId=setTimeout((()=>fireAny(this._cmd,{})),e)}cancel(){clearTimeout(this._timeoutId)}reset(){this.cancel(),this.set()}}function on$4(e,t){onAny(e,t)}function fire$4(e,t){fireAny(e,t)}function newTimedCmd$3(e,t,n){return new CTimedCmd(e,t,n??0)}let _tcNewRound=newTimedCmd$3("--cmd-new-round",1e3),_tcIdle=newTimedCmd$3("--cmd-idle",1e4,3e3),_playbook=[],_roundNo=-1,_m=[1,8];function getPair(){let e=Anki.tokens(),t=[];for(let n=0;n<e.length-1;n+=2)t.push([parseInt(e[n]),parseInt(e[n+1])]);return randFrom(t)}function splitToLines(e){let t=[],n=[];for(let r of Anki.tokens()){let u=parseInt(r);n.push(u),n.length==e&&(t.push(n),n=[])}return t}function getLine(){return randFrom(splitToLines(4))}function addPlusRound(){let e=getPair(),t=(e[0]+e[1])%10,n=e[0],r=rand(_m[0],_m[1]),u=10*r+n,a=e[1],o=10*rand(_m[0],_m[1]+1-r)+a,i=u+o,s=shuffle([u,o]),c=shuffle([i,i+randSign()*rand(1,9),i>50?i-10:i+10]),l=c.findIndex((e=>e==i));_playbook.push({pair:e,nums:s,op:"+",sumDigit:t,answers:c,rightAt:l})}function addMinusRound(){let e=getPair(),t=(e[0]+e[1])%10,n=e[0],r=rand(_m[0],_m[1]+1),u=10*r+n,a=10*rand(_m[0],_m[1]+1-r)+e[1],o=u+a,i=[o,trueFalse()?u:a],s=o-i[1],c=shuffle([s,s+rand(1,9)*randSign(),s>50?s-10:s+10]),l=c.findIndex((e=>e==s));_playbook.push({pair:e,nums:i,op:"-",sumDigit:t,answers:c,rightAt:l})}function addMulRound(){let e=getLine(),t=rand(e[0],e[1]),n=rand(e[2],e[3]),r=[t%10,n%10],u=shuffle([t,n]),a=t*n,o=a%10,i=shuffle([a,a+randSign()*Math.min(...u),a>50?a-10:a+10]),s=i.findIndex((e=>e==a));_playbook.push({pair:r,nums:u,op:"x",sumDigit:o,answers:i,rightAt:s})}function addDivRound(){let e=getLine(),t=rand(e[0],e[1]),n=rand(e[2],e[3]),r=t*n,u=[t%10,n%10],a=[r,randFrom([t,n])],o=r/a[1],i=t*n%10,s=shuffle([o,o>2?o+randSign():o+1,o>50?o-10:o+10]),c=s.findIndex((e=>e==o));_playbook.push({pair:u,nums:a,op:"/",sumDigit:i,answers:s,rightAt:c})}function addNextRounds(){switch(Anki.getConfig().game.toLocaleLowerCase()){case"plus-over":addPlusRound(),addMinusRound();break;case"mul-div":addMulRound(),addDivRound()}}function fillRoundsAtStart(){for(let e=Anki.getConfig().rounds??4;e-- >0;)addNextRounds()}class CPlusOver{constructor(){for(let e of Anki.commands())if("m"===e[0].toLocaleLowerCase())_m=e.slice(1).map((e=>parseInt(e)))}newRound(){let e=Anki.getConfig();_tcIdle.reset(),_tcNewRound.cancel(),_roundNo++,_roundNo>=_playbook.length&&log.error(`Round index out of bound: ${_roundNo} length=${_playbook.length}`,(e=>_l(e)));let t=_playbook[_roundNo],n=_playbook.length-_roundNo,r=e.showHint??!0;_game$1={roundsLeft:n,clickedAt:0,state:"first-click",showHint:r,...t},fire$4("--cmd-update-views",_game$1)}gotClicked(){switch(_game$1.state){case"first-click":fire$4("--evt-answer");break;case"answered":fire$4("--cmd-new-round")}}yesNo(){if("answered"!==_game$1.state)return;if(_game$1.roundsLeft<=0)return;fire$4(_game$1.clickedAt===_game$1.rightAt?"--evt-yes":"--evt-no")}gotAnswer(e){switch(_tcIdle.reset(),_game$1.state){case"first-click":_game$1.state="active";break;case"active":_game$1.clickedAt=e.index,_game$1.state="answered",this.yesNo();break;case"answered":return void fire$4("--cmd-new-round")}fire$4("--cmd-update-views",_game$1)}yes(){1===_game$1.roundsLeft?fire$4("--evt-done"):Mp3.play("yes"),_tcNewRound.reset()}no(){Mp3.play("no"),addNextRounds()}done(){Mp3.play("done"),addNextRounds()}idle(){_tcIdle.reset(),Mp3.play("idle")}}const PlusOver=new CPlusOver;function create_fragment$y(e){let t,n,r,u;return{c(){t=element("button"),n=text(e[2]),attr(t,"class",e[3]),set_style(t,"grid-area",e[0]),set_style(t,"font-size",e[1])},m(e,a){insert(e,t,a),append(t,n),r||(u=[action_destroyer(pulse.call(null,t)),action_destroyer(bounceOnDrag.call(null,t))],r=!0)},p(e,[r]){4&r&&set_data(n,e[2]),1&r&&set_style(t,"grid-area",e[0]),2&r&&set_style(t,"font-size",e[1])},i:noop,o:noop,d(e){e&&detach(t),r=!1,run_all(u)}}}function instance$y(e,t,n){let r,{ga:u}=t,{sz:a="30px"}=t;on$4("--cmd-update-views",(function(e){n(2,r=e.roundsLeft.toString())}));let o=getBgColor(u);return e.$$set=e=>{"ga"in e&&n(0,u=e.ga),"sz"in e&&n(1,a=e.sz)},[u,a,r,o]}fillRoundsAtStart();class Count$2 extends SvelteComponent{constructor(e){super(),init(this,e,instance$y,create_fragment$y,safe_not_equal,{ga:0,sz:1})}}function create_fragment$x(e){let t,n,r,u;return{c(){t=element("button"),n=text(e[1]),attr(t,"class",e[3]),set_style(t,"grid-area",e[0]),set_style(t,"font-size",e[2]+"px")},m(a,o){insert(a,t,o),append(t,n),r||(u=[listen(t,"click",e[4]),action_destroyer(pulse.call(null,t)),action_destroyer(bounceOnDrag.call(null,t)),action_destroyer(soundsOnDrag.call(null,t,new Map([["drag:start","yes"],["drag:end","no"]])))],r=!0)},p(e,[r]){2&r&&set_data(n,e[1]),1&r&&set_style(t,"grid-area",e[0]),4&r&&set_style(t,"font-size",e[2]+"px")},i:noop,o:noop,d(e){e&&detach(t),r=!1,run_all(u)}}}function instance$x(e,t,n){let r,u,a,{ga:o}=t,{index:i}=t,{sz:s=30}=t,c=getBgColor(o);return on$4("--cmd-update-views",(function(e){n(1,r=e.nums[i].toLocaleString("en")),u=r.length<=3?1.2:2,n(2,a=s-u*r.length)})),e.$$set=e=>{"ga"in e&&n(0,o=e.ga),"index"in e&&n(5,i=e.index),"sz"in e&&n(6,s=e.sz)},[o,r,a,c,function(){fire$4("--evt-click")},i,s]}class Num$2 extends SvelteComponent{constructor(e){super(),init(this,e,instance$x,create_fragment$x,safe_not_equal,{ga:0,index:5,sz:6})}}function create_fragment$w(e){let t,n,r,u;return{c(){t=element("button"),n=text(e[2]),attr(t,"class",e[3]),set_style(t,"grid-area",e[0]),set_style(t,"font-size",e[1])},m(a,o){insert(a,t,o),append(t,n),r||(u=[listen(t,"click",e[4]),action_destroyer(pulse.call(null,t)),action_destroyer(bounceOnDrag.call(null,t))],r=!0)},p(e,[r]){4&r&&set_data(n,e[2]),1&r&&set_style(t,"grid-area",e[0]),2&r&&set_style(t,"font-size",e[1])},i:noop,o:noop,d(e){e&&detach(t),r=!1,run_all(u)}}}function instance$w(e,t,n){let{ga:r}=t,{sz:u="30px"}=t,a="+",o=getBgColor(r);on$4("--cmd-update-views",(function(e){n(2,a=e.op)}));return e.$$set=e=>{"ga"in e&&n(0,r=e.ga),"sz"in e&&n(1,u=e.sz)},[r,u,a,o,()=>Mp3.playRandom()]}class Op$1 extends SvelteComponent{constructor(e){super(),init(this,e,instance$w,create_fragment$w,safe_not_equal,{ga:0,sz:1})}}function create_fragment$v(e){let t,n,r,u;return{c(){t=element("button"),n=text(e[1]),attr(t,"class",e[2]),set_style(t,"grid-area",e[0]),set_style(t,"font-size",e[3]+"px")},m(a,o){insert(a,t,o),append(t,n),r||(u=[listen(t,"click",e[4]),action_destroyer(pulse.call(null,t)),action_destroyer(bounceOnDrag.call(null,t))],r=!0)},p(e,[r]){2&r&&set_data(n,e[1]),4&r&&attr(t,"class",e[2]),1&r&&set_style(t,"grid-area",e[0]),8&r&&set_style(t,"font-size",e[3]+"px")},i:noop,o:noop,d(e){e&&detach(t),r=!1,run_all(u)}}}function instance$v(e,t,n){let r,u,a,o,{ga:i}=t,{index:s}=t,{sz:c=30}=t;return on$4("--cmd-update-views",(function(e){n(1,r=function(e){return"first-click"===e.state?"??":e.answers[s].toLocaleString("en")}(e)),n(2,u=function(e){return"first-click"===e.state?"bg-gray-100":"active"===e.state?"bg-orange-200":e.rightAt===s?"bg-green-200":e.clickedAt!==s?"bg-gray-100":"bg-red-200"}(e)),a=r.length<=3?1.2:2,n(3,o=c-a*r.length)})),e.$$set=e=>{"ga"in e&&n(0,i=e.ga),"index"in e&&n(5,s=e.index),"sz"in e&&n(6,c=e.sz)},[i,r,u,o,function(){fire$4("--evt-answer",{index:s})},s,c]}class Ans$3 extends SvelteComponent{constructor(e){super(),init(this,e,instance$v,create_fragment$v,safe_not_equal,{ga:0,index:5,sz:6})}}function create_fragment$u(e){let t,n,r,u,a,o,i,s;return{c(){t=element("div"),n=element("button"),r=text(e[2]),u=space(),a=element("button"),o=text(e[3]),attr(n,"class",e[4]),attr(a,"class",e[4]),set_style(t,"grid-area",e[0]),set_style(t,"font-size",e[1])},m(e,c){insert(e,t,c),append(t,n),append(n,r),append(t,u),append(t,a),append(a,o),i||(s=[action_destroyer(pulse.call(null,n)),action_destroyer(bounceOnDrag.call(null,n)),action_destroyer(pulse.call(null,a)),action_destroyer(bounceOnDrag.call(null,a))],i=!0)},p(e,[n]){4&n&&set_data(r,e[2]),8&n&&set_data(o,e[3]),1&n&&set_style(t,"grid-area",e[0]),2&n&&set_style(t,"font-size",e[1])},i:noop,o:noop,d(e){e&&detach(t),i=!1,run_all(s)}}}function instance$u(e,t,n){let{ga:r}=t,{sz:u="15px"}=t,a=getBgColor(r),o="?",i="?";return on$4("--cmd-update-views",(function(e){n(2,o=e.showHint?e.pair[0].toString():"?"),n(3,i=e.showHint?e.pair[1].toString():"?")})),e.$$set=e=>{"ga"in e&&n(0,r=e.ga),"sz"in e&&n(1,u=e.sz)},[r,u,o,i,a]}class Pair extends SvelteComponent{constructor(e){super(),init(this,e,instance$u,create_fragment$u,safe_not_equal,{ga:0,sz:1})}}function create_fragment$t(e){let t,n,r,u,a;return{c(){t=element("div"),n=element("button"),r=text(e[2]),attr(n,"class",e[3]),set_style(t,"grid-area",e[0]),set_style(t,"font-size",e[1])},m(e,o){insert(e,t,o),append(t,n),append(n,r),u||(a=[action_destroyer(pulse.call(null,n)),action_destroyer(bounceOnDrag.call(null,n))],u=!0)},p(e,[n]){4&n&&set_data(r,e[2]),1&n&&set_style(t,"grid-area",e[0]),2&n&&set_style(t,"font-size",e[1])},i:noop,o:noop,d(e){e&&detach(t),u=!1,run_all(a)}}}function instance$t(e,t,n){let r,{ga:u}=t,{sz:a="15px"}=t,o=getBgColor(u);return on$4("--cmd-update-views",(function(e){n(2,r=e.showHint?e.sumDigit.toString():"?")})),e.$$set=e=>{"ga"in e&&n(0,u=e.ga),"sz"in e&&n(1,a=e.sz)},[u,a,r,o]}class Digit extends SvelteComponent{constructor(e){super(),init(this,e,instance$t,create_fragment$t,safe_not_equal,{ga:0,sz:1})}}function create_default_slot$8(e){let t,n,r,u,a,o,i,s,c,l,f,d,p,m,g,h,_,D,$,y,v,b;t=new Count$2({props:{ga:"cnt"}}),r=new Pair({props:{ga:"p1"}}),a=new Digit({props:{ga:"p2"}}),i=new Clock({props:{ga:"clk"}}),c=new Num$2({props:{ga:"lhs",index:0}}),f=new Op$1({props:{ga:"op"}}),p=new Num$2({props:{ga:"rhs",index:1}}),g=new Ans$3({props:{ga:"a1",index:0}}),_=new Ans$3({props:{ga:"a2",index:1}}),$=new Ans$3({props:{ga:"a3",index:2}});return v=new Congrats({props:{}}),e[2](v),{c(){create_component(t.$$.fragment),n=space(),create_component(r.$$.fragment),u=space(),create_component(a.$$.fragment),o=space(),create_component(i.$$.fragment),s=space(),create_component(c.$$.fragment),l=space(),create_component(f.$$.fragment),d=space(),create_component(p.$$.fragment),m=space(),create_component(g.$$.fragment),h=space(),create_component(_.$$.fragment),D=space(),create_component($.$$.fragment),y=space(),create_component(v.$$.fragment)},m(e,A){mount_component(t,e,A),insert(e,n,A),mount_component(r,e,A),insert(e,u,A),mount_component(a,e,A),insert(e,o,A),mount_component(i,e,A),insert(e,s,A),mount_component(c,e,A),insert(e,l,A),mount_component(f,e,A),insert(e,d,A),mount_component(p,e,A),insert(e,m,A),mount_component(g,e,A),insert(e,h,A),mount_component(_,e,A),insert(e,D,A),mount_component($,e,A),insert(e,y,A),mount_component(v,e,A),b=!0},p(e,t){v.$set({})},i(e){b||(transition_in(t.$$.fragment,e),transition_in(r.$$.fragment,e),transition_in(a.$$.fragment,e),transition_in(i.$$.fragment,e),transition_in(c.$$.fragment,e),transition_in(f.$$.fragment,e),transition_in(p.$$.fragment,e),transition_in(g.$$.fragment,e),transition_in(_.$$.fragment,e),transition_in($.$$.fragment,e),transition_in(v.$$.fragment,e),b=!0)},o(e){transition_out(t.$$.fragment,e),transition_out(r.$$.fragment,e),transition_out(a.$$.fragment,e),transition_out(i.$$.fragment,e),transition_out(c.$$.fragment,e),transition_out(f.$$.fragment,e),transition_out(p.$$.fragment,e),transition_out(g.$$.fragment,e),transition_out(_.$$.fragment,e),transition_out($.$$.fragment,e),transition_out(v.$$.fragment,e),b=!1},d(b){destroy_component(t,b),b&&detach(n),destroy_component(r,b),b&&detach(u),destroy_component(a,b),b&&detach(o),destroy_component(i,b),b&&detach(s),destroy_component(c,b),b&&detach(l),destroy_component(f,b),b&&detach(d),destroy_component(p,b),b&&detach(m),destroy_component(g,b),b&&detach(h),destroy_component(_,b),b&&detach(D),destroy_component($,b),b&&detach(y),e[2](null),destroy_component(v,b)}}}function create_fragment$s(e){let t,n;return t=new Grid({props:{layout:e[1],$$slots:{default:[create_default_slot$8]},$$scope:{ctx:e}}}),t.$on("click",e[3]),{c(){create_component(t.$$.fragment)},m(e,r){mount_component(t,e,r),n=!0},p(e,[n]){const r={};33&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(transition_in(t.$$.fragment,e),n=!0)},o(e){transition_out(t.$$.fragment,e),n=!1},d(e){destroy_component(t,e)}}}function instance$s(e,t,n){let r;on$4("--cmd-new-round",(()=>PlusOver.newRound())),on$4("--evt-answer",(e=>PlusOver.gotAnswer(e))),on$4("--evt-click",(()=>PlusOver.gotClicked())),on$4("--evt-done",(()=>(r.play(),void PlusOver.done()))),on$4("--evt-yes",(()=>PlusOver.yes())),on$4("--evt-no",(()=>PlusOver.no())),on$4("--cmd-idle",(()=>PlusOver.idle())),fire$4("--cmd-new-round");return[r,{areas:'\n            "cnt   p1   clk "\n            "cnt   p2   clk "\n            "lhs   op   rhs "\n            "a1    a2   a3  "\n        ',cols:"1fr 1fr 1fr",rows:"30px 30px 100px 100px",bgColors:{cnt:"bg-purple-300",p1:"bg-yellow-100",p2:"bg-pink-100",lhs:"bg-green-100",op:"bg-yellow-200",rhs:"bg-green-100"}},function(e){binding_callbacks[e?"unshift":"push"]((()=>{r=e,n(0,r)}))},()=>fire$4("--evt-click")]}class Main$4 extends SvelteComponent{constructor(e){super(),init(this,e,instance$s,create_fragment$s,safe_not_equal,{})}}function on$3(e,t){onAny(e,t)}function fire$3(e,t){fireAny(e,t)}let _game;class CGcdLcm{get game(){return _game}newRound(){_game={roundsLeft:2,nums:[4,5],divisors:[{factor:2,mxPow:3},{factor:3,mxPow:3},{factor:5,mxPow:2},{factor:7,mxPow:1}]},fire$3("--cmd-set-models",_game)}go(){}done(){}idle(){}}const GcdLcm=new CGcdLcm;function create_fragment$r(e){let t,n,r,u;return{c(){t=element("button"),n=text(_go),attr(t,"class",e[2]),set_style(t,"grid-area",e[0]),set_style(t,"font-size",e[1])},m(a,o){insert(a,t,o),append(t,n),r||(u=[listen(t,"click",e[3]),action_destroyer(pulse.call(null,t))],r=!0)},p(e,[n]){1&n&&set_style(t,"grid-area",e[0]),2&n&&set_style(t,"font-size",e[1])},i:noop,o:noop,d(e){e&&detach(t),r=!1,run_all(u)}}}let _go="GO";function instance$r(e,t,n){let{ga:r}=t,{sz:u="30px"}=t,a=getBgColor(r);return e.$$set=e=>{"ga"in e&&n(0,r=e.ga),"sz"in e&&n(1,u=e.sz)},[r,u,a,function(){fire$3("--evt-go"),Mp3.play(randFrom(["yes","no","idle"]))}]}class Go extends SvelteComponent{constructor(e){super(),init(this,e,instance$r,create_fragment$r,safe_not_equal,{ga:0,sz:1})}}function create_fragment$q(e){let t,n,r,u;return{c(){t=element("button"),n=text(e[2]),attr(t,"class",e[3]),set_style(t,"grid-area",e[0]),set_style(t,"font-size",e[1])},m(e,a){insert(e,t,a),append(t,n),r||(u=action_destroyer(pulse.call(null,t)),r=!0)},p(e,[r]){4&r&&set_data(n,e[2]),1&r&&set_style(t,"grid-area",e[0]),2&r&&set_style(t,"font-size",e[1])},i:noop,o:noop,d(e){e&&detach(t),r=!1,u()}}}function instance$q(e,t,n){let{ga:r}=t,{sz:u="30px"}=t,a=2,o=getBgColor(r);return e.$$set=e=>{"ga"in e&&n(0,r=e.ga),"sz"in e&&n(1,u=e.sz)},[r,u,a,o,function(e){n(2,a=e)}]}class Num$1 extends SvelteComponent{constructor(e){super(),init(this,e,instance$q,create_fragment$q,safe_not_equal,{ga:0,sz:1,setModel:4})}get setModel(){return this.$$.ctx[4]}}function create_fragment$p(e){let t,n,r,u,a=(e[2]>0?e[4]:e[3].factor)+"";return{c(){t=element("button"),n=text(a),attr(t,"class",e[5]),set_style(t,"grid-area",e[0]),set_style(t,"font-size",e[1])},m(a,o){insert(a,t,o),append(t,n),r||(u=[listen(t,"click",e[6]),action_destroyer(pulse.call(null,t))],r=!0)},p(e,[r]){28&r&&a!==(a=(e[2]>0?e[4]:e[3].factor)+"")&&set_data(n,a),32&r&&attr(t,"class",e[5]),1&r&&set_style(t,"grid-area",e[0]),2&r&&set_style(t,"font-size",e[1])},i:noop,o:noop,d(e){e&&detach(t),r=!1,run_all(u)}}}function instance$p(e,t,n){let r,u,{ga:a}=t,{sz:o="30px"}=t,i={factor:2,mxPow:3,value:1,wrong:!1},s=!1,c=0;function l(){n(4,u=i.value),n(9,s=i.wrong)}return on$3("--cmd-update-views",(()=>l())),e.$$set=e=>{"ga"in e&&n(0,a=e.ga),"sz"in e&&n(1,o=e.sz)},e.$$.update=()=>{516&e.$$.dirty&&n(5,r=s?"bg-red-100":c>0?"bg-green-100":"bg-gray-100")},[a,o,c,i,u,r,function(){n(2,c++,c)==i.mxPow&&n(2,c=0),n(3,i.value=i.factor**c,i),fire$3("--evt-acted"),l()},l,function(e){n(3,i=e)},s]}class Factor extends SvelteComponent{constructor(e){super(),init(this,e,instance$p,create_fragment$p,safe_not_equal,{ga:0,sz:1,update:7,setModel:8})}get update(){return this.$$.ctx[7]}get setModel(){return this.$$.ctx[8]}}function create_fragment$o(e){let t,n,r,u;return{c(){t=element("button"),n=text(e[2]),attr(t,"class",e[3]),set_style(t,"grid-area",e[0]),set_style(t,"font-size",e[1])},m(e,a){insert(e,t,a),append(t,n),r||(u=action_destroyer(pulse.call(null,t)),r=!0)},p(e,[r]){4&r&&set_data(n,e[2]),1&r&&set_style(t,"grid-area",e[0]),2&r&&set_style(t,"font-size",e[1])},i:noop,o:noop,d(e){e&&detach(t),r=!1,u()}}}function instance$o(e,t,n){let r=1,{ga:u}=t,{sz:a="20px"}=t,o=getBgColor(u);return e.$$set=e=>{"ga"in e&&n(0,u=e.ga),"sz"in e&&n(1,a=e.sz)},[u,a,r,o,function(e){n(2,r=e)}]}class Count$1 extends SvelteComponent{constructor(e){super(),init(this,e,instance$o,create_fragment$o,safe_not_equal,{ga:0,sz:1,setModel:4})}get setModel(){return this.$$.ctx[4]}}function get_each_context$7(e,t,n){const r=e.slice();return r[15]=t[n],r[16]=t,r[17]=n,r}function create_default_slot_3(e){let t,n,r,u;return t=new Count$1({props:{ga:"cnt"}}),e[6](t),r=new Clock({props:{ga:"clk"}}),{c(){create_component(t.$$.fragment),n=space(),create_component(r.$$.fragment)},m(e,a){mount_component(t,e,a),insert(e,n,a),mount_component(r,e,a),u=!0},p(e,n){t.$set({})},i(e){u||(transition_in(t.$$.fragment,e),transition_in(r.$$.fragment,e),u=!0)},o(e){transition_out(t.$$.fragment,e),transition_out(r.$$.fragment,e),u=!1},d(u){e[6](null),destroy_component(t,u),u&&detach(n),destroy_component(r,u)}}}function create_default_slot_2(e){let t,n,r,u;t=new Num$1({props:{ga:"lhs"}}),e[7](t);return r=new Num$1({props:{ga:"rhs"}}),e[8](r),{c(){create_component(t.$$.fragment),n=space(),create_component(r.$$.fragment)},m(e,a){mount_component(t,e,a),insert(e,n,a),mount_component(r,e,a),u=!0},p(e,n){t.$set({});r.$set({})},i(e){u||(transition_in(t.$$.fragment,e),transition_in(r.$$.fragment,e),u=!0)},o(e){transition_out(t.$$.fragment,e),transition_out(r.$$.fragment,e),u=!1},d(u){e[7](null),destroy_component(t,u),u&&detach(n),e[8](null),destroy_component(r,u)}}}function create_each_block$7(e){let t,n,r=e[15];const u=()=>e[9](t,r),a=()=>e[9](null,r);let o={ga:e[15]+","};return t=new Factor({props:o}),u(),{c(){create_component(t.$$.fragment)},m(e,r){mount_component(t,e,r),n=!0},p(e,n){r!==e[15]&&(a(),r=e[15],u());t.$set({})},i(e){n||(transition_in(t.$$.fragment,e),n=!0)},o(e){transition_out(t.$$.fragment,e),n=!1},d(e){a(),destroy_component(t,e)}}}function create_default_slot_1(e){let t,n,r=range(0,8),u=[];for(let t=0;t<r.length;t+=1)u[t]=create_each_block$7(get_each_context$7(e,r,t));const a=e=>transition_out(u[e],1,1,(()=>{u[e]=null}));return{c(){for(let e=0;e<u.length;e+=1)u[e].c();t=empty()},m(e,r){for(let t=0;t<u.length;t+=1)u[t].m(e,r);insert(e,t,r),n=!0},p(e,n){if(2&n){let o;for(r=range(0,8),o=0;o<r.length;o+=1){const a=get_each_context$7(e,r,o);u[o]?(u[o].p(a,n),transition_in(u[o],1)):(u[o]=create_each_block$7(a),u[o].c(),transition_in(u[o],1),u[o].m(t.parentNode,t))}for(group_outros(),o=r.length;o<u.length;o+=1)a(o);check_outros()}},i(e){if(!n){for(let e=0;e<r.length;e+=1)transition_in(u[e]);n=!0}},o(e){u=u.filter(Boolean);for(let e=0;e<u.length;e+=1)transition_out(u[e]);n=!1},d(e){destroy_each(u,e),e&&detach(t)}}}function create_default_slot$7(e){let t,n,r,u,a,o,i,s,c,l;t=new Grid({props:{layout:e[3],ga:"l1",$$slots:{default:[create_default_slot_3]},$$scope:{ctx:e}}}),r=new Grid({props:{layout:e[4],ga:"l2",$$slots:{default:[create_default_slot_2]},$$scope:{ctx:e}}}),a=new Grid({props:{layout:e[5],ga:"l3",$$slots:{default:[create_default_slot_1]},$$scope:{ctx:e}}}),i=new Go({props:{ga:"go"}});return c=new Congrats({props:{}}),e[10](c),{c(){create_component(t.$$.fragment),n=space(),create_component(r.$$.fragment),u=space(),create_component(a.$$.fragment),o=space(),create_component(i.$$.fragment),s=space(),create_component(c.$$.fragment)},m(e,f){mount_component(t,e,f),insert(e,n,f),mount_component(r,e,f),insert(e,u,f),mount_component(a,e,f),insert(e,o,f),mount_component(i,e,f),insert(e,s,f),mount_component(c,e,f),l=!0},p(e,n){const u={};262146&n&&(u.$$scope={dirty:n,ctx:e}),t.$set(u);const o={};262146&n&&(o.$$scope={dirty:n,ctx:e}),r.$set(o);const i={};262146&n&&(i.$$scope={dirty:n,ctx:e}),a.$set(i);c.$set({})},i(e){l||(transition_in(t.$$.fragment,e),transition_in(r.$$.fragment,e),transition_in(a.$$.fragment,e),transition_in(i.$$.fragment,e),transition_in(c.$$.fragment,e),l=!0)},o(e){transition_out(t.$$.fragment,e),transition_out(r.$$.fragment,e),transition_out(a.$$.fragment,e),transition_out(i.$$.fragment,e),transition_out(c.$$.fragment,e),l=!1},d(l){destroy_component(t,l),l&&detach(n),destroy_component(r,l),l&&detach(u),destroy_component(a,l),l&&detach(o),destroy_component(i,l),l&&detach(s),e[10](null),destroy_component(c,l)}}}function create_fragment$n(e){let t,n;return t=new Grid({props:{layout:e[2],$$slots:{default:[create_default_slot$7]},$$scope:{ctx:e}}}),{c(){create_component(t.$$.fragment)},m(e,r){mount_component(t,e,r),n=!0},p(e,[n]){const r={};262147&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(transition_in(t.$$.fragment,e),n=!0)},o(e){transition_out(t.$$.fragment,e),n=!1},d(e){destroy_component(t,e)}}}function instance$n(e,t,n){let r;on$3("--cmd-new-round",(()=>GcdLcm.newRound())),on$3("--evt-done",(()=>(r.play(),void GcdLcm.done()))),on$3("--cmd-idle",(()=>GcdLcm.idle())),fire$3("--cmd-new-round");let u={areas:'\n            "l1"\n            "l2"\n            "l3"\n            "l4"\n            "go"\n        ',cols:"1fr",rows:"60px 80px 150px 150px 80px"},a={areas:'\n            "cnt . clk"\n        ',cols:"2fr 1fr 2fr",rows:"1fr"},o={areas:'\n            ". lhs rhs ."\n        ',cols:"1fr 1fr 1fr 1fr",rows:"1fr"},i={areas:'\n            "0 1 2 3"\n            "4 5 6 7"\n        ',cols:"1fr 1fr 1fr 1fr",rows:"1fr 1fr"},s={count:null,nums:new Array(2),factors:new Array(8),gcd:new Array(4),lcm:new Array(4)};return on$3("--evt-go",(()=>{randFrom(GcdLcm.game.divisors).wrong=!0,fire$3("--cmd-update-views")})),on$3("--cmd-set-models",(e=>{s.count.setModel(e.roundsLeft),s.nums[0].setModel(e.nums[0]),s.nums[1].setModel(e.nums[1]),e.divisors.forEach(((e,t)=>s.factors[t].setModel(e)))})),[r,s,u,a,o,i,function(e){binding_callbacks[e?"unshift":"push"]((()=>{s.count=e,n(1,s)}))},function(e){binding_callbacks[e?"unshift":"push"]((()=>{s.nums[0]=e,n(1,s)}))},function(e){binding_callbacks[e?"unshift":"push"]((()=>{s.nums[1]=e,n(1,s)}))},function(e,t){binding_callbacks[e?"unshift":"push"]((()=>{s.factors[t]=e,n(1,s)}))},function(e){binding_callbacks[e?"unshift":"push"]((()=>{r=e,n(0,r)}))}]}class Main$3 extends SvelteComponent{constructor(e){super(),init(this,e,instance$n,create_fragment$n,safe_not_equal,{})}}function on$2(e,t){onAny(e,t)}function fire$2(e,t){fireAny(e,t)}function newTimedCmd$2(e,t,n){return new CTimedCmd(e,t,n??0)}function create_fragment$m(e){let t,n,r,u;return{c(){t=element("button"),n=text(e[1]),attr(t,"class",e[3]),set_style(t,"grid-area",e[0]),set_style(t,"font-size",e[2])},m(e,a){insert(e,t,a),append(t,n),r||(u=[action_destroyer(pulse.call(null,t)),action_destroyer(bounceOnDrag.call(null,t))],r=!0)},p(e,[r]){2&r&&set_data(n,e[1]),1&r&&set_style(t,"grid-area",e[0]),4&r&&set_style(t,"font-size",e[2])},i:noop,o:noop,d(e){e&&detach(t),r=!1,run_all(u)}}}function instance$m(e,t,n){let{ga:r}=t,{count:u}=t,{sz:a="20px"}=t,o=getBgColor(r);return e.$$set=e=>{"ga"in e&&n(0,r=e.ga),"count"in e&&n(1,u=e.count),"sz"in e&&n(2,a=e.sz)},[r,u,a,o]}class Count extends SvelteComponent{constructor(e){super(),init(this,e,instance$m,create_fragment$m,safe_not_equal,{ga:0,count:1,sz:2})}}function applyAsciiMath(e=-1){setTimeout((()=>{safe((()=>MathJax.typeset()))}),-1===e?2e3:e)}function toAscii(e){return e.includes("`")?e:`\`${e}\``}function n2d$2(e){return new Decimal(e)}function fractionToMath(e){let t=e.isNeg()?"-":"",n=e.trunc(),r=e.minus(n).abs();if(r.eq(0)){let t=e.toNumber().toLocaleString("en");return[!1,t,t.length]}let u=n2d$2(1);for(;!r.toFraction()[1].eq(1);)r=r.mul(10),u=u.mul(10);let a=n.eq(0)?`${t}${r}/${u}`:`${n} ${r}/${u}`;return[!0,a,a.length]}function create_fragment$l(e){let t,n,r,u;return{c(){t=element("button"),n=text(e[2]),attr(t,"class",e[3]),set_style(t,"grid-area",e[0]),set_style(t,"font-size",e[1]+"px")},m(e,a){insert(e,t,a),append(t,n),r||(u=[action_destroyer(pulse.call(null,t)),action_destroyer(bounceOnDrag.call(null,t))],r=!0)},p(e,[r]){4&r&&set_data(n,e[2]),1&r&&set_style(t,"grid-area",e[0]),2&r&&set_style(t,"font-size",e[1]+"px")},i:noop,o:noop,d(e){e&&detach(t),r=!1,run_all(u)}}}function instance$l(e,t,n){let r,u,a,{ga:o}=t,{num:i}=t,{asAsciiMath:s}=t,{sz:c=30}=t;let l=getBgColor(o);return e.$$set=e=>{"ga"in e&&n(0,o=e.ga),"num"in e&&n(4,i=e.num),"asAsciiMath"in e&&n(5,s=e.asAsciiMath),"sz"in e&&n(6,c=e.sz)},e.$$.update=()=>{16&e.$$.dirty&&n(2,[r,u]=function(e){let t=e.toNumber().toLocaleString("en"),[n,r,u]=fractionToMath(e);return n&&s?(n&&(u+=2),[toAscii(r),u]):[t,t.length]}(i),r,(n(7,u),n(4,i))),192&e.$$.dirty&&n(1,a=c-1.2*u)},[o,a,r,l,i,s,c,u]}class Num extends SvelteComponent{constructor(e){super(),init(this,e,instance$l,create_fragment$l,safe_not_equal,{ga:0,num:4,asAsciiMath:5,sz:6})}}function create_fragment$k(e){let t,n,r,u;return{c(){t=element("button"),n=text(e[1]),attr(t,"class",e[2]),set_style(t,"grid-area",e[0]),set_style(t,"font-size",e[3]+"px")},m(a,o){insert(a,t,o),append(t,n),r||(u=[listen(t,"click",e[10]),action_destroyer(pulse.call(null,t)),action_destroyer(bounceOnDrag.call(null,t))],r=!0)},p(e,[r]){2&r&&set_data(n,e[1]),4&r&&attr(t,"class",e[2]),1&r&&set_style(t,"grid-area",e[0]),8&r&&set_style(t,"font-size",e[3]+"px")},i:noop,o:noop,d(e){e&&detach(t),r=!1,run_all(u)}}}function instance$k(e,t,n){let r,u,a,o,{ga:i}=t,{num:s}=t,{asAsciiMath:c}=t,{sz:l=30}=t;let f="bg-gray-100";return e.$$set=e=>{"ga"in e&&n(0,i=e.ga),"num"in e&&n(4,s=e.num),"asAsciiMath"in e&&n(5,c=e.asAsciiMath),"sz"in e&&n(6,l=e.sz)},e.$$.update=()=>{16&e.$$.dirty&&n(1,[r,u]=function(e){let t=e.toNumber().toLocaleString("en"),[n,r,u]=fractionToMath(e);return n&&c?[toAscii(r),u]:[t,t.length]}(s),r,(n(9,u),n(4,s))),512&e.$$.dirty&&n(8,a=u<5?1.2:1.5),322&e.$$.dirty&&n(3,o=l-a*r.length)},[i,r,f,o,s,c,l,function(e){n(2,f=e)},a,u,function(t){bubble.call(this,e,t)}]}class Ans$2 extends SvelteComponent{constructor(e){super(),init(this,e,instance$k,create_fragment$k,safe_not_equal,{ga:0,num:4,asAsciiMath:5,sz:6,setBgColor:7})}get setBgColor(){return this.$$.ctx[7]}}function create_fragment$j(e){let t,n,r,u;return{c(){t=element("button"),n=text(e[1]),attr(t,"class",e[3]),set_style(t,"grid-area",e[0]),set_style(t,"font-size",e[2])},m(a,o){insert(a,t,o),append(t,n),r||(u=[listen(t,"click",e[4]),action_destroyer(pulse.call(null,t)),action_destroyer(bounceOnDrag.call(null,t))],r=!0)},p(e,[r]){2&r&&set_data(n,e[1]),1&r&&set_style(t,"grid-area",e[0]),4&r&&set_style(t,"font-size",e[2])},i:noop,o:noop,d(e){e&&detach(t),r=!1,run_all(u)}}}function instance$j(e,t,n){let{ga:r}=t,{op:u}=t,{sz:a="30px"}=t,o=getBgColor(r);return e.$$set=e=>{"ga"in e&&n(0,r=e.ga),"op"in e&&n(1,u=e.op),"sz"in e&&n(2,a=e.sz)},[r,u,a,o,()=>Mp3.playRandom()]}class Op extends SvelteComponent{constructor(e){super(),init(this,e,instance$j,create_fragment$j,safe_not_equal,{ga:0,op:1,sz:2})}}
/**
   * @license Fraction.js v4.2.0 05/03/2022
   * https://www.xarg.org/2014/03/rational-numbers-in-javascript/
   *
   * Copyright (c) 2021, Robert Eisele (robert@xarg.org)
   * Dual licensed under the MIT or GPL Version 2 licenses.
   **/var fraction=createCommonjsModule((function(e,t){!function(t){var n={s:1,n:0,d:1};function r(e,t){if(isNaN(e=parseInt(e,10)))throw s.InvalidParameter;return e*t}function u(e,t){if(0===t)throw s.DivisionByZero;var n=Object.create(s.prototype);n.s=e<0?-1:1;var r=i(e=e<0?-e:e,t);return n.n=e/r,n.d=t/r,n}function a(e){for(var t={},n=e,r=2,u=4;u<=n;){for(;n%r==0;)n/=r,t[r]=(t[r]||0)+1;u+=1+2*r++}return n!==e?n>1&&(t[n]=(t[n]||0)+1):t[e]=(t[e]||0)+1,t}var o=function(e,t){var u,a=0,o=1,i=1,c=0,l=0,f=0,d=1,p=1,m=0,g=1,h=1,_=1,D=1e7;if(null==e);else if(void 0!==t){if(i=(a=e)*(o=t),a%1!=0||o%1!=0)throw s.NonIntegerParameter}else switch(typeof e){case"object":if("d"in e&&"n"in e)a=e.n,o=e.d,"s"in e&&(a*=e.s);else{if(!(0 in e))throw s.InvalidParameter;a=e[0],1 in e&&(o=e[1])}i=a*o;break;case"number":if(e<0&&(i=e,e=-e),e%1==0)a=e;else if(e>0){for(e>=1&&(e/=p=Math.pow(10,Math.floor(1+Math.log(e)/Math.LN10)));g<=D&&_<=D;){if(e===(u=(m+h)/(g+_))){g+_<=D?(a=m+h,o=g+_):_>g?(a=h,o=_):(a=m,o=g);break}e>u?(m+=h,g+=_):(h+=m,_+=g),g>D?(a=h,o=_):(a=m,o=g)}a*=p}else(isNaN(e)||isNaN(t))&&(o=a=NaN);break;case"string":if(null===(g=e.match(/\d+|./g)))throw s.InvalidParameter;if("-"===g[m]?(i=-1,m++):"+"===g[m]&&m++,g.length===m+1?l=r(g[m++],i):"."===g[m+1]||"."===g[m]?("."!==g[m]&&(c=r(g[m++],i)),(++m+1===g.length||"("===g[m+1]&&")"===g[m+3]||"'"===g[m+1]&&"'"===g[m+3])&&(l=r(g[m],i),d=Math.pow(10,g[m].length),m++),("("===g[m]&&")"===g[m+2]||"'"===g[m]&&"'"===g[m+2])&&(f=r(g[m+1],i),p=Math.pow(10,g[m+1].length)-1,m+=3)):"/"===g[m+1]||":"===g[m+1]?(l=r(g[m],i),d=r(g[m+2],1),m+=3):"/"===g[m+3]&&" "===g[m+1]&&(c=r(g[m],i),l=r(g[m+2],i),d=r(g[m+4],1),m+=5),g.length<=m){i=a=f+(o=d*p)*c+p*l;break}default:throw s.InvalidParameter}if(0===o)throw s.DivisionByZero;n.s=i<0?-1:1,n.n=Math.abs(a),n.d=Math.abs(o)};function i(e,t){if(!e)return t;if(!t)return e;for(;;){if(!(e%=t))return t;if(!(t%=e))return e}}function s(e,t){if(o(e,t),!(this instanceof s))return u(n.s*n.n,n.d);e=i(n.d,n.n),this.s=n.s,this.n=n.n/e,this.d=n.d/e}s.DivisionByZero=new Error("Division by Zero"),s.InvalidParameter=new Error("Invalid argument"),s.NonIntegerParameter=new Error("Parameters must be integer"),s.prototype={s:1,n:0,d:1,abs:function(){return u(this.n,this.d)},neg:function(){return u(-this.s*this.n,this.d)},add:function(e,t){return o(e,t),u(this.s*this.n*n.d+n.s*this.d*n.n,this.d*n.d)},sub:function(e,t){return o(e,t),u(this.s*this.n*n.d-n.s*this.d*n.n,this.d*n.d)},mul:function(e,t){return o(e,t),u(this.s*n.s*this.n*n.n,this.d*n.d)},div:function(e,t){return o(e,t),u(this.s*n.s*this.n*n.d,this.d*n.n)},clone:function(){return u(this.s*this.n,this.d)},mod:function(e,t){if(isNaN(this.n)||isNaN(this.d))return new s(NaN);if(void 0===e)return u(this.s*this.n%this.d,1);if(o(e,t),0===n.n&&0===this.d)throw s.DivisionByZero;return u(this.s*(n.d*this.n)%(n.n*this.d),n.d*this.d)},gcd:function(e,t){return o(e,t),u(i(n.n,this.n)*i(n.d,this.d),n.d*this.d)},lcm:function(e,t){return o(e,t),0===n.n&&0===this.n?u(0,1):u(n.n*this.n,i(n.n,this.n)*i(n.d,this.d))},ceil:function(e){return e=Math.pow(10,e||0),isNaN(this.n)||isNaN(this.d)?new s(NaN):u(Math.ceil(e*this.s*this.n/this.d),e)},floor:function(e){return e=Math.pow(10,e||0),isNaN(this.n)||isNaN(this.d)?new s(NaN):u(Math.floor(e*this.s*this.n/this.d),e)},round:function(e){return e=Math.pow(10,e||0),isNaN(this.n)||isNaN(this.d)?new s(NaN):u(Math.round(e*this.s*this.n/this.d),e)},inverse:function(){return u(this.s*this.d,this.n)},pow:function(e,t){if(o(e,t),1===n.d)return n.s<0?u(Math.pow(this.s*this.d,n.n),Math.pow(this.n,n.n)):u(Math.pow(this.s*this.n,n.n),Math.pow(this.d,n.n));if(this.s<0)return null;var r=a(this.n),i=a(this.d),s=1,c=1;for(var l in r)if("1"!==l){if("0"===l){s=0;break}if(r[l]*=n.n,r[l]%n.d!=0)return null;r[l]/=n.d,s*=Math.pow(l,r[l])}for(var l in i)if("1"!==l){if(i[l]*=n.n,i[l]%n.d!=0)return null;i[l]/=n.d,c*=Math.pow(l,i[l])}return n.s<0?u(c,s):u(s,c)},equals:function(e,t){return o(e,t),this.s*this.n*n.d==n.s*n.n*this.d},compare:function(e,t){o(e,t);var r=this.s*this.n*n.d-n.s*n.n*this.d;return(0<r)-(r<0)},simplify:function(e){if(isNaN(this.n)||isNaN(this.d))return this;e=e||.001;for(var t=this.abs(),n=t.toContinued(),r=1;r<n.length;r++){for(var a=u(n[r-1],1),o=r-2;o>=0;o--)a=a.inverse().add(n[o]);if(a.sub(t).abs().valueOf()<e)return a.mul(this.s)}return this},divisible:function(e,t){return o(e,t),!(!(n.n*this.d)||this.n*n.d%(n.n*this.d))},valueOf:function(){return this.s*this.n/this.d},toFraction:function(e){var t,n="",r=this.n,u=this.d;return this.s<0&&(n+="-"),1===u?n+=r:(e&&(t=Math.floor(r/u))>0&&(n+=t,n+=" ",r%=u),n+=r,n+="/",n+=u),n},toLatex:function(e){var t,n="",r=this.n,u=this.d;return this.s<0&&(n+="-"),1===u?n+=r:(e&&(t=Math.floor(r/u))>0&&(n+=t,r%=u),n+="\\frac{",n+=r,n+="}{",n+=u,n+="}"),n},toContinued:function(){var e,t=this.n,n=this.d,r=[];if(isNaN(t)||isNaN(n))return r;do{r.push(Math.floor(t/n)),e=t%n,t=n,n=e}while(1!==t);return r},toString:function(e){var t=this.n,n=this.d;if(isNaN(t)||isNaN(n))return"NaN";e=e||15;var r=function(e,t){for(;t%2==0;t/=2);for(;t%5==0;t/=5);if(1===t)return 0;for(var n=10%t,r=1;1!==n;r++)if(n=10*n%t,r>2e3)return 0;return r}(0,n),u=function(e,t,n){for(var r=1,u=function(e,t,n){for(var r=1;t>0;e=e*e%n,t>>=1)1&t&&(r=r*e%n);return r}(10,n,t),a=0;a<300;a++){if(r===u)return a;r=10*r%t,u=10*u%t}return 0}(0,n,r),a=this.s<0?"-":"";if(a+=t/n|0,t%=n,(t*=10)&&(a+="."),r){for(var o=u;o--;)a+=t/n|0,t%=n,t*=10;a+="(";for(o=r;o--;)a+=t/n|0,t%=n,t*=10;a+=")"}else for(o=e;t&&o--;)a+=t/n|0,t%=n,t*=10;return a}},Object.defineProperty(s,"__esModule",{value:!0}),s.default=s,s.Fraction=s,e.exports=s}()})),Fraction=getDefaultExportFromCjs(fraction);function isNumeric(e){return/^-?\d+$/.test(e)}function isArrayIndex(e){let t=Number(e);return!isNaN(t)&&(!(t<0)&&t===Math.trunc(t))}const isFraction=e=>e.isFinite()&&!e.toFraction()[1].eq(1);function n2d$1(e){return"number"==typeof e?new Decimal(e):Array.isArray(e)?e.map((e=>"number"==typeof e?new Decimal(e):e)):e}function d2n(e){return"number"==typeof e?e:Array.isArray(e)?e.map((e=>"number"==typeof e?e:e.toNumber())):e.toNumber()}function notFinite2t(e){return e.isNaN()?"NaN":e.isFinite()?d2t(e):e.lt(0)?"-oo":"oo"}function d2t(e,t=!0){if(!e.isFinite())return notFinite2t(e);return e.toFraction()[1].eq(1)?e.toNumber().toLocaleString("en"):new Fraction(e.toNumber()).toFraction(t)}function d2t5(e,t,n=2){let r=Math.pow(10,n),u=e.toFraction(r);return`${u[0].mul(t).toNumber()}/${u[1].mul(t).toNumber()}`}const nd2f=(e,t)=>new Fraction(e.toNumber(),t.toNumber()),d2f=e=>new Fraction(e.toNumber());function f2d(e){return 0===e.d?n2d$1(1/0):n2d$1(e.n).div(e.d).mul(e.s)}const _t2d=e=>{let t,n=e.trim().replace(/ {2,}/g," ").replace(/\+ /g,"+").replace(/\- /g,"-");try{t=new Fraction(n)}catch(t){return log.error(`Failed while making fraction from '${e}'`,t,(e=>_l(e))),t.message.includes("by Zero")?n2d$1(1/0):n2d$1(NaN)}return f2d(t)};function t2d(e){return assert(void 0!==e,(e=>_l(e))),"string"==typeof e?_t2d(e):e.map((e=>_t2d(e)))}function get_each_context$6(e,t,n){const r=e.slice();return r[37]=t[n],r[38]=t,r[39]=n,r}function create_key_block_1(e){let t,n;return t=new Num({props:{ga:"lhs",num:e[1].nums[0],asAsciiMath:e[2]&&trueFalse()}}),{c(){create_component(t.$$.fragment)},m(e,r){mount_component(t,e,r),n=!0},p(e,n){const r={};2&n[0]&&(r.num=e[1].nums[0]),4&n[0]&&(r.asAsciiMath=e[2]&&trueFalse()),t.$set(r)},i(e){n||(transition_in(t.$$.fragment,e),n=!0)},o(e){transition_out(t.$$.fragment,e),n=!1},d(e){destroy_component(t,e)}}}function create_key_block$4(e){let t,n;return t=new Num({props:{ga:"rhs",num:e[1].nums[1],asAsciiMath:e[2]&&trueFalse()}}),{c(){create_component(t.$$.fragment)},m(e,r){mount_component(t,e,r),n=!0},p(e,n){const r={};2&n[0]&&(r.num=e[1].nums[1]),4&n[0]&&(r.asAsciiMath=e[2]&&trueFalse()),t.$set(r)},i(e){n||(transition_in(t.$$.fragment,e),n=!0)},o(e){transition_out(t.$$.fragment,e),n=!1},d(e){destroy_component(t,e)}}}function create_each_block$6(e,t){let n,r,u,a=t[39];const o=()=>t[9](r,a),i=()=>t[9](null,a);let s={ga:`a${t[39]}`,num:t[37],asAsciiMath:t[2]&&t[1].asAsciiMath[t[39]]};return r=new Ans$2({props:s}),o(),r.$on("click",(function(){return t[10](t[39])})),{key:e,first:null,c(){n=empty(),create_component(r.$$.fragment),this.first=n},m(e,t){insert(e,n,t),mount_component(r,e,t),u=!0},p(e,n){a!==(t=e)[39]&&(i(),a=t[39],o());const u={};2&n[0]&&(u.ga=`a${t[39]}`),2&n[0]&&(u.num=t[37]),6&n[0]&&(u.asAsciiMath=t[2]&&t[1].asAsciiMath[t[39]]),r.$set(u)},i(e){u||(transition_in(r.$$.fragment,e),u=!0)},o(e){transition_out(r.$$.fragment,e),u=!1},d(e){e&&detach(n),i(),destroy_component(r,e)}}}function create_default_slot$6(e){let t,n,r,u,a,o,i,s,c,l,f,d=e[4][0],p=e[4][0],m=[],g=new Map;t=new Count({props:{ga:"cnt",count:e[5]}}),r=new Clock({props:{ga:"clk"}});let h=create_key_block_1(e);o=new Op({props:{ga:"op",op:e[1].op}});let _=create_key_block$4(e),D=e[1].answers;const $=e=>e[4][e[39]];for(let t=0;t<D.length;t+=1){let n=get_each_context$6(e,D,t),r=$(n);g.set(r,m[t]=create_each_block$6(r,n))}return l=new Congrats({props:{}}),e[11](l),{c(){create_component(t.$$.fragment),n=space(),create_component(r.$$.fragment),u=space(),h.c(),a=space(),create_component(o.$$.fragment),i=space(),_.c(),s=space();for(let e=0;e<m.length;e+=1)m[e].c();c=space(),create_component(l.$$.fragment)},m(e,d){mount_component(t,e,d),insert(e,n,d),mount_component(r,e,d),insert(e,u,d),h.m(e,d),insert(e,a,d),mount_component(o,e,d),insert(e,i,d),_.m(e,d),insert(e,s,d);for(let t=0;t<m.length;t+=1)m[t].m(e,d);insert(e,c,d),mount_component(l,e,d),f=!0},p(e,n){const r={};32&n[0]&&(r.count=e[5]),t.$set(r),16&n[0]&&safe_not_equal(d,d=e[4][0])?(group_outros(),transition_out(h,1,1,noop),check_outros(),h=create_key_block_1(e),h.c(),transition_in(h,1),h.m(a.parentNode,a)):h.p(e,n);const u={};2&n[0]&&(u.op=e[1].op),o.$set(u),16&n[0]&&safe_not_equal(p,p=e[4][0])?(group_outros(),transition_out(_,1,1,noop),check_outros(),_=create_key_block$4(e),_.c(),transition_in(_,1),_.m(s.parentNode,s)):_.p(e,n),94&n[0]&&(D=e[1].answers,group_outros(),m=update_keyed_each(m,n,$,1,e,D,g,c.parentNode,outro_and_destroy_block,create_each_block$6,c,get_each_context$6),check_outros());l.$set({})},i(e){if(!f){transition_in(t.$$.fragment,e),transition_in(r.$$.fragment,e),transition_in(h),transition_in(o.$$.fragment,e),transition_in(_);for(let e=0;e<D.length;e+=1)transition_in(m[e]);transition_in(l.$$.fragment,e),f=!0}},o(e){transition_out(t.$$.fragment,e),transition_out(r.$$.fragment,e),transition_out(h),transition_out(o.$$.fragment,e),transition_out(_);for(let e=0;e<m.length;e+=1)transition_out(m[e]);transition_out(l.$$.fragment,e),f=!1},d(f){destroy_component(t,f),f&&detach(n),destroy_component(r,f),f&&detach(u),h.d(f),f&&detach(a),destroy_component(o,f),f&&detach(i),_.d(f),f&&detach(s);for(let e=0;e<m.length;e+=1)m[e].d(f);f&&detach(c),e[11](null),destroy_component(l,f)}}}function create_fragment$i(e){let t,n;return t=new Grid({props:{layout:e[7],$$slots:{default:[create_default_slot$6]},$$scope:{ctx:e}}}),t.$on("click",e[12]),{c(){create_component(t.$$.fragment)},m(e,r){mount_component(t,e,r),n=!0},p(e,n){const r={};63&n[0]|512&n[1]&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(transition_in(t.$$.fragment,e),n=!0)},o(e){transition_out(t.$$.fragment,e),n=!1},d(e){destroy_component(t,e)}}}function instance$i(e,t,n){let r,u,a,o=0,i=[],s=!1,c=Anki.getConfig(),l=newTimedCmd$2("--cmd-next-round",1e3),f=newTimedCmd$2("--cmd-idle",7e3,3e3),d=[1,9],p=[2,9],m=[],g=[],h=null,_=[null,null,null],D=_.map((e=>new Object)),$=e=>new Decimal(e);function y(){return[$(m.length>0?randFrom(m):rand(d[0],d[1])),$(g.length>0?randFrom(g):rand(p[0],p[1]))]}function v(){let e=Anki.tokens().map((e=>parseInt(e)));if(e[0]<0||e[1]<0)return function(e){let[t,n]=shuffle(e),r=t<0?Decimal.pow(10,rand(t,-1)):Decimal.pow(10,rand(1,t)),u=n<0?Decimal.pow(10,rand(n,-1)):Decimal.pow(10,rand(1,n)),[a,o]=y(),i=o.plus(pm(1));return a=a.mul(r),o=o.mul(u),i=i.mul(u),{a:a,b:o,wrong:i,fa:r,fb:u}}(e);let[t,n]=y(),r=n.plus(pm(1)),u=$(1),a=$(1);for(let o=rand(e[0],e[1]);o-- >0;)if(t.equals(1))t=t.mul(10),u=u.mul(10);else switch(trueFalse()){case!0:t=t.mul(10),u=u.mul(10);break;case!1:n=n.mul(10),a=a.mul(10),r=r.mul(10)}return{a:t,b:n,wrong:r,fa:u,fb:a}}let b=e=>e.minus(e.mod(10)),A=e=>e.plus($(10).minus(e.mod(10)));function w(){let[e,t]=y();for(;e.mod(10).eq(0)||t.mod(10).eq(0);)[e,t]=y();let n=e.mul(t),r=n.mod(10),u=b(e).mul(b(t)),a=A(e).mul(A(t)),o=n2d$1(rand(1,10)).mul(10),s=trueFalse()?u.minus(o).plus(r):a.plus(o).plus(r),c=pm(rand(1,9)),l=n.plus(c),f=s.plus(c).plus(pm(randFrom([10,20,30]))),d=[e,t],p=shuffle([n,s,l,f]),m=p.findIndex((e=>e===n)),g=p.map((e=>!1));i.push({nums:d,op:"x",answers:p,asAsciiMath:g,rightAt:m})}function F(){let[e,t]=y();for(;e.mod(10).eq(0)||t.mod(10).eq(0);)[e,t]=y();let n=e.mul(t),r=e,u=r.plus(pm(10)),a=r.plus(pm(rand(1,9)));for(;a.mul(t).mod(10).eq(n.mod(10));)a=r.plus(pm(rand(1,9)));let o=a.plus(pm(10)),s=[n,t],c=shuffle([r,u,a,o]),l=c.findIndex((e=>e===r)),f=c.map((e=>!1));i.push({nums:s,op:":",answers:c,asAsciiMath:f,rightAt:l})}function C(){if(h){if(h.length>1){switch(trueFalse()){case!0:w(),F();break;case!1:F(),w()}return}if("*x".includes(h))return w(),void w();if("/\\:".includes(h))return F(),void F()}!function(){let e,t,{a:n,b:r,wrong:u}=v(),a=n,o=r,s=a.mul(o),c=a.mul(u);switch(trueFalse()){case!0:e=s.mul(10),t=c.mul(10);break;case!1:e=s.div(10),t=c.div(10)}let l=shuffle([a,o]),f=shuffle([s,c,e,t]),d=f.map((e=>trueFalse())),p=f.findIndex((e=>e==s));i.push({nums:l,op:"x",answers:f,asAsciiMath:d,rightAt:p})}(),function(){let e,t,{a:n,b:r,wrong:u}=v(),a=n.mul(r),o=n,s=r,c=u;switch(trueFalse()){case!0:e=s.mul(10),t=c.mul(10);break;case!1:e=s.div(10),t=c.div(10)}let l=[a,o],f=shuffle([s,c,e,t]),d=f.map((e=>trueFalse())),p=f.findIndex((e=>e===s));i.push({nums:l,op:"/",answers:f,asAsciiMath:d,rightAt:p})}()}function E(e){f.reset(),void 0===a.clickedAt?(n(1,a.clickedAt=e,a),e===a.rightAt?(o==i.length-1?(Mp3.play("done"),u.play()):Mp3.play("yes"),l.reset()):(Mp3.play("no"),_[e].setBgColor("bg-red-200"),C(),n(5,r=i.length-o)),_[a.rightAt].setBgColor("bg-green-200")):fire$2("--cmd-next-round")}on$2("--cmd-next-round",(()=>async function(){l.cancel(),f.reset(),n(8,++o)===i.length&&C(),n(1,a=i[o]),_.forEach((e=>e.setBgColor("bg-gray-100"))),n(4,D=_.map((e=>new Object))),await tick(),refreshMath()}())),on$2("--evt-click",(()=>{void 0!==a.clickedAt&&fire$2("--cmd-next-round")})),on$2("--cmd-idle",(()=>(f.reset(),void Mp3.play("idle")))),function(){f.reset();let e=Anki.commands();for(let t of e)switch(t[0]){case"dots":break;case"with-fractions":n(2,s=!0);break;case"last-digit":h=t[1];break;case"a":d=t.slice(1).map((e=>parseInt(e)));break;case"b":p=t.slice(1).map((e=>parseInt(e)));break;case"a[]":m=t.slice(1).map((e=>parseInt(e)));break;case"b[]":g=t.slice(1).map((e=>parseInt(e)))}for(let e=c.rounds??4;e-- >0;)C();n(1,a=i[o]),refreshMath()}();let x={areas:'\n            "cnt   .    clk "\n            "lhs   op   rhs "\n            "a0    .    a1  "\n            "a2    .    a3  "\n        ',cols:"2fr 1fr 2fr",rows:"60px 80px 80px 80px",bgColors:{cnt:"bg-purple-300",lhs:"bg-green-100",op:"bg-yellow-200",rhs:"bg-green-100"}};return e.$$.update=()=>{256&e.$$.dirty[0]&&n(5,r=i.length-o)},[u,a,s,_,D,r,E,x,o,function(e,t){binding_callbacks[e?"unshift":"push"]((()=>{_[t]=e,n(3,_)}))},e=>E(e),function(e){binding_callbacks[e?"unshift":"push"]((()=>{u=e,n(0,u)}))},()=>fire$2("--evt-click")]}class Main$2 extends SvelteComponent{constructor(e){super(),init(this,e,instance$i,create_fragment$i,safe_not_equal,{},null,[-1,-1])}}function create_fragment$h(e){let t,n,r,u;return{c(){t=element("p"),n=text(e[1]),attr(t,"class",e[2]),set_style(t,"grid-area",e[0]),set_style(t,"font-size",e[4]+"px")},m(a,o){insert(a,t,o),append(t,n),e[9](t),r||(u=[listen(t,"click",e[8]),action_destroyer(bounceOnDrag.call(null,t))],r=!0)},p(e,[r]){2&r&&set_data(n,e[1]),4&r&&attr(t,"class",e[2]),1&r&&set_style(t,"grid-area",e[0]),16&r&&set_style(t,"font-size",e[4]+"px")},i:noop,o:noop,d(n){n&&detach(t),e[9](null),r=!1,run_all(u)}}}const defaultScale=1.4;function instance$h(e,t,n){let r,u,a,{ga:o}=t,{exp:i}=t,{scale:s=defaultScale}=t,{bgColor:c=getBgColor(o)}=t,{sz:l=30}=t;return e.$$set=e=>{"ga"in e&&n(0,o=e.ga),"exp"in e&&n(1,i=e.exp),"scale"in e&&n(5,s=e.scale),"bgColor"in e&&n(2,c=e.bgColor),"sz"in e&&n(6,l=e.sz)},e.$$.update=()=>{32&e.$$.dirty&&n(7,r=s??defaultScale),194&e.$$.dirty&&n(4,u=l-r*i.length),2&e.$$.dirty&&async function(e){await tick(),n(3,a.innerText="`"+e+"`",a),refreshMath(),await delay(1e3),a.querySelectorAll("mjx-c").forEach((e=>{pulse(e),bounceOnDrag(e)}))}(i)},[o,i,c,a,u,s,l,r,function(t){bubble.call(this,e,t)},function(e){binding_callbacks[e?"unshift":"push"]((()=>{a=e,n(3,a)}))}]}class AsciiMath extends SvelteComponent{constructor(e){super(),init(this,e,instance$h,create_fragment$h,safe_not_equal,{ga:0,exp:1,scale:5,bgColor:2,sz:6})}}function create_fragment$g(e){let t,n,r,u,a,o;return{c(){t=element("div"),n=element("div"),r=element("span"),u=text(e[2]),attr(n,"class","\\ text-xs text-center text-black \\ "+e[3]+" \\"),set_style(n,"width",e[1]+"%"),attr(t,"class","w-full bg-red-50 text-right"),set_style(t,"grid-area",e[0])},m(e,i){insert(e,t,i),append(t,n),append(n,r),append(r,u),a||(o=[action_destroyer(pulse.call(null,r)),action_destroyer(pulse.call(null,t)),action_destroyer(bounceOnDrag.call(null,t))],a=!0)},p(e,[r]){4&r&&set_data(u,e[2]),2&r&&set_style(n,"width",e[1]+"%"),1&r&&set_style(t,"grid-area",e[0])},i:noop,o:noop,d(e){e&&detach(t),a=!1,run_all(o)}}}function instance$g(e,t,n){let r,u,a,o,{ga:i}=t,{values:s}=t,c=getBgColor(i);return e.$$set=e=>{"ga"in e&&n(0,i=e.ga),"values"in e&&n(4,s=e.values)},e.$$.update=()=>{16&e.$$.dirty&&n(6,r=s[0]),16&e.$$.dirty&&n(5,u=s[1]),96&e.$$.dirty&&n(2,a=u-r),96&e.$$.dirty&&n(1,o=r/u*100)},[i,o,a,c,s,u,r]}class Progress extends SvelteComponent{constructor(e){super(),init(this,e,instance$g,create_fragment$g,safe_not_equal,{ga:0,values:4})}}function create_fragment$f(e){let t,n,r;return{c(){t=element("div"),n=element("div"),attr(n,"class",r="h-full w-full "+e[1]),set_style(n,"width",e[2]+"%"),attr(t,"class","w-full h-full "+e[3]),set_style(t,"grid-area",e[0])},m(e,r){insert(e,t,r),append(t,n)},p(e,[u]){2&u&&r!==(r="h-full w-full "+e[1])&&attr(n,"class",r),4&u&&set_style(n,"width",e[2]+"%"),1&u&&set_style(t,"grid-area",e[0])},i:noop,o:noop,d(e){e&&detach(t)}}}function instance$f(e,t,n){let r,u,a,{ga:o}=t,{seconds:i}=t,{onExpiration:s}=t,{color:c="bg-red-500"}=t,{bit:l=30}=t,f=0,d=getBgColor(o);function p(){clearInterval(a)}function m(){r=Date.now(),u=r+1e3*i,a=setInterval((()=>function(){let e=Date.now();n(2,f=(e-r)/(1e3*i)*100),e>=u&&(s(),p())}()),l)}return onMount((()=>m())),onDestroy((()=>p())),e.$$set=e=>{"ga"in e&&n(0,o=e.ga),"seconds"in e&&n(4,i=e.seconds),"onExpiration"in e&&n(5,s=e.onExpiration),"color"in e&&n(1,c=e.color),"bit"in e&&n(6,l=e.bit)},[o,c,f,d,i,s,l,function(){m()}]}class Timer extends SvelteComponent{constructor(e){super(),init(this,e,instance$f,create_fragment$f,safe_not_equal,{ga:0,seconds:4,onExpiration:5,color:1,bit:6,restart:7})}get restart(){return this.$$.ctx[7]}}function parseDecimal(e){let t=e.split("/");if(1===t.length)return new Decimal(e);let[n,r]=[new Decimal(t[0]),new Decimal(t[1])];return n.div(r)}function get(e,t){return t.length>0?randFrom(t):n2d$1(rand(e[0],e[1]))}function percentsSimple(e,t){return e.includes("%")&&t.includes("*")}function percentsPlus(e,t){return e.includes("%")&&t.includes("+")}function percentsMinus(e,t){return e.includes("%")&&t.includes("-")}function makeProduct(e,t,n,r,u){let a=n2d$1([...n]),o=[],i=n2d$1(r??1);u??=!0;let s=20;do{let e=randFrom(a);if(!(i.mul(e).gt(t)&&s-- >0)&&(i=i.mul(e),o.push(e),u&&a.splice(a.indexOf(e),1),0===a.length))break}while(i.lt(e)||o.length<=1);return[i,o]}let _config$1=Anki.getConfig(),_patterns,_next$1,_totalRounds$1=_config$1.rounds,_gameType="equ+-",_a=[10,90],_b=[10,90],_c=[10,90],_d=[10,90],_n=[1,1],_aA=[],_bA=[],_cA=[],_dA=[],_nA=[],_x=["X"],_noOverflow=!1,_properOnly=!1,_seconds=15*_config$1.rounds,_mathScale,_noAbSwap=!1,_ansDividers=[],_dotsFactor=1;function newAbc(e){let t=e=>e-e%10;if("+-dots"===_gameType){let[e,n]=[get(_a,_aA),get(_b,_bA)],r=rand(1,9),u=_noOverflow?rand(0,9-r):rand(10-r,9),a=n2d$1(t(e)+r).div(_dotsFactor),o=n2d$1(t(n)+u).div(_dotsFactor),i=n2d$1(rand(1,10));a=a.plus(i.div(_dotsFactor).div(10)),trueFalse()&&(o=o.plus(n2d$1(10).minus(i).div(_dotsFactor).div(10)));let s=a.plus(o);return[...shuffle([a,o]),s]}if("equ+-"===_gameType){let[e,n]=[get(_a,_aA),get(_b,_bA)],r=rand(1,9),u=_noOverflow?rand(0,9-r):rand(10-r,9),a=n2d$1(t(e)+r),o=n2d$1(t(n)+u),i=a.plus(o);return[...shuffle([a,o]),i]}if("equ*/"===_gameType){let[e,t]=[get(_a,_aA),get(_b,_bA)],n=e.mul(t);return[..._noAbSwap?[e,t]:shuffle([e,t]),n]}if("ab+c=d"===_gameType){let[e,t]=[get(_a,_aA),get(_b,_bA)],n=get(_d,_dA),r=n.minus(e.mul(t));return[...shuffle([e,t]),r,n]}if("a*/(b+c)=d"===_gameType)for(let t=100;;){let n,[r,u]=[get(_a,_aA),get(_b,_bA)],a=get(_c,_cA);if(e.includes("+")?n=r.mul(u).plus(r.mul(a)):(u.lt(a)&&([u,a]=[a,u]),n=r.mul(u).minus(r.mul(a))),!(e.includes("/")&&n.eq(0)&&t-- >0))return e.includes("/")&&([r,n]=[n,r]),[r,u,a,n]}if("a/b=c/d"===_gameType)for(let e=100;;){let[t,n]=[get(_a,_aA),get(_b,_bA)],r=get(_c,_cA),u=get(_n,_nA),a=get(_n,_nA);if(t.gt(n)&&_properOnly&&([t,n]=[n,t]),!(t.eq(n)&&e-- >0))return[t.mul(u),n.mul(u),t.mul(r).mul(a),n.mul(r).mul(a)]}if(percentsSimple(_gameType,e)){let e,t,n=get(_b,_bA),r=100;do{if(e=get(_c,_cA),t=e.mul(100).div(n),0==--r)break}while(!t.trunc().eq(t));return 0===r&&console.log(d2n([t,n,e])),[t,n,e]}if(percentsPlus(_gameType,e)){let e,t,n=randFromIf(_bA,(e=>e.gte(100))),r=100;do{if(e=get(_c,_cA),t=e.mul(100).div(n),0==--r)break}while(!t.trunc().eq(t));return n=n.minus(100),0===r&&console.log(d2n([t,n,e])),[t,n,e]}if(percentsMinus(_gameType,e)){let e,t,n=randFromIf(_bA,(e=>e.lt(100))),r=100;do{if(e=get(_c,_cA),t=e.mul(100).div(n),0==--r)break}while(!t.trunc().eq(t));return 0===r&&console.log(d2n([t,n,e])),n=n2d$1(100).minus(n),[t,n,e]}if("%-a-of-c"===_gameType){let e,t,n=get(_b,_bA),r=100;do{if(e=get(_c,_cA),t=n.mul(e).div(100),0==--r)break}while(!t.trunc().eq(t));return 0===r&&console.log(d2n([t,n,e])),[t,n,e]}if("%-b-is-c"===_gameType){let e,t,n=get(_b,_bA),r=100;do{if(t=get(_a,_aA),e=t.mul(n).div(100),0==--r)break}while(!e.trunc().eq(e));return 0===r&&console.log(d2n([t,n,e])),[t,n,e]}if("fr+-"===_gameType){let[e,t]=[get(_a,_aA),get(_b,_bA)],n=e.plus(t);return[...shuffle([e,t]),n]}if("fr*/"===_gameType){let[t,n]=shuffle([get(_a,_aA),get(_b,_bA)]),r=e.includes("*")?t.mul(n):t.div(n);return[t,n,r]}if("fr+-ab"===_gameType){let[t,n]=[get(_a,_aA),get(_b,_bA)];if(t.eq(n))return e.includes("+")?[t,n,t.plus(n)]:[t.plus(n),...shuffle([n,t])];if(e.includes("+"))return[...shuffle([t,n]),t.plus(n)];{let e=Decimal.max(t,n),r=Decimal.min(t,n),u=e.minus(r);return[e,r,u]}}if("fr-reduction"===_gameType)for(let e=20;;){let[t,n]=[get(_a,_aA),get(_b,_bA)],r=get(_d,_dA);t=t.mul(r),n=n.mul(r);let u=f2d(nd2f(t,n));if(!(t.gte(n)&&_properOnly&&e-- >0))return[t,n,u]}if("dividers"===_gameType)for(;;){let[e,t]=makeProduct(_a[0],_a[1],_nA),[n,r]=makeProduct(_b[0],_b[1],_nA);if(e.eq(n))continue;_ansDividers=[...t,...r];let[u]=makeProduct(_c[0],_c[1],_ansDividers);if(!u.eq(e)&&!u.eq(n))return[e,n,u]}if("dividers-2"===_gameType){let e;for(let t=50;t-- >0;){let[t,n]=makeProduct(_a[0],_a[1],_nA),[r,u]=makeProduct(_b[0],_b[1],_nA);if(t.eq(r))continue;let a=shuffle([...n,...u]);_ansDividers=a;let[o,i,s,c,l]=[];switch(a.length){default:continue;case 3:[o,i,s]=a,e=[t,r,i,s,o];break;case 4:[o,i,s,c]=a,[i,s]=i.lt(s)?[i.mul(c),s]:[i,s.mul(c)],e=[t,r,i,s,o];break;case 5:[o,i,s,c,l]=a,[i,s]=i.lt(s)?[i,s]:[s,i],[c,l]=c.lt(l)?[c,l]:[l,c],i=i.mul(l),s=s.mul(c),e=[t,r,i,s,o]}if(allAreUnique(e))break}return e}if("dividers+-"==_gameType){let e=_a,t=new Map([[2,[2,7]],[3,[3,7]],[5,[5,7]],[6,[2,3]],[7,[7,11]],[9,[7,8]],[10,[2,5]]]),n=randFrom([...t.keys()]),r=t.get(n),u=makeProduct(e[0],e[1],r,n,!1)[0],a=rand(e[0],d2n(u.minus(e[0])));return n2d$1([a,u.minus(a),n])}throw`Unknown game type '${_gameType}'`}function makeAnswers$1(e,t){if("+-dots"===_gameType){let e=pm(n2d$1(10)).div(_dotsFactor),n=pm(n2d$1(rand(1,1))).div(_dotsFactor),r=pm(n2d$1(rand(2,2))).div(_dotsFactor);return shuffle([t,t.plus(e),t.plus(n),t.plus(r)])}if("equ+-"===_gameType)return shuffle([t,t.plus(pm(10)),t.plus(pm(rand(1,1))),t.plus(pm(rand(2,2)))]);if("equ*/"===_gameType)return shuffle([t,t.plus(pm(rand(1,1))),t.plus(pm(rand(2,2))),t.plus(pm(rand(3,3)))]);if("ab+c=d"===_gameType||"a*/(b+c)=d"===_gameType||"a/b=c/d"===_gameType)return shuffle([t,t.plus(pm(rand(1,1))),t.plus(pm(rand(2,2))),t.plus(pm(rand(3,3)))]);if(_gameType.includes("%"))return shuffle([t,t.plus(pm(5)),t.plus(pm(10)),t.plus(pm(15))]);if(_gameType.includes("fr+-")||"fr*/"===_gameType){let n=(e,t)=>e.gt(t)?e.plus(t.mul(pm(1))):e.plus(t);for(let r=100;;){let u=[t,n(t,e[0]),n(t,e[1]),n(t,e[2])];if(allAreUnique(u)||!(r-- >0))return shuffle(u)}}if("fr-reduction"===_gameType){let e=(e,t)=>e>t?e+pm(t):e+t,n=d2f(t);for(let r=100;;){let u=n.n,a=e(n.n,1),o=n.d,i=e(n.d,1),s=[t,n2d$1(a).div(o),n2d$1(u).div(i),n2d$1(a).div(i)];if(allAreUnique(s)||!(r-- >0))return shuffle(s)}}if("dividers"===_gameType){let e=_nA.filter((e=>!_ansDividers.some((t=>e.eq(t))))),n=_ansDividers.reduce(((e,t)=>e.mul(t)));[2,3].forEach((t=>{let r=n2d$1(t);for(;n.mod(r).eq(0);)r=r.mul(t);e.push(r)}));let r=()=>{for(let t=30;;){let n=randFrom(_ansDividers);if(_ansDividers.length>2&&trueFalse()&&(n=n.mul(randFrom(_ansDividers))),n=n.mul(randFrom(e)),!(n.gt(_c[1])&&t-- >0))return n}};for(let e=100;;){let n=[t,r(),r(),r()];if(allAreUnique(n)||!(e-- >0))return shuffle(n)}}if("dividers-2"===_gameType){let e,n=_ansDividers.filter((e=>!e.eq(t)));n=[...n,...n2d$1([23,29])];for(let r=30;r-- >0;){let[r,u,a]=shuffle(n);if(e=[t,r,u,a],allAreUnique(e))break}return shuffle(e)}if("dividers+-"===_gameType){let n=[t],r=e[0].plus(e[1]);for(let e=2;e<d2n(r)&&(t.eq(e)||r.mod(e).eq(0)||4===e||(n.push(n2d$1(e)),!(n.length>=4)));e++);return n=[...n,...n2d$1([11,13,17])].slice(0,4),shuffle(n)}throw`Unknown game type '${_gameType}'`}function makeEqu(e,t){let n=randFrom(e.match(/\b[A-Z]\b/g)),r=e;[[/_r/g,"color(red)"],[/_g/g,"color(green)"],[/_b/g,"color(blue)"]].forEach((e=>r=r.replace(e[0],e[1]))),r=r.replace(n,"$").replace("xx","@");let u=t[n.charCodeAt(0)-"A".charCodeAt(0)];if("ab+c=d"==_gameType){let e=t[2];e.lt(0)&&(t[2]=e.neg(),r=r.replace("+","-")),u.lt(0)&&(u=u.neg())}if("dividers+-"===_gameType&&trueFalse()){let e=t[0].plus(t[1].mul(2));t=[e,t[1],t[2],t[3]],r=r.replace("+","-")}let a="+-dots"===_gameType;function o(e){return e>=t.length?"":t[e]?a?t[e].toString():d2t(t[e]):""}return r=r.toLocaleLowerCase().replace(/\ba\b/,o(0)).replace(/\bb\b/,o(1)).replace(/\bc\b/,o(2)).replace(/\bd\b/,o(3)).replace(/\be\b/,o(4)).replace(/\bf\b/,o(5)).replace(/\bg\b/,o(6)).replace(/\bh\b/,o(7)),r=r.replace("@","xx").replace("$",randFrom(_x)),[r,u]}class CGame$1{constructor(){for(let e of Anki.commands())switch(e[0].toLocaleLowerCase()){case"equ+-":_gameType="equ+-";break;case"equ*/":_gameType="equ*/";break;case"ab+c=d":_gameType="ab+c=d";break;case"%-simple":_gameType="%-simple";break;case"%-plus":_gameType="%-plus";break;case"%-minus":_gameType="%-minus";break;case"%-all":_gameType="%-all";break;case"game":_gameType=e[1];case"no-overflow":_noOverflow=!1;break;case"proper-only":_properOnly=!0;break;case"timer":_seconds=parseInt(e[1]);break;case"m-scale":_mathScale=parseFloat(e[1]);break;case"no-ab-swap":_noAbSwap=!0;break;case"dots-factor":_dotsFactor=parseInt(e[1]);break;case"x":_x=e.slice(1);break;case"a":_a=e.slice(1).map((e=>parseInt(e)));break;case"b":_b=e.slice(1).map((e=>parseInt(e)));break;case"c":_c=e.slice(1).map((e=>parseInt(e)));break;case"d":_d=e.slice(1).map((e=>parseInt(e)));break;case"n":_n=e.slice(1).map((e=>parseInt(e)));break;case"a[]":_aA=e.slice(1).map((e=>parseDecimal(e)));break;case"b[]":_bA=e.slice(1).map((e=>parseDecimal(e)));break;case"c[]":_cA=e.slice(1).map((e=>parseDecimal(e)));break;case"d[]":_dA=e.slice(1).map((e=>parseDecimal(e)));break;case"n[]":_nA=e.slice(1).map((e=>parseDecimal(e)))}_patterns=Anki.tokens(),_next$1=-1}isLast(){return _next$1+1>=_totalRounds$1}addRounds(e){_totalRounds$1+=e}nextRound(){_next$1++;let e=_gameType,t=_patterns[_next$1%_patterns.length],n=newAbc(t),[r,u]=makeEqu(t,n),a=makeAnswers$1(n,u);return{seconds:_seconds,gameType:e,progress:[_next$1<_totalRounds$1?_next$1:_totalRounds$1,_totalRounds$1],equ:r,mathScale:_mathScale,rightAns:u,answers:a}}}function newEquation(){return new CGame$1}function on$1(e,t){onAny(e,t)}function fire$1(e,t){fireAny(e,t)}function newTimedCmd$1(e,t,n){return new CTimedCmd(e,t,n??0)}function create_fragment$e(e){let t,n,r,u;return{c(){t=element("button"),n=text(e[1]),attr(t,"class",e[3]),set_style(t,"grid-area",e[0]),set_style(t,"font-size",e[2]+"px")},m(a,o){insert(a,t,o),append(t,n),r||(u=[action_destroyer(pulse.call(null,t)),action_destroyer(bounceOnDrag.call(null,t)),listen(t,"click",e[10])],r=!0)},p(e,[r]){2&r&&set_data(n,e[1]),8&r&&attr(t,"class",e[3]),1&r&&set_style(t,"grid-area",e[0]),4&r&&set_style(t,"font-size",e[2]+"px")},i:noop,o:noop,d(e){e&&detach(t),r=!1,run_all(u)}}}function instance$e(e,t,n){let r,u,a,{gameType:o}=t,{ga:i}=t,{value:s}=t,{units:c=""}=t,{bgColor:l=getBgColor(i,"bg-gray-100")}=t,{sz:f=30}=t;function d(e){if(!isFraction(e)&&!c)return e.toNumber().toLocaleString("en");let t="+-dots"===o?e.toString():d2t(e,trueFalse());return c&&(t+=c),toAscii(t)}return e.$$set=e=>{"gameType"in e&&n(4,o=e.gameType),"ga"in e&&n(0,i=e.ga),"value"in e&&n(5,s=e.value),"units"in e&&n(6,c=e.units),"bgColor"in e&&n(7,l=e.bgColor),"sz"in e&&n(8,f=e.sz)},[i,r,u,a,o,s,c,l,f,function(e){switch(e){case"start":n(1,r="??"),n(3,a=l);break;case"clicked":n(1,r=d(s)),n(3,a=l);break;case"right":n(1,r=d(s)),n(3,a="bg-green-200");break;case"wrong":n(1,r=d(s)),n(3,a="bg-red-200")}n(2,u=f-1.2*r.length)},function(t){bubble.call(this,e,t)}]}class Ans$1 extends SvelteComponent{constructor(e){super(),init(this,e,instance$e,create_fragment$e,safe_not_equal,{gameType:4,ga:0,value:5,units:6,bgColor:7,sz:8,setState:9})}get setState(){return this.$$.ctx[9]}}function get_each_context$5(e,t,n){const r=e.slice();return r[25]=t[n],r[26]=t,r[27]=n,r}function create_each_block$5(e,t){let n,r,u,a=t[27];const o=()=>t[11](r,a),i=()=>t[11](null,a);let s={gameType:t[2].gameType,ga:`a${t[27]}`,value:t[25],units:getAnsUnits(t[2])};return r=new Ans$1({props:s}),o(),r.$on("click",(function(){return t[12](t[25])})),{key:e,first:null,c(){n=empty(),create_component(r.$$.fragment),this.first=n},m(e,t){insert(e,n,t),mount_component(r,e,t),u=!0},p(e,n){a!==(t=e)[27]&&(i(),a=t[27],o());const u={};4&n&&(u.gameType=t[2].gameType),4&n&&(u.ga=`a${t[27]}`),4&n&&(u.value=t[25]),4&n&&(u.units=getAnsUnits(t[2])),r.$set(u)},i(e){u||(transition_in(r.$$.fragment,e),u=!0)},o(e){transition_out(r.$$.fragment,e),u=!1},d(e){e&&detach(n),i(),destroy_component(r,e)}}}function create_default_slot$5(e){let t,n,r,u,a,o,i,s,c,l,f,d=[],p=new Map;t=new Progress({props:{ga:"prg",values:e[4]}}),r=new Clock({props:{ga:"clk"}}),a=new AsciiMath({props:{ga:"equ",sz:40,exp:e[2].equ,scale:getScale(e[2])}}),a.$on("click",e[10]);let m=e[2].answers;const g=e=>e[5][e[27]];for(let t=0;t<m.length;t+=1){let n=get_each_context$5(e,m,t),r=g(n);p.set(r,d[t]=create_each_block$5(r,n))}let h={ga:"tm",seconds:e[2].seconds,onExpiration:e[13]};s=new Timer({props:h}),e[14](s);return l=new Congrats({props:{}}),e[15](l),{c(){create_component(t.$$.fragment),n=space(),create_component(r.$$.fragment),u=space(),create_component(a.$$.fragment),o=space();for(let e=0;e<d.length;e+=1)d[e].c();i=space(),create_component(s.$$.fragment),c=space(),create_component(l.$$.fragment)},m(e,p){mount_component(t,e,p),insert(e,n,p),mount_component(r,e,p),insert(e,u,p),mount_component(a,e,p),insert(e,o,p);for(let t=0;t<d.length;t+=1)d[t].m(e,p);insert(e,i,p),mount_component(s,e,p),insert(e,c,p),mount_component(l,e,p),f=!0},p(e,n){const r={};16&n&&(r.values=e[4]),t.$set(r);const u={};4&n&&(u.exp=e[2].equ),4&n&&(u.scale=getScale(e[2])),a.$set(u),300&n&&(m=e[2].answers,group_outros(),d=update_keyed_each(d,n,g,1,e,m,p,i.parentNode,outro_and_destroy_block,create_each_block$5,i,get_each_context$5),check_outros());const o={};4&n&&(o.seconds=e[2].seconds),s.$set(o);l.$set({})},i(e){if(!f){transition_in(t.$$.fragment,e),transition_in(r.$$.fragment,e),transition_in(a.$$.fragment,e);for(let e=0;e<m.length;e+=1)transition_in(d[e]);transition_in(s.$$.fragment,e),transition_in(l.$$.fragment,e),f=!0}},o(e){transition_out(t.$$.fragment,e),transition_out(r.$$.fragment,e),transition_out(a.$$.fragment,e);for(let e=0;e<d.length;e+=1)transition_out(d[e]);transition_out(s.$$.fragment,e),transition_out(l.$$.fragment,e),f=!1},d(f){destroy_component(t,f),f&&detach(n),destroy_component(r,f),f&&detach(u),destroy_component(a,f),f&&detach(o);for(let e=0;e<d.length;e+=1)d[e].d(f);f&&detach(i),e[14](null),destroy_component(s,f),f&&detach(c),e[15](null),destroy_component(l,f)}}}function create_fragment$d(e){let t,n;return t=new Grid({props:{layout:e[9],$$slots:{default:[create_default_slot$5]},$$scope:{ctx:e}}}),t.$on("click",e[16]),{c(){create_component(t.$$.fragment)},m(e,r){mount_component(t,e,r),n=!0},p(e,[n]){const r={};268435487&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(transition_in(t.$$.fragment,e),n=!0)},o(e){transition_out(t.$$.fragment,e),n=!1},d(e){destroy_component(t,e)}}}function getScale(e){if(e.mathScale)return e.mathScale;switch(e.gameType){case"%-simple":case"%-plus":case"%-minus":case"%-all":return 1.2;case"dividers":return.3;case"dividers-2":return.4;case"dividers+-":return.35}}function getAnsUnits(e){return"%-a-of-c"===e.gameType?"%":""}function instance$d(e,t,n){let r,u,a,o=newEquation(),i=o.nextRound(),s=[null,null,null,null],c=[1,10],l=newTimedCmd$1("--cmd-new-round",1e3),f=newTimedCmd$1("--cmd-idle",1e4,3e3),d=s.map((e=>new Object));function p(){if(Mp3.playRandom(),"dividers-2"===i.gameType)h()}function m(){return f.reset(),"start"==a?(a="clicked",s.forEach((e=>e.setState("clicked"))),run((()=>refreshMath())),!0):"clicked"!==a&&("answered"!=a||(h(),!0))}function g(e){if(f.reset(),!m()&&"clicked"===a){a="answered";let t=i.answers.findIndex((t=>t.eq(e))),r=i.answers.findIndex((e=>e.eq(i.rightAns)));if(t===r){n(4,c[0]+=1,c);let e=o.isLast(i);Mp3.play(e?"done":"yes"),l.reset(),e&&u.play()}else s[t].setState("wrong"),Mp3.play("no"),o.addRounds(2),n(4,c[0]+=1,c),n(4,c[1]+=2,c);s[r].setState("right")}}async function h(){n(5,d=s.map((e=>new Object))),n(2,i=o.nextRound()),await tick(),_()}function _(){switch(a="start",f.reset(),l.cancel(),s.forEach((e=>{e.setState("start")})),n(4,c=i.progress),i.gameType){case"dividers":case"dividers-2":case"dividers+-":m()}}onMount((()=>_())),on$1("--cmd-new-round",(()=>h())),on$1("--cmd-idle",(()=>(Mp3.play("idle"),void f.reset()))),on$1("--evt-time-is-up",(()=>(o.addRounds(1),n(4,c[1]+=1,c),r.restart(),void Mp3.play("time-is-up"))));return[r,u,i,s,c,d,p,m,g,{areas:'\n            "prg   .    clk "\n            "equ   equ  equ "\n            "a0    .    a1  "\n            "a2    .    a3  "\n            "tm    tm   tm  "\n        ',cols:"2fr 1fr 2fr",rows:"50px 80px 80px 80px 5px",bgColors:{prg:"bg-green-300",equ:"bg-yellow-50",tm:"bg-blue-100"}},()=>p(),function(e,t){binding_callbacks[e?"unshift":"push"]((()=>{s[t]=e,n(3,s)}))},e=>g(e),()=>fire$1("--evt-time-is-up"),function(e){binding_callbacks[e?"unshift":"push"]((()=>{r=e,n(0,r)}))},function(e){binding_callbacks[e?"unshift":"push"]((()=>{u=e,n(1,u)}))},()=>m()]}class Main$1 extends SvelteComponent{constructor(e){super(),init(this,e,instance$d,create_fragment$d,safe_not_equal,{})}}function on(e,t){onAny(e,t)}function fire(e,t){fireAny(e,t)}function newTimedCmd(e,t,n){return new CTimedCmd(e,t,n??0)}let _config=Anki.getConfig(),_fractions,_next,_totalRounds=_config.rounds,n2d=e=>new Decimal(e),s2f=e=>new Fraction(e);function fxd(e,t){let n=n2d(10).pow(t);return n2d(e).mul(n).trunc().div(n)}function aTriple(e,t){let n=e.valueOf(),r=n.toFixed(5).length<n.toString().length,u=[e.toFraction(!1),fxd(n,4).toString()+(r?"...":""),e.mul(100).toString(2)+"%"];return[u[t[0]],u[t[1]],u[t[2]]]}class CGame{constructor(){for(let e of Anki.commands())e[0].toLocaleLowerCase();_fractions=Anki.tokens().map((e=>s2f(e))).sort((function(e,t){return e.compare(t)})),_next=-1}isLast(){return _next+1>=_totalRounds}addRounds(e){_totalRounds+=e}nextRound(){_next++;let e=rand(0,_fractions.length-4),t=shuffle([0,1,2]),n=shuffle([0,1,2,3].map((n=>aTriple(_fractions[e+n],t)))),r=n[0][0],u=shuffle([n[0][1],n[1][1],n[2][2],n[3][2]]);return{fr:r,rightAt:u.findIndex((e=>e===n[0][1])),answers:u,progress:[_next<_totalRounds?_next:_totalRounds,_totalRounds]}}}function newFrPairs(){return new CGame}function create_fragment$c(e){let t,n,r,u,a,o,i;return{c(){t=element("button"),n=text("`"),r=text(e[1]),u=text("`"),attr(t,"class",a=e[2]+" py-0.5 my-1"),set_style(t,"grid-area",e[0]),set_style(t,"font-size",e[3]+"px")},m(a,s){insert(a,t,s),append(t,n),append(t,r),append(t,u),o||(i=[action_destroyer(pulse.call(null,t)),action_destroyer(bounceOnDrag.call(null,t)),listen(t,"click",e[7])],o=!0)},p(e,[n]){2&n&&set_data(r,e[1]),4&n&&a!==(a=e[2]+" py-0.5 my-1")&&attr(t,"class",a),1&n&&set_style(t,"grid-area",e[0]),8&n&&set_style(t,"font-size",e[3]+"px")},i:noop,o:noop,d(e){e&&detach(t),o=!1,run_all(i)}}}function instance$c(e,t,n){let r,{ga:u}=t,{value:a}=t,{bgColor:o=getBgColor(u,"bg-gray-100")}=t,{sz:i=24}=t,s=o;return e.$$set=e=>{"ga"in e&&n(0,u=e.ga),"value"in e&&n(1,a=e.value),"bgColor"in e&&n(4,o=e.bgColor),"sz"in e&&n(5,i=e.sz)},e.$$.update=()=>{34&e.$$.dirty&&n(3,r=i-1.1*a.length)},[u,a,s,r,o,i,function(e){switch(e){case"start":n(2,s=o);break;case"right":n(2,s="bg-green-200");break;case"wrong":n(2,s="bg-red-200")}},function(t){bubble.call(this,e,t)}]}class Ans extends SvelteComponent{constructor(e){super(),init(this,e,instance$c,create_fragment$c,safe_not_equal,{ga:0,value:1,bgColor:4,sz:5,setState:6})}get setState(){return this.$$.ctx[6]}}function create_fragment$b(e){let t,n,r,u,a,o;return{c(){t=element("p"),n=text("`"),r=text(e[1]),u=text("`"),attr(t,"class",e[2]),set_style(t,"grid-area",e[0]),set_style(t,"font-size",e[3]+"px")},m(i,s){insert(i,t,s),append(t,n),append(t,r),append(t,u),a||(o=[action_destroyer(pulse.call(null,t)),action_destroyer(bounceOnDrag.call(null,t)),listen(t,"click",e[6])],a=!0)},p(e,[n]){2&n&&set_data(r,e[1]),1&n&&set_style(t,"grid-area",e[0])},i:noop,o:noop,d(e){e&&detach(t),a=!1,run_all(o)}}}function instance$b(e,t,n){let{ga:r}=t,{math:u}=t,{bgColor:a=getBgColor(r,"bg-gray-100")}=t,{sz:o=30}=t,i=a,s=o;return e.$$set=e=>{"ga"in e&&n(0,r=e.ga),"math"in e&&n(1,u=e.math),"bgColor"in e&&n(4,a=e.bgColor),"sz"in e&&n(5,o=e.sz)},[r,u,i,s,a,o,function(t){bubble.call(this,e,t)}]}class Question extends SvelteComponent{constructor(e){super(),init(this,e,instance$b,create_fragment$b,safe_not_equal,{ga:0,math:1,bgColor:4,sz:5})}}function get_each_context$4(e,t,n){const r=e.slice();return r[28]=t[n],r[29]=t,r[30]=n,r}function create_key_block$3(e){let t,n;return t=new Question({props:{ga:"que",math:e[5].fr,sz:36}}),t.$on("click",e[12]),{c(){create_component(t.$$.fragment)},m(e,r){mount_component(t,e,r),n=!0},p(e,n){const r={};32&n[0]&&(r.math=e[5].fr),t.$set(r)},i(e){n||(transition_in(t.$$.fragment,e),n=!0)},o(e){transition_out(t.$$.fragment,e),n=!1},d(e){destroy_component(t,e)}}}function create_each_block$4(e,t){let n,r,u,a=t[30];const o=()=>t[13](r,a),i=()=>t[13](null,a);let s={ga:`a${t[30]}`,value:t[28]};return r=new Ans({props:s}),o(),r.$on("click",(function(){return t[14](t[28])})),{key:e,first:null,c(){n=empty(),create_component(r.$$.fragment),this.first=n},m(e,t){insert(e,n,t),mount_component(r,e,t),u=!0},p(e,n){a!==(t=e)[30]&&(i(),a=t[30],o());const u={};32&n[0]&&(u.ga=`a${t[30]}`),32&n[0]&&(u.value=t[28]),r.$set(u)},i(e){u||(transition_in(r.$$.fragment,e),u=!0)},o(e){transition_out(r.$$.fragment,e),u=!1},d(e){e&&detach(n),i(),destroy_component(r,e)}}}function create_default_slot$4(e){let t,n,r,u,a,o,i,s,c,l,f=e[3][0],d=[],p=new Map;t=new Progress({props:{ga:"prg",values:e[6]}}),r=new Clock({props:{ga:"clk"}});let m=create_key_block$3(e),g=e[5].answers;const h=e=>e[3][e[30]];for(let t=0;t<g.length;t+=1){let n=get_each_context$4(e,g,t),r=h(n);p.set(r,d[t]=create_each_block$4(r,n))}let _={ga:"tm",seconds:e[4]*e[7].rounds,onExpiration:e[15]};i=new Timer({props:_}),e[16](i);return c=new Congrats({props:{}}),e[17](c),{c(){create_component(t.$$.fragment),n=space(),create_component(r.$$.fragment),u=space(),m.c(),a=space();for(let e=0;e<d.length;e+=1)d[e].c();o=space(),create_component(i.$$.fragment),s=space(),create_component(c.$$.fragment)},m(e,f){mount_component(t,e,f),insert(e,n,f),mount_component(r,e,f),insert(e,u,f),m.m(e,f),insert(e,a,f);for(let t=0;t<d.length;t+=1)d[t].m(e,f);insert(e,o,f),mount_component(i,e,f),insert(e,s,f),mount_component(c,e,f),l=!0},p(e,n){const r={};64&n[0]&&(r.values=e[6]),t.$set(r),8&n[0]&&safe_not_equal(f,f=e[3][0])?(group_outros(),transition_out(m,1,1,noop),check_outros(),m=create_key_block$3(e),m.c(),transition_in(m,1),m.m(a.parentNode,a)):m.p(e,n),1066&n[0]&&(g=e[5].answers,group_outros(),d=update_keyed_each(d,n,h,1,e,g,p,o.parentNode,outro_and_destroy_block,create_each_block$4,o,get_each_context$4),check_outros());const u={};16&n[0]&&(u.seconds=e[4]*e[7].rounds),i.$set(u);c.$set({})},i(e){if(!l){transition_in(t.$$.fragment,e),transition_in(r.$$.fragment,e),transition_in(m);for(let e=0;e<g.length;e+=1)transition_in(d[e]);transition_in(i.$$.fragment,e),transition_in(c.$$.fragment,e),l=!0}},o(e){transition_out(t.$$.fragment,e),transition_out(r.$$.fragment,e),transition_out(m);for(let e=0;e<d.length;e+=1)transition_out(d[e]);transition_out(i.$$.fragment,e),transition_out(c.$$.fragment,e),l=!1},d(l){destroy_component(t,l),l&&detach(n),destroy_component(r,l),l&&detach(u),m.d(l),l&&detach(a);for(let e=0;e<d.length;e+=1)d[e].d(l);l&&detach(o),e[16](null),destroy_component(i,l),l&&detach(s),e[17](null),destroy_component(c,l)}}}function create_fragment$a(e){let t,n;return t=new Grid({props:{layout:e[11],$$slots:{default:[create_default_slot$4]},$$scope:{ctx:e}}}),t.$on("click",e[18]),{c(){create_component(t.$$.fragment)},m(e,r){mount_component(t,e,r),n=!0},p(e,n){const r={};127&n[0]|1&n[1]&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(transition_in(t.$$.fragment,e),n=!0)},o(e){transition_out(t.$$.fragment,e),n=!1},d(e){destroy_component(t,e)}}}function instance$a(e,t,n){let r,u,a,o=[null,null,null,null],i=[{},{},{},{}],s=Anki.getConfig(),c=12,l=newFrPairs(),f=l.nextRound(),d=[1,10],p=newTimedCmd("--cmd-new-round",1e3),m=newTimedCmd("--cmd-idle",1e4,3e3);function g(){n(3,i=i.map((e=>new Object))),n(5,f=l.nextRound()),run((()=>h()))}function h(){a="start",p.cancel(),m.reset(),o.forEach((e=>{e.setState("start")})),n(6,d=f.progress),run((()=>refreshMath()))}function _(){Mp3.playRandom()}function D(){return m.reset(),"start"!=a&&("answered"==a?(g(),!0):void 0)}function $(e){if(m.reset(),D())return;a="answered";let t=f.answers.findIndex((t=>t===e)),r=f.rightAt;if(t===r){n(6,d[0]+=1,d);let e=l.isLast();Mp3.play(e?"done":"yes"),p.reset(),e&&u.play()}else o[t].setState("wrong"),Mp3.play("no"),l.addRounds(2),n(6,d[0]+=1,d),n(6,d[1]+=2,d);o[r].setState("right")}!function(){for(let e of Anki.commands())if("secondsPerRound"===e[0].toLocaleLowerCase())n(4,c=parseInt(e[1]))}(),on("--cmd-new-round",(()=>g())),on("--cmd-idle",(()=>(Mp3.play("idle"),void m.reset()))),on("--evt-time-is-up",(()=>(l.addRounds(1),n(6,d[1]+=1,d),r.restart(),void Mp3.play("time-is-up")))),onMount((()=>h()));return[r,o,u,i,c,f,d,s,_,D,$,{areas:'\n            "prg   .    clk "\n            "que   que  que "\n            "a0    .    a1  "\n            ".     .    .   "\n            "a2    .    a3  "\n            ".     .    .   "\n            "tm    tm   tm  "\n        ',cols:"2fr 1fr 2fr",rows:"50px 80px 70px 10px 70px 15px 5px",bgColors:{prg:"bg-green-300",que:"bg-yellow-50 py-1",tm:"bg-blue-100"}},()=>_(),function(e,t){binding_callbacks[e?"unshift":"push"]((()=>{o[t]=e,n(1,o)}))},e=>$(e),()=>fire("--evt-time-is-up"),function(e){binding_callbacks[e?"unshift":"push"]((()=>{r=e,n(0,r)}))},function(e){binding_callbacks[e?"unshift":"push"]((()=>{u=e,n(2,u)}))},()=>D()]}class Main extends SvelteComponent{constructor(e){super(),init(this,e,instance$a,create_fragment$a,safe_not_equal,{},null,[-1,-1])}}function create_else_block(e){let t,n;return{c(){t=element("bdi"),n=text(e[1]),attr(t,"dir",e[4]),set_style(t,"font-size","15px")},m(e,r){insert(e,t,r),append(t,n)},p(e,r){2&r&&set_data(n,e[1]),16&r&&attr(t,"dir",e[4])},d(e){e&&detach(t)}}}function create_if_block$2(e){let t;return{c(){t=text(e[1])},m(e,n){insert(e,t,n)},p(e,n){2&n&&set_data(t,e[1])},d(e){e&&detach(t)}}}function create_fragment$9(e){let t,n,r;function u(e,t){return e[3]?create_if_block$2:create_else_block}let a=u(e),o=a(e);return{c(){t=element("button"),o.c(),attr(t,"class",e[2]),set_style(t,"grid-area",e[0])},m(u,a){insert(u,t,a),o.m(t,null),n||(r=[action_destroyer(pulse.call(null,t)),action_destroyer(bounceOnDrag.call(null,t)),listen(t,"click",e[12])],n=!0)},p(e,[n]){a===(a=u(e))&&o?o.p(e,n):(o.d(1),o=a(e),o&&(o.c(),o.m(t,null))),4&n&&attr(t,"class",e[2]),1&n&&set_style(t,"grid-area",e[0])},i:noop,o:noop,d(e){e&&detach(t),o.d(),n=!1,run_all(r)}}}function instance$9(e,t,n){let r,u,a,o,i,s,c,{ga:l}=t,{store:f}=t,{value:d,isClicked:p,isRight:m}=f;return component_subscribe(e,d,(e=>n(1,a=e))),component_subscribe(e,p,(e=>n(11,i=e))),component_subscribe(e,m,(e=>n(10,o=e))),e.$$set=e=>{"ga"in e&&n(0,l=e.ga),"store"in e&&n(8,f=e.store)},e.$$.update=()=>{2&e.$$.dirty&&n(3,c=isNumeric(a)),3072&e.$$.dirty&&n(2,s=i?o?"bg-green-200":"bg-red-200":"bg-gray-100"),2&e.$$.dirty&&n(9,r=/[\u0590-\u05FF]/.test(a)),512&e.$$.dirty&&n(4,u=r?"rtl":null)},[l,a,s,c,u,d,p,m,f,r,o,i,function(t){bubble.call(this,e,t)}]}class WProblem_Ans extends SvelteComponent{constructor(e){super(),init(this,e,instance$9,create_fragment$9,safe_not_equal,{ga:0,store:8})}}function get_each_context$3(e,t,n){const r=e.slice();return r[4]=t[n],r}function create_each_block$3(e){let t,n,r,u,a,o=e[4].line+"";return{c(){t=element("p"),n=element("bdi"),r=text(o),u=space(),attr(n,"dir","rtl"),attr(t,"class",a=e[4].css)},m(e,a){insert(e,t,a),append(t,n),append(n,r),append(t,u)},p(e,n){4&n&&o!==(o=e[4].line+"")&&set_data(r,o),4&n&&a!==(a=e[4].css)&&attr(t,"class",a)},d(e){e&&detach(t)}}}function create_fragment$8(e){let t,n,r,u=e[2],a=[];for(let t=0;t<u.length;t+=1)a[t]=create_each_block$3(get_each_context$3(e,u,t));return{c(){t=element("div");for(let e=0;e<a.length;e+=1)a[e].c();set_style(t,"grid-area",e[0])},m(u,o){insert(u,t,o);for(let e=0;e<a.length;e+=1)a[e].m(t,null);n||(r=listen(t,"click",e[3]),n=!0)},p(e,[n]){if(4&n){let r;for(u=e[2],r=0;r<u.length;r+=1){const o=get_each_context$3(e,u,r);a[r]?a[r].p(o,n):(a[r]=create_each_block$3(o),a[r].c(),a[r].m(t,null))}for(;r<a.length;r+=1)a[r].d(1);a.length=u.length}1&n&&set_style(t,"grid-area",e[0])},i:noop,o:noop,d(e){e&&detach(t),destroy_each(a,e),n=!1,r()}}}function instance$8(e,t,n){let r,u=noop,a=()=>(u(),u=subscribe(i,(e=>n(2,r=e))),i);e.$$.on_destroy.push((()=>u()));let{ga:o}=t,{text:i}=t;return a(),e.$$set=e=>{"ga"in e&&n(0,o=e.ga),"text"in e&&a(n(1,i=e.text))},[o,i,r,function(t){bubble.call(this,e,t)}]}class WProblem_Text extends SvelteComponent{constructor(e){super(),init(this,e,instance$8,create_fragment$8,safe_not_equal,{ga:0,text:1})}}function fade(e,{delay:t=0,duration:n=400,easing:r=identity}={}){const u=+getComputedStyle(e).opacity;return{delay:t,duration:n,easing:r,css:e=>"opacity: "+e*u}}function create_fragment$7(e){let t,n,r,u,a,o,i,s;return{c(){t=element("div"),n=element("button"),r=text(e[1]),attr(n,"class",u="text-sm "+e[2]),attr(t,"class","container mx-0 min-w-full flex flex-col items-center")},m(u,a){insert(u,t,a),append(t,n),append(n,r),o=!0,i||(s=[action_destroyer(pulse.call(null,n)),action_destroyer(bounceOnDrag.call(null,n)),listen(n,"click",e[5])],i=!0)},p(e,[t]){(!o||2&t)&&set_data(r,e[1]),(!o||4&t&&u!==(u="text-sm "+e[2]))&&attr(n,"class",u)},i(e){o||(add_render_callback((()=>{a||(a=create_bidirectional_transition(n,fade,{},!0)),a.run(1)})),o=!0)},o(e){a||(a=create_bidirectional_transition(n,fade,{},!1)),a.run(0),o=!1},d(e){e&&detach(t),e&&a&&a.end(),i=!1,run_all(s)}}}function instance$7(e,t,n){let r,{helpMe:u}=t,{text:a="  "}=t,o="",{clicked:i}=u.store;component_subscribe(e,i,(e=>n(4,r=e)));return e.$$set=e=>{"helpMe"in e&&n(0,u=e.helpMe),"text"in e&&n(1,a=e.text)},e.$$.update=()=>{16&e.$$.dirty&&n(2,o=r?"bg-green-200":"bg-inherit")},[u,a,o,i,r,()=>u.apply()]}class HelpMeBtn extends SvelteComponent{constructor(e){super(),init(this,e,instance$7,create_fragment$7,safe_not_equal,{helpMe:0,text:1})}}let anki=Anki.getCard(),newWProblemStore=e=>({text:writable(e.text),problemId:readable(e.problemId),sets:readable(anki.sets),answers:e.answers.map((e=>({value:writable(e.value),isRight:writable(e.isRight),isClicked:writable(!1)}))),helpMe:{here:writable(!1),timeout:e.options.helpMeTimeout,problemId:e.problemId,clicked:writable(!1)}});function parseText(e){let t=(e=e.replaceAll("\r","\n")).replaceAll("U+","&#x").replaceAll("\r","\n").splitTrimNoEmpties("\n"),n=[],r="";for(let e of t)if(e.startsWith("{")){if(!e.endsWith("}"))continue;r=e.slice(1,-1)}else n.push({line:e,css:r}),r="";return n}function parseValues(e){if(!e)return[];return(e.includes("\t")?e.split("\t"):e.includes("\n")?e.split("\n"):e.includes(";")?e.split(";"):e.includes(",")?e.split(","):e.split(" ")).map((e=>e.trim()))}function parseAnswers(e){return parseValues(e)}function parseVariables(e,t){return parseValues(e).map(((e,n)=>{let[r,u]=e.split(":"),a=new Set;return r.startsWith("~")&&(r=r.substring(1),a=new Set(t.map((e=>e[n])))),{name:r,fmt:u??"",invariantValues:[...a]}}))}function parseSets(e){let t=e.includes("<br>")?e.split("<br>"):e.includes("\n")?e.split("\n"):e.includes("\r")?e.split("\r"):e.includes(";")?e.split(";"):[e];t=t.map((e=>e.trim())).filter((e=>""!=e));let n=t.map((e=>parseValues(e)));return n}function parseOptions(e){let t=parseValues(valueOf$1(e.options)).map((e=>e.includes("=")?e.split("="):[e,""])),n=!1,r=parseInt(e.helpMeTimeout);return(isNaN(r)||r<=0)&&(r=5e3),t.forEach((e=>{if("heb-test"===e[0])n=!0;else log.error(`Unknown option '${e}'`,(e=>_l(e)))})),{hebTest:n,helpMeTimeout:r}}let valueOf$1=e=>e?e.trim():e,newWProblemTemplate=e=>{let t=parseSets(valueOf$1(e.sets));return{problemId:valueOf$1(e.problemId),text:parseText(valueOf$1(e.content)),answers:parseAnswers(valueOf$1(e.answers)),variables:parseVariables(valueOf$1(e.variables),t),sets:t,options:parseOptions(e)}},wholeWords=new Map([["0",""],["1",""],["2",""],["3",""],["4",""],["5",""],["6",""],["7",""],["8",""],["9",""],["10",""],["20",""],["30",""],["40",""],["50",""],["60",""],["70",""],["80",""],["90",""],["100",""],["200",""],["300"," "],["400"," "],["500"," "],["600"," "],["700"," "],["800"," "],["900"," "],["1000",""],["2000",""]]),singleFractions=new Map([["1/2",""],["1/3",""],["2/3"," "],["1/4",""],["1/5",""],["1/10",""]]),simpleFractions$1=["1/2","1/3","2/3","1/4","3/4","1/5","2/5","3/5","4/5","1/6","5/6","1/7","2/7","3/7","4/7","5/7","6/7","1/8","3/8","5/8","7/8","1/9","2/9","4/9","5/9","7/9","8/9","1/10","3/10","7/10","9/10","1/12","5/12","7/12","11/12","1/15","2/15","4/15","7/15","8/15","11/15","13/15","14/15","1/20","3/20","7/20","9/20","1/25","2/25","3/25","4/25","1/50","3/50"],isSingleFraction=e=>singleFractions.has(d2t(e)),getSingleFraction=e=>singleFractions.get(d2t(e)),isSimpleFraction$1=e=>simpleFractions$1.includes(d2t(e)),getSimpleFraction=e=>d2t(e);function formatG2l(e,t,n){let r=n2d$1(t2d(e));if(r.isNaN())return[e];let u=[],a=e=>u.push(e.replace("mtr",n.gu).replace("sm",n.lu)),o=r.trunc(),i=o.toString(),s=wholeWords.has(i),c=wholeWords.get(i),l=r.minus(o),f=l.toString(),d=r.minus(r.toDP(2)).eq(0),p=r.toString(),m=isSingleFraction(l),g=getSingleFraction(l),h=isSimpleFraction$1(l),_=getSimpleFraction(l),D=n.g2l(r),$=D.toString(),y=n.g2l(l).toString(),v=wholeWords.has(y),b=wholeWords.get(y);return l.eq(0)&&(s&&a(o.eq(1)?"mtr ":" mtr".replace("",c)),a("0 mtr".replace("0",i)),D.lte(n.luLimit)&&(a("100 sm".replace("100",$)),wholeWords.has($)&&a("100 sm".replace("100",wholeWords.get($))))),o.eq(0)&&(l.eq(0)||(m&&a(" mtr".replace("",g)),h&&a("`1/2` mtr".replace("1/2",_)),d&&(a("0.5 mtr".replace("0.5",f)),a("50 sm".replace("50",y)),v&&a(" sm".replace("",b))))),o.lt(1)||o.gt(1)||l.eq(0)||(m&&a("mtr ".replace("",g)),h&&a("mtr -`1/2`".replace("1/2",_)),d&&(a("mtr -50 sm".replace("50",y)),a("150 sm".replace("150",$)),v&&a("mtr  sm".replace("",b)))),o.lt(2)||l.eq(0)||(s&&m&&a(" mtr ".replace("",c).replace("",g)),h&&a("`2 1/2` mtr".replace("2",i).replace("1/2",_)),d&&(s&&v&&a(" mtr  sm".replace("",c).replace("",b)),a("2.5 mtr".replace("2.5",p)),D.lte(n.luLimit)&&a("250 sm".replace("250",$)))),u}const meter_sm=(e,t)=>formatG2l(e,t,{gu:"",lu:'"',g2l:e=>e.mul(100),luLimit:1e3}),km_meter=(e,t)=>formatG2l(e,t,{gu:'"',lu:"",g2l:e=>e.mul(1e3),luLimit:5e3}),sm_mm=(e,t)=>formatG2l(e,t,{gu:'"',lu:'"',g2l:e=>e.mul(10),luLimit:100});function kilo(e,t){let n=()=>`${r.div(1e3)} "`;if(e.includes("/"))return[toAscii(e)];let r=n2d$1(parseFloat(e));return r.isNaN()?[]:r.gte(2e3)?[n()]:[`${e} `,n()]}const kg_gram=(e,t)=>formatG2l(e,t,{gu:'"',lu:"",g2l:e=>e.mul(1e3),luLimit:3e3});function shekel_agorot(e,t){let n=formatG2l(e,t,{gu:"",lu:"",g2l:e=>e.mul(100),luLimit:300}),r=n.filter((e=>!e.includes("")));switch(t){case"$":case"$1":return n;case"$2":return r.length>0?r:n}}function percents(e){if(e.includes("/"))return[toAscii(e)];let t=n2d$1(parseFloat(e));if(t.isNaN())return[];switch(randFrom(["percents","fraction","dots"])){case"percents":return[`${t.mul(100)}%`];case"fraction":return[toAscii(d2t(t))];case"dots":return[e]}}function percents2(e,t,n=[]){let r=t2d(e);if(r.isNaN())return[];let u=[],a=r.minus(r.toDP(3)).eq(0),o=isSimpleFraction$1(r),i=`${r.mul(100)}%`,s=r.toString(),c=toAscii(d2t(r));return a&&(u.push(s),u.push(i)),o&&(u.push(c),n.forEach((e=>u.push(toAscii(d2t5(r,e)))))),0===u.length&&u.push(e.includes("/")?toAscii(e):e),u}const p2=(e,t)=>percents2(e),p3=(e,t)=>percents2(e,t,[2,3,4,5]);let simpleFractions=["1/2","1/3","2/3","1/4","3/4","1/5","2/5","3/5","4/5","1/6","5/6","1/10","3/10","7/10","9/10","1/12","5/12","7/12","11/12"];function isSimpleFraction(e){let t=d2t(e.div(60));return simpleFractions.includes(t)}let tmHebrew={revaShaa:" ",shlishShaa:"",heziShaa:" ",fractionOfShaa:"`N/D` ",dakotOnly:"MM ",shaa:"",shaaVeReva:" ",shaaVeShlish:" ",shaaVaHezi:" ",shaaVeFraction:" -`N/D`",shaaVeDakot:" -MM ",shaataim:"",shaataimVeReva:" ",shaataimVeShlish:" ",shaataimVaHezi:" ",shaataimVeFraction:" - `N/D`",shaataimVeDakot:" -MM ",shaotOnly:"HH ",shaotVeReva:"HH  ",shaotVeShlish:"HH  ",shaotVaHezi:"HH  ",shaotVeFraction:"HH  - `N/D`",shaotVeDakot:"HH  -MM ",shaaVeShever:""};function variateTime(e){let t=[],n=t2d(e),r=n.mul(60),u=n.trunc(),a=n.minus(u).mul(60),o=d2t(a),i=d2t(u);return function(){if(!r.gte(60)){if(a.eq(15))return t.push(tmHebrew.revaShaa),t.push(tmHebrew.dakotOnly.replace("MM","15")),void t.push(tmHebrew.fractionOfShaa.replace("N/D","1/4"));if(a.eq(30))return t.push(tmHebrew.heziShaa),t.push(tmHebrew.dakotOnly.replace("MM","30")),void t.push(tmHebrew.fractionOfShaa.replace("N/D","1/2"));if(isSimpleFraction(a)){let e=d2t(a.div(60));t.push(tmHebrew.fractionOfShaa.replace("N/D",e))}t.push(tmHebrew.dakotOnly.replace("MM",o))}}(),function(){if(!r.lt(60)&&!r.gte(120)){if(a.eq(0))return t.push(tmHebrew.shaa),void t.push(tmHebrew.dakotOnly.replace("MM","60"));if(a.eq(15))return t.push(tmHebrew.shaaVeReva),t.push(tmHebrew.shaaVeDakot.replace("MM","15")),void t.push(tmHebrew.shaaVeFraction.replace("N/D","1/4"));if(a.eq(20))return t.push(tmHebrew.shaaVeShlish),t.push(tmHebrew.shaaVeDakot.replace("MM","20")),void t.push(tmHebrew.shaaVeFraction.replace("N/D","1/3"));if(a.eq(30))return t.push(tmHebrew.shaaVaHezi),t.push(tmHebrew.shaaVeDakot.replace("MM","30")),void t.push(tmHebrew.shaaVeFraction.replace("N/D","1/2"));if(isSimpleFraction(a)){let e=d2t(a.div(60));t.push(tmHebrew.shaaVeFraction.replace("N/D",e))}t.push(tmHebrew.dakotOnly.replace("MM",d2t(r))),t.push(tmHebrew.shaaVeDakot.replace("MM",o))}}(),function(){if(!r.lt(120)&&!r.gte(180)){if(a.eq(0))return t.push(tmHebrew.shaataim),void t.push(tmHebrew.dakotOnly.replace("MM","120"));if(a.eq(15))return t.push(tmHebrew.shaataimVeReva),t.push(tmHebrew.shaataimVeDakot.replace("MM","15")),void t.push(tmHebrew.shaataimVeFraction.replace("N/D","1/4"));if(a.eq(20))return t.push(tmHebrew.shaataimVeShlish),t.push(tmHebrew.shaataimVeDakot.replace("MM","20")),void t.push(tmHebrew.shaataimVeFraction.replace("N/D","1/3"));if(a.eq(30))return t.push(tmHebrew.shaataimVaHezi),t.push(tmHebrew.shaataimVeDakot.replace("MM","30")),void t.push(tmHebrew.shaataimVeFraction.replace("N/D","1/2"));if(isSimpleFraction(a)){let e=d2t(a.div(60));t.push(tmHebrew.shaataimVeFraction.replace("N/D",e))}t.push(tmHebrew.dakotOnly.replace("MM",d2t(r))),t.push(tmHebrew.shaataimVeDakot.replace("MM",o))}}(),function(){if(!r.lt(180)){if(a.eq(0))return t.push(tmHebrew.shaotOnly.replace("HH",i)),void(r.lte(240)&&t.push(tmHebrew.dakotOnly.replace("MM",d2t(u.mul(60)))));if(a.eq(15))return t.push(tmHebrew.shaotVeReva.replace("HH",i)),t.push(tmHebrew.shaotVeDakot.replace("HH",i).replace("MM","15")),void t.push(tmHebrew.shaotVeFraction.replace("HH",i).replace("N/D","1/4"));if(a.eq(20))return t.push(tmHebrew.shaotVeShlish.replace("HH",i)),t.push(tmHebrew.shaotVeDakot.replace("HH",i).replace("MM","20")),void t.push(tmHebrew.shaotVeFraction.replace("HH",i).replace("N/D","1/3"));if(a.eq(30))return t.push(tmHebrew.shaotVaHezi.replace("HH",i)),t.push(tmHebrew.shaotVeDakot.replace("HH",i).replace("MM","30")),void t.push(tmHebrew.shaotVeFraction.replace("HH",i).replace("N/D","1/2"));if(isSimpleFraction(a)){let e=d2t(a.div(60));t.push(tmHebrew.shaotVeFraction.replace("HH",i).replace("N/D",e))}t.push(tmHebrew.shaotVeDakot.replace("HH",i).replace("MM",o))}}(),t}function variateTimeWithFractionsOnly(e){let t=[],n=t2d(e),r=n.mul(60),u=n.trunc(),a=n.minus(u).mul(60),o=d2t(a),i=d2t(u);return function(){if(!r.gte(60))if(a.eq(15))t.push(tmHebrew.fractionOfShaa.replace("N/D","1/4"));else if(a.eq(30))t.push(tmHebrew.fractionOfShaa.replace("N/D","1/2"));else if(isSimpleFraction(a)){let e=d2t(a.div(60));t.push(tmHebrew.fractionOfShaa.replace("N/D",e))}else t.push(tmHebrew.dakotOnly.replace("MM",o))}(),function(){if(!r.lt(60)&&!r.gte(120))if(a.eq(0))t.push(tmHebrew.shaa);else if(a.eq(15))t.push(tmHebrew.shaaVeFraction.replace("N/D","1/4"));else if(a.eq(30))t.push(tmHebrew.shaaVeFraction.replace("N/D","1/2"));else if(isSimpleFraction(a)){let e=d2t(a.div(60));t.push(tmHebrew.shaaVeFraction.replace("N/D",e))}else t.push(tmHebrew.shaaVeDakot.replace("MM",o))}(),function(){if(!r.lt(120)&&!r.gte(180))if(a.eq(0))t.push(tmHebrew.shaataim);else if(a.eq(15))t.push(tmHebrew.shaataimVeFraction.replace("N/D","1/4"));else if(a.eq(30))t.push(tmHebrew.shaataimVeFraction.replace("N/D","1/2"));else if(isSimpleFraction(a)){let e=d2t(a.div(60));t.push(tmHebrew.shaataimVeFraction.replace("N/D",e))}else t.push(tmHebrew.shaataimVeDakot.replace("MM",o))}(),function(){if(!r.lt(180))if(a.eq(0))t.push(tmHebrew.shaotOnly.replace("HH",i));else if(a.eq(15))t.push(tmHebrew.shaotVeFraction.replace("HH",i).replace("N/D","1/4"));else if(a.eq(30))t.push(tmHebrew.shaotVeFraction.replace("HH",i).replace("N/D","1/2"));else if(isSimpleFraction(a)){let e=d2t(a.div(60));t.push(tmHebrew.shaotVeFraction.replace("HH",i).replace("N/D",e))}else t.push(tmHebrew.shaotVeDakot.replace("HH",i).replace("MM",o))}(),t}const time=(e,t)=>variateTime(e),timeWithFractionsOnly=(e,t)=>variateTimeWithFractionsOnly(e);function newFormatters(){function e(e){return e.includes("/")?toAscii(e):e}function t(e){return[toAscii(e)]}let n=new Map([["p",percents],["p1",percents],["p2",p2],["p3",p3],["m",kilo],["m1",kilo],["m2",kg_gram],["t",time],["t1",time],["t2",timeWithFractionsOnly],["d",km_meter],["d1",km_meter],["d2",meter_sm],["d3",sm_mm],["a",t],["a1",t],["f",e=>[""]],["f1",e=>[""]],["$",shekel_agorot],["$1",shekel_agorot],["$2",shekel_agorot]]);return{apply:(t,r)=>{if(t.includes("`"))return t;if(!r||""===r)return e(t);if(n.has(r)){let e=n.get(r)(t,r);return 0===e.length&&(log.error(`no formatter variations for '${t}'; fmt='${r}'`,(e=>_l(e))),e.push(t)),randFrom(e)}return log.error(`unknown formatter '${r}'`,(e=>_l(e))),e(t)},variateTime:e=>variateTime(e)}}const formatters=newFormatters();function applyFormat(e,t){var n;return e.includes("`")?e:t&&""!==t?formatters.apply(e,t):(n=e).includes("/")?toAscii(n):n}function substitute(e,t,n){let r=t.map(((e,t)=>{let r=e.invariantValues.length>0?randFrom(e.invariantValues):n[t];return r=applyFormat(r,e.fmt),{$var:e,uniqueName:`__${t}__`,value:r}}));r=r.filter((e=>e.$var.name.length>0)),r.sort(((e,t)=>t.$var.name.length-e.$var.name.length));for(let t=3;t-- >0;){if(r.forEach((t=>e=e.replaceAll(t.$var.name,t.uniqueName))),r.forEach((t=>e=e.replaceAll(t.uniqueName,t.value))),r.every((t=>!e.includes(t.$var.name))))break}return e}function makeText(e,t){function n(n){let r=substitute(n,e.variables,t);return r.isAsciiMath()&&(r=r.toAsciiMath()),r}return e.text.map((e=>({line:n(e.line),css:e.css})))}function makeAnswers(e,t){return shuffle(e.answers.map(((n,r)=>({name:e.answers[r],value:substitute(n,e.variables,t),isRight:0==r}))))}let newWProblemLogic=e=>({makeModel:(t=-1)=>{let n=rand(0,e.sets.length-1);for(;n===t&&e.sets.length>1;)n=rand(0,e.sets.length-1);let r=e.sets[n];return{problemId:e.problemId,setId:n,text:makeText(e,r),answers:makeAnswers(e,r),options:e.options}}}),Null={markCurrentCard:()=>{},isCurrentCardMarked:()=>!1};function newAnkiDroid(){return safe((()=>(AnkiDroidJS.init(JSON.stringify({version:"0.0.1",developer:"info@gebemot.com"})),!0)),!1)?{markCurrentCard:()=>safe((()=>{AnkiDroidJS.ankiGetCardMark()||ankiMarkCard()})),isCurrentCardMarked:()=>safe((()=>AnkiDroidJS.ankiGetCardMark()))}:Null}const ankiDroid=newAnkiDroid();function newHelpMe(e){let t,n=e;function r(){let r=ankiDroid.isCurrentCardMarked();e.clicked.set(r),clearTimeout(t),t=setTimeout((()=>n.here.set(!0)),e.timeout)}return{store:e,start:()=>r(),restart:()=>{n.here.set(!1),r()},apply:()=>{e.clicked.set(!0),ankiDroid.markCurrentCard()}}}function get_each_context$2(e,t,n){const r=e.slice();return r[18]=t[n],r[20]=n,r}function create_if_block$1(e){let t,n;return t=new HelpMeBtn({props:{helpMe:e[4]}}),{c(){create_component(t.$$.fragment)},m(e,r){mount_component(t,e,r),n=!0},p:noop,i(e){n||(transition_in(t.$$.fragment,e),n=!0)},o(e){transition_out(t.$$.fragment,e),n=!1},d(e){destroy_component(t,e)}}}function create_key_block$2(e){let t,n;return t=new WProblem_Text({props:{ga:"txt",text:e[3].text}}),t.$on("click",e[10]),{c(){create_component(t.$$.fragment)},m(e,r){mount_component(t,e,r),n=!0},p:noop,i(e){n||(transition_in(t.$$.fragment,e),n=!0)},o(e){transition_out(t.$$.fragment,e),n=!1},d(e){destroy_component(t,e)}}}function create_each_block$2(e,t){let n,r,u;return r=new WProblem_Ans({props:{store:t[18],ga:`a${t[20]}`}}),r.$on("click",(function(){return t[11](t[20])})),{key:e,first:null,c(){n=empty(),create_component(r.$$.fragment),this.first=n},m(e,t){insert(e,n,t),mount_component(r,e,t),u=!0},p(e,n){t=e},i(e){u||(transition_in(r.$$.fragment,e),u=!0)},o(e){transition_out(r.$$.fragment,e),u=!1},d(e){e&&detach(n),destroy_component(r,e)}}}function create_default_slot$3(e){let t,n,r,u,a,o=e[0],i=[],s=new Map;t=new Congrats({props:{}}),e[9](t);let c=create_key_block$2(e),l=e[3].answers;const f=e=>({model:e[0]});for(let t=0;t<l.length;t+=1){let n=get_each_context$2(e,l,t),r=f(n);s.set(r,i[t]=create_each_block$2(r,n))}return{c(){create_component(t.$$.fragment),n=space(),c.c(),r=space();for(let e=0;e<i.length;e+=1)i[e].c();u=empty()},m(e,o){mount_component(t,e,o),insert(e,n,o),c.m(e,o),insert(e,r,o);for(let t=0;t<i.length;t+=1)i[t].m(e,o);insert(e,u,o),a=!0},p(e,n){t.$set({}),1&n&&safe_not_equal(o,o=e[0])?(group_outros(),transition_out(c,1,1,noop),check_outros(),c=create_key_block$2(e),c.c(),transition_in(c,1),c.m(r.parentNode,r)):c.p(e,n),41&n&&(l=e[3].answers,group_outros(),i=update_keyed_each(i,n,f,1,e,l,s,u.parentNode,outro_and_destroy_block,create_each_block$2,u,get_each_context$2),check_outros())},i(e){if(!a){transition_in(t.$$.fragment,e),transition_in(c);for(let e=0;e<l.length;e+=1)transition_in(i[e]);a=!0}},o(e){transition_out(t.$$.fragment,e),transition_out(c);for(let e=0;e<i.length;e+=1)transition_out(i[e]);a=!1},d(a){e[9](null),destroy_component(t,a),a&&detach(n),c.d(a),a&&detach(r);for(let e=0;e<i.length;e+=1)i[e].d(a);a&&detach(u)}}}function create_fragment$6(e){let t,n,r,u=e[2]&&create_if_block$1(e);return n=new Grid({props:{layout:e[7],$$slots:{default:[create_default_slot$3]},$$scope:{ctx:e}}}),n.$on("click",e[12]),{c(){u&&u.c(),t=space(),create_component(n.$$.fragment)},m(e,a){u&&u.m(e,a),insert(e,t,a),mount_component(n,e,a),r=!0},p(e,[r]){e[2]?u?(u.p(e,r),4&r&&transition_in(u,1)):(u=create_if_block$1(e),u.c(),transition_in(u,1),u.m(t.parentNode,t)):u&&(group_outros(),transition_out(u,1,1,(()=>{u=null})),check_outros());const a={};2097155&r&&(a.$$scope={dirty:r,ctx:e}),n.$set(a)},i(e){r||(transition_in(u),transition_in(n.$$.fragment,e),r=!0)},o(e){transition_out(u),transition_out(n.$$.fragment,e),r=!1},d(e){u&&u.d(e),e&&detach(t),destroy_component(n,e)}}}function instance$6(e,t,n){let r,u=newWProblemTemplate(Anki.getCard()),a=newWProblemLogic(u),o=a.makeModel();console.log("model",o);let i,s=newWProblemStore(o),c=!1,l=!1;versions.add(u.problemId);let f=newHelpMe(s.helpMe);function d(e){c?p():(s.answers.forEach(((e,t)=>e.isClicked.set(o.answers[t].isRight))),s.answers[e].isClicked.set(!0),c=!0,l=o.answers[e].isRight,l&&i.play())}function p(){n(0,o=a.makeModel(o.setId)),s.text.set(o.text),s.answers.forEach(((e,t)=>{e.value.set(o.answers[t].value),e.isRight.set(o.answers[t].isRight),e.isClicked.set(!1)})),c=!1,l=!1,applyAsciiMath(500),f.restart()}function m(){c&&p()}onMount((()=>{applyAsciiMath(1e3),f.start()}));let g={areas:'\n            "txt  txt  txt "\n            "txt  txt  txt "\n            "txt  txt  txt "\n            "txt  txt  txt "\n            "a0    .    a1 "\n            "a2    .    a3 "\n            ".     .    .  "\n        ',cols:"2fr 1fr 2fr",rows:"2fr 2fr 2fr 2fr 2fr 2fr 10px"},h=f.store.here;component_subscribe(e,h,(e=>n(2,r=e)));return[o,i,r,s,f,d,m,g,h,function(e){binding_callbacks[e?"unshift":"push"]((()=>{i=e,n(1,i)}))},()=>m(),e=>d(e),()=>m()]}class WProblem_View extends SvelteComponent{constructor(e){super(),init(this,e,instance$6,create_fragment$6,safe_not_equal,{})}}function create_fragment$5(e){let t,n,r,u,a,o,i;return{c(){t=element("div"),n=element("div"),r=element("span"),u=text(e[2]),attr(n,"class",a="\\ text-xs text-center text-black \\ "+e[1]+" \\"),set_style(n,"width",e[3]+"%"),attr(t,"class","w-full bg-red-50 text-right"),set_style(t,"grid-area",e[0])},m(e,a){insert(e,t,a),append(t,n),append(n,r),append(r,u),o||(i=[action_destroyer(pulse.call(null,r)),action_destroyer(pulse.call(null,t)),action_destroyer(bounceOnDrag.call(null,t))],o=!0)},p(e,[r]){4&r&&set_data(u,e[2]),2&r&&a!==(a="\\ text-xs text-center text-black \\ "+e[1]+" \\")&&attr(n,"class",a),8&r&&set_style(n,"width",e[3]+"%"),1&r&&set_style(t,"grid-area",e[0])},i:noop,o:noop,d(e){e&&detach(t),o=!1,run_all(i)}}}function instance$5(e,t,n){let r,u,{ga:a}=t,{bgColor:o="bg-green-300"}=t,{store:i}=t,{value:s,max:c}=i;component_subscribe(e,s,(e=>n(8,u=e))),component_subscribe(e,c,(e=>n(7,r=e)));let[l,f]=[u,0];return e.$$set=e=>{"ga"in e&&n(0,a=e.ga),"bgColor"in e&&n(1,o=e.bgColor),"store"in e&&n(6,i=e.store)},e.$$.update=()=>{if(384&e.$$.dirty){let e=r-u;e>=0&&(n(2,l=e),n(3,f=u/r*100))}},[a,o,l,f,s,c,i,r,u]}class Progress2 extends SvelteComponent{constructor(e){super(),init(this,e,instance$5,create_fragment$5,safe_not_equal,{ga:0,bgColor:1,store:6})}}function makeProgress({startFrom:e,doneCount:t,onDone:n}){let r=e??0,u=t;function a(e){}let o=a,i=a;function s(){r===u&&n()}return{value:readable(r,(e=>(o=e,()=>o=a))),max:readable(u,(e=>(i=e,()=>i=a))),isOn:readable(t>1),rightClick:function(){r===u&&i(++u),o(++r),s()},wrongClick:function(){i(u+=1),s()},addWork:function(e=1){i(u+=e),s()}}}function WithIndex(e,t){return new Proxy(t,{get:(t,n)=>n in t?Reflect.get(t,n):e(n)})}function newArgsArray(e){let t=e.flat();function n(e,n){return t[e]}function r(e){return[n2d$1(0)]}return WithIndex((e=>n(e)),{count:t.length,all:()=>t,get:(e,t=!0)=>n(e),has:e=>void 0!==n(e),v2i:(e,t=!0)=>{let r=n(e);return isArrayIndex(r)?Number(r):((e,t)=>e?throwError(t,(e=>_l(e))):void 0)(t,`Not an index '${r}'`)},v2d:(e,t=!0)=>t2d(n(e)),rand:()=>r()[0],rands:(e=1)=>r()})}function parseArgsArray(e){if(""===e.trim())return newArgsArray([]);let t=(e=fixCrInCells(e,";")).splitTrimNoEmpties("\n").map((e=>e.splitTrim("\t")));return newArgsArray(t)}function makeDFmt(){function e(e){switch(e.toLocaleLowerCase()){case"d":default:return":d";case"f":return":f";case"w":return":w";case"r":return":r"}}function t(e){let t=":d",n=e.includes("."),r=e.includes("/"),u=e.trim().includes(" ");return r&&u?t=":w":r?t=":f":n&&(t=":d"),t}function n(t){let[n,r]=t.splitTrim(":");return r?e(r):":d"}let r={":d":1,":f":10,":w":100,":r":1e3};function u(e,t){if(!e.isFinite())return notFinite2t(e);let n=!e.toFraction()[1].eq(1),r=e.minus(e.toDP(3)).eq(0),u=e.toString(),a=e.gt(1);if(":r"===t){let t=[];return n&&t.push(d2t(e,!1)),n&&a&&t.push(d2t(e,!0)),r&&t.push(u),randFrom(t)}switch(t){case":d":return r?u:d2t(e,!1);case":w":return d2t(e);case":f":return d2t(e,!1)}}return{toDFmt:e,parse:function(e,...u){let a,o=":d",i=e=>o=o?r[e]>=r[o]?e:o:e,s=e=>a=a?r[e]>=r[a]?e:a:e;for(let r of[...one2many(e),...u])if(r.includes(":")){s(n(r))}else{i(t(r))}return a||o},format:u,formats:function(e,t){return e.map((e=>u(e,t)))}}}const DFmt=makeDFmt();function newCellAsRandomGenerator(e,t=-1){function n(e){return e.startsWith("*|")?["*",e.slice(2)]:["+",e]}function r(e){let{asIs:t,d:n,fmt:r}=e;if(t&&!r)return t;if(assert(n&&r,(e=>_l(e))),!n.isFinite())return notFinite2t(n);let u=!n.toFraction()[1].eq(1),a=n.minus(n.toDP(2)).eq(0),o=n.toString(),i=n.gt(1);if(t&&":r"===r){let e=[t];return u&&e.push(d2t(n,!1)),u&&i&&e.push(d2t(n,!0)),a&&e.push(o),randFrom(e)}switch(":r"===r&&(r=randFrom([":d",":w",":f"])),r){case":d":return a?o:d2t(n);case":w":return d2t(n);case":f":return d2t(n,!1)}}let u=e.splitTrim(";");u.includes("")&&throwError(`Empty line in cell random generator; cell='${e}'`,(e=>_l(e))),t>=0&&(u=[u[t%u.length]]);let a=u.map((e=>e.includes("..")?function(e){let[t,r]=n(e),[u,a]=r.split(":"),[o,i]=u.split("|"),[s,c]=o.split("..");i??="1";let l=a?DFmt.toDFmt(a):DFmt.parse(s,c,i),[f,d,p]=[t2d(s),t2d(c),t2d(i)],m=[];for(let e=f;e.lte(d);e=e.add(p))m.push({d:e,fmt:l,op:t});return m}(e):function(e){let[t,r]=n(e),u=r.splitTrimNoEmpties(","),a=[];return u.forEach((e=>{let[n,r]=e.split(":"),u=r?DFmt.toDFmt(r):void 0,o=t2d(n);a.push({asIs:n,d:o,fmt:u,op:t})})),a}(e))).flat();return 0===a.length&&throwError(`Cell random generator produced no numbers; cell='${e}'`,(e=>_l(e))),{op:a[0].op,all:()=>d2n(a.map((e=>e.d))),one:()=>r(randFrom(a)),many:e=>{e<=0&&throwError(`Can't take ${e} numbers`,(e=>_l(e)));let t=new Set;for(let n of shuffle(a))if(t.add(r(n)),t.size===e)break;return[...t]}}}function newArgsGrid(e){(!e||e.length<=1||0===e[0].length)&&throwError("Undefined or empty grid",(e=>_l(e)));let[t,...n]=e,r=n.map((e=>e.join(","))),[u,a]=[n.length,n[0].length];function o(e,o,i,s=!1){let c=e=>i?throwError(`${e} in ${o} row (${r[o]})`,(e=>_l(e))):void 0;if(o<0||o>=u)return c(`Row ${o} is out of grid (${u} lines)`);if(isArrayIndex(e))return s?e<0||e>=u?c(`Row ${e} is out of grid (${u} lines)`):0===e?this:newArgsGrid([t,...n.slice(e)]):e<0||e>=a||e>=n[o].length?c(`No ${s?"line":"index"} '${e}'`):n[o][e];let l=t.indexOf(e);return-1===l?c(`No key '${e}'`):l>=n[o].length?c(`No value for '${e}' at ${l} (row.length=${n[o].length})`):n[o][l]}function i(e,t,n){let r=o(e,n,!0).splitTrim(";");t>=0&&(r=[r[t%r.length]]);let u=r.map((e=>e.split(","))).flat();return randFrom(u)}function s(e,t,n){return t2d(newCellAsRandomGenerator(o(e,n,!0),t).one())}function c(e,t,n,r){let u=o(e,n,r);if(void 0===u)return;let a=u.splitTrim(";");return a[t%a.length]}return WithIndex((e=>o(e,0,!0,!0)),{numOfLines:u,get:(e,t=0,n=!1)=>o(e,t,n),at:(e,t=0,n=!0)=>o(e,t,n),has:(e,t=0)=>void 0!==o(e,t,!1),atLnNo:function(e,t,n=0,r=!0){return"string"==typeof e||"number"==typeof e?c(e,t,n,r):(assert(e.length>0,"Should be one name at least"),e.map((e=>c(e,t,n,r))))},v2i:function(e,t=0,n=!1){let r=o(e,t,n),u=n=>throwError(`v2i('${e}', ${t}): ${n} while converting v='${r}'`);if(void 0===r){if(!n)return;u("No key")}if(0===r.length){if(!n)return;u("Empty value")}let a=parseInt(r),i=n2d$1(a);try{i=t2d(r)}catch{if(!n)return a;u("NaN (string)")}if(!i.eq(a)){if(!n)return a;u("NaN (not integer)")}if(Number.isNaN(Number(r))){if(!n)return a;u("NaN (string)")}return a},v2d:function(e,t=0,n=!1){let r=o(e,t,n),u=n=>throwError(`v2d('${e}', ${t}): ${n} while converting v='${r}'`);if(void 0===r){if(!n)return;u("No key")}if(0===r.length){if(!n)return;u("Empty value")}let a=t2d(r);if(a.eq(n2d$1(1/0))){if(!n)return a;u("Infinity in value")}return a},rand_str:function(e,t=-1,n=0){return"string"==typeof e||"number"==typeof e?i(e,t,n):(assert(e.length>0,"Should be one name at least"),e.map((e=>i(e,t,n))))},rand:function(e,t=-1,n=0){return"string"==typeof e||"number"==typeof e?s(e,t,n):(assert(e.length>0,"Should be one name at least"),e.map((e=>s(e,t,n))))},lines:function(e,t=0,n=!0){return o(e,t,n).split(";")}})}function parseArgsGrid(e){if(""===e.trim())return newArgsGrid([["n/a"],[void 0]]);let t=(e=fixCrInCells(e,";")).splitTrimNoEmpties("\n").map((e=>e.splitTrim("\t")));return newArgsGrid(t)}const Config={numberOfLinesInGeneratorCell:[5,10],nCountInSequence:8,maxRetriesOnSameInput:20};let valueOf=e=>e?e.trim():"";function parseViewTemplate(e){return e.split("\n").map((e=>e.splitTrim("\t")))}function makeSqDefinition(e=null){e??=ankiCard;let t=valueOf(e.problemId),n=parseArgsGrid(valueOf(e.content)),r=parseViewTemplate(valueOf(e.view)),u=parseArgsArray(valueOf(e.answers)),a=parseArgsGrid(valueOf(e.options)),o=a.v2i("count")??Config.nCountInSequence,i=a.v2i("rounds")??1,s=a.v2i("timer")??0;return{problemId:t,content:n,nCount:o,viewTemplate:r,answers:u,options:a,settings:{rounds:i,timer:s}}}function newFormulas(){let e=new Map;return{registerFactory:function(t,n){one2many(t).forEach((t=>{assert(!e.has(t),`Formula '${t}' is already registered`),e.set(t,n)}))},makeFormula:t=>{let n=t.args.formula.splitTrim("|")[0],r=e.get(n);return assert(r,`No formula '${n}' is registered`),log.onerror((()=>r(t)),(e=>_l(e,`While making '${n}'`)))}}}const Formulas=newFormulas();let _uniqueId=0;function newVariable({name:e,view:t,value:n,fmt:r}){let u=`__${++_uniqueId}__`,a=`~${e}`,o=`~${u}`,i=one2many(t),s=one2many(n);return function(e){if(i.length>1)return;assert(1===s.length);let t=s[0],n=s[0].abs(),u=n2d$1(n.lte(1)?.1:n.lte(2)?.2:n.lte(3)?.5:n.lte(10)?1:n.lte(50)?5:10);range(e).forEach((e=>{let n=u.mul(e+1),a=t.minus(n),o=t.plus(n);s.push(a,o),i.push(DFmt.format(a,r),DFmt.format(o,r))}))}(3),{name:e,view:i[0],value:s[0],uniqueName:u,values:s,views:i,toUniqueName:function(t){return t.replaceAll(a,o).replaceAll(e,u)},toView:function({str:e,variate:t=!1}){let[n,r]=[i[0],i[0]];return t&&i.length>1&&(r=randFrom(i.slice(1))),e.replaceAll(o,r).replaceAll(u,n)},rand:()=>randFrom(i),iAmHere:function(t){let n=t.includes(e)||t.includes(u),r=t.includes(a)||t.includes(o);return n&&!r}}}Formulas.registerFactory("a0+nd",(({args:e,genLnNo:t,nCount:n})=>{let r=e.subst,u=e.atLnNo("a0",t),a=e.atLnNo("d",t),o=newCellAsRandomGenerator(e.atLnNo("dd",t,0,!1)??"0",t),i=r.split(":")[0],s=e.rand("a0",t),c=e.rand("d",t),l=t2d(o.one()),f=o.op,d=DFmt.parse(r,u,a),p=DFmt.format(c,d),m=DFmt.format(l,d),g=(e,t)=>newVariable({name:`${i}${e}`,view:DFmt.format(t,d),value:t,fmt:d});return{A:i,fmt:d,makeSequence:function(){let e=s,t=c,r=[g(0,e)];for(let u=1;u<=n;u++)e=e.plus(t),r.push(g(u,e)),t="*"===f?t.mul(l):t.plus(l);return r},makeVariables:function(){return[newVariable({name:`d${i}`,view:p,value:c,fmt:d}),newVariable({name:`dd${i}`,view:m,value:l,fmt:d})]}}})),Formulas.registerFactory("a0*d^n",(({args:e,genLnNo:t,nCount:n})=>{let r=e.subst,u=e.atLnNo("a0",t),a=e.atLnNo("d",t),o=newCellAsRandomGenerator(e.atLnNo("dd",t,0,!1)??"0",t),i=r.split(":")[0],s=e.rand("a0",t),c=e.rand("d",t),l=t2d(o.one()),f=DFmt.parse(r,u,a),d=(e,t)=>newVariable({name:`${i}${e}`,view:DFmt.format(t,f),value:t,fmt:f});return{A:i,fmt:f,makeSequence:function(){let e=[d(0,s)],t=s;for(let r=1;r<=n;r++)t=t.mul(c),e.push(d(r,t)),c=c.add(l);return e},makeVariables:function(){return[]}}})),Formulas.registerFactory(["fib","fib-","fib*"],(({args:e,genLnNo:t,nCount:n})=>{let r=e.formula,u=r.includes("-")?"-":r.includes("*")?"*":"+",a=e.subst,o=e.atLnNo("a0",t),i=a.split(":")[0],s=e.rand("a0",t),c=e.rand("a1",t),l=DFmt.parse(a,o),f=(e,t)=>newVariable({name:`${i}${e}`,view:DFmt.format(t,l),value:t,fmt:l});return{A:i,fmt:l,makeSequence:function(){let e=[f(0,s),f(1,c)];for(let t=2;t<=n;t++){let n="-"===u?s.minus(c):"*"===u?s.mul(c):s.plus(c);e.push(f(t,n)),[s,c]=[c,n]}return e},makeVariables:function(){return[]}}})),Formulas.registerFactory("fib3",(({args:e,genLnNo:t,nCount:n})=>{let r=e.subst,u=e.atLnNo("a0",t),a=r.split(":")[0],o=e.rand("a0",t),i=e.rand("a1",t),s=e.rand("a2",t),c=DFmt.parse(r,u),l=(e,t)=>newVariable({name:`${a}${e}`,view:DFmt.format(t,c),value:t,fmt:c});return{A:a,fmt:c,makeSequence:function(){let e=[l(0,o),l(1,i),l(2,s)];for(let t=3;t<=n;t++){let n=o.plus(i).plus(s);e.push(l(t,n)),[o,i,s]=[i,s,n]}return e},makeVariables:function(){return[]}}}));let formulas=new Map([["+",(e,t)=>e.plus(t)],["-",(e,t)=>e.minus(t)],["*",(e,t)=>e.mul(t)],["/",(e,t)=>e.div(t)]]);function op_table({args:e,genLnNo:t,nCount:n}){let r=e.atLnNo(["a0","b0","c0","v1","v2"],t),[u,a,o,i,s]=r.map((e=>DFmt.parse(e))),{maxRetriesOnSameInput:c}=Config,[l,f,d]=takeIf(c,(()=>e.rand(["a0","b0","c0"],t)),(e=>e.hasUniqueValues())),[p,m]=e.rand(["v1","v2"],t),[g,h]=e.rand_str(["op1","op2"],t),_=(e,t,n)=>newVariable({name:n,view:DFmt.format(e,t),value:e,fmt:t}),D=(e,t,n,r)=>{let u;switch(e){case"+":u=t.lt(0)?"":"+";break;case"-":u=t.lt(0)?"+":"-";break;case"/":u="-:";break;case"*":u="xx"}return newVariable({name:r,view:`${u}${DFmt.format(t,n)}`,value:t,fmt:n})},$=(e,t,n)=>{let r=formulas.get(t);return assert(r,`Can't find formula for op='${t}'`),r(e,n)};return{A:"",fmt:u,makeSequence:function(){let e=$(l,g,p),t=$(f,g,p),n=$(d,g,p),r=$(e,h,m),i=$(t,h,m),s=$(n,h,m);return[_(l,u,"a0"),_(e,u,"a1"),_(r,u,"a2"),_(f,a,"b0"),_(t,a,"b1"),_(i,a,"b2"),_(d,o,"c0"),_(n,o,"c1"),_(s,o,"c2")]},makeVariables:function(){return[D(g,p,i,"op1"),D(h,m,s,"op2")]}}}function makeLambdas$1({args:e,genLnNo:t,options:n,fmt:r}){function u(){let n=e.rand("b",t);return[n,DFmt.format(n,r)]}function a(){let n=e.rand("b",t),u=n.lt(0)?"-":"+",a=DFmt.format(n.abs(),r);return[n,`${u} ${a}`]}let o=function(){let e="as-is";switch(n.get("how")){case"colored":e="colored";break;case"squares":e="squares"}return e}(),i="squares"===o?e=>"color(green)(square)":"colored"===o?e=>`color(green)(${e})`:e=>e,s="squares"===o?e=>"color(red)(square)":"colored"===o?e=>`color(red)(${e})`:e=>e,c={"(x,y)=>x+y":()=>({apply:(e,t)=>e.add(t),how:(e,t)=>`${i(e)} + ${s(t)}`}),"(x,y)=>x-y":()=>({apply:(e,t)=>e.minus(t),how:(e,t)=>`${i(e)} - ${s(t)}`}),"(x,y)=>y-x":()=>({apply:(e,t)=>t.minus(e),how:(e,t)=>`${s(t)} - ${i(e)}`}),"(x,y)=>x+y+b":()=>{let[e,t]=a();return{apply:(t,n)=>t.add(n).plus(e),how:(e,n)=>`${i(e)} + ${s(n)} ${t}`}},"(x,y)=>x-y+b":()=>{let[e,t]=a();return{apply:(t,n)=>t.minus(n).plus(e),how:(e,n)=>`${i(e)} - ${s(n)} ${t}`}},"(x,y)=>y-x+b":()=>{let[e,t]=a();return{apply:(t,n)=>n.minus(t).plus(e),how:(e,n)=>`${s(n)} - ${i(e)} ${t}`}},"(x,y)=>x*y":()=>({apply:(e,t)=>e.mul(t),how:(e,t)=>`${i(e)} xx ${s(t)}`}),"(x,y)=>x/y":()=>({apply:(e,t)=>e.div(t),how:(e,t)=>`${i(e)} -: ${s(t)}`}),"(x,y)=>y/x":()=>({apply:(e,t)=>t.div(e),how:(e,t)=>`${s(t)} -: ${i(e)}`}),"(x,y)=>(x+y)*b":()=>{let[e,t]=u();return{apply:(t,n)=>t.plus(n).mul(e),how:(e,n)=>`(${i(e)} + ${s(n)}) xx ${t}`}},"(x,y)=>(x-y)*b":()=>{let[e,t]=u();return{apply:(t,n)=>t.minus(n).mul(e),how:(e,n)=>`(${i(e)} - ${s(n)}) xx ${t}`}},"(x,y)=>(y-x)*b":()=>{let[e,t]=u();return{apply:(t,n)=>n.minus(t).mul(e),how:(e,n)=>`(${s(n)} - ${i(e)}) xx ${t}`}},"(x,y)=>(x+y)/b":()=>{let[e,t]=u();return{apply:(t,n)=>t.plus(n).div(e),how:(e,n)=>`(${i(e)} + ${s(n)}) -: ${t}`}},"(x,y)=>(x-y)/b":()=>{let[e,t]=u();return{apply:(t,n)=>t.minus(n).div(e),how:(e,n)=>`(${i(e)} - ${s(n)}) -: ${t}`}},"(x,y)=>(y-x)/b":()=>{let[e,t]=u();return{apply:(t,n)=>n.minus(t).div(e),how:(e,n)=>`(${s(n)} - ${i(e)}) -: ${t}`}},"(x,y)=>x*y+b":()=>{let[e,t]=a();return{apply:(t,n)=>t.mul(n).plus(e),how:(e,n)=>`${i(e)} xx ${s(n)} ${t}`}},"(x,y)=>x/y+b":()=>{let[e,t]=a();return{apply:(t,n)=>t.div(n).plus(e),how:(e,n)=>`${i(e)} -: ${s(n)} ${t}`}},"(x,y)=>y/x+b":()=>{let[e,t]=a();return{apply:(t,n)=>n.div(t).plus(e),how:(e,n)=>`${s(n)} -: ${i(e)} ${t}`}}};function l(e){let t=c[e];return assert(t,`Can't find lambda definition for '${e}'`),t()}return{fromStr:l,get:e=>l(e)}}function makeLambdas({args:e,genLnNo:t,options:n,fmt:r}){function u(){let[n,u]=e.rand(["a","b"],t),[a,o]=DFmt.formats([n,u],r),i=u.lt(0)?"-":"+",s=DFmt.format(u.abs(),r);return{a:n,b:u,sA:a,sB:o,opB:`${i} ${s}`}}let a={"x=>x*a+b":()=>{let{a:e,b:t,sA:n,sB:r,opB:a}=u();return{apply:n=>n.mul(e).plus(t),how:e=>`square xx ${n} ${a}`}},"x=>x/a+b":()=>{let{a:e,b:t,sA:n,sB:r,opB:a}=u();return{apply:n=>n.div(e).plus(t),how:e=>`square -: ${n} ${a}`}},"x=>(x+b)*a":()=>{let{a:e,b:t,sA:n,sB:r,opB:a}=u();return{apply:n=>n.plus(t).mul(e),how:e=>`(square ${a}) xx ${n}`}},"x=>(x+b)/a":()=>{let{a:e,b:t,sA:n,sB:r,opB:a}=u();return{apply:n=>n.plus(t).div(e),how:e=>`(square ${a}) -: ${n}`}},"x=>digitSum(x)":()=>({apply:e=>function(e){let t=n2d$1(0);for(;e.gt(0);){let n=e.mod(10);t=t.plus(n),e=e.minus(n).div(10)}return t}(e),how:e=>"1+2+3 lArr 123"}),"x=>digitRev(x)":()=>({apply:e=>function(e){let t="";for(;e.gt(0);){let n=e.mod(10);t+=d2n(n),e=e.minus(n).div(10)}return t2d(t)}(e),how:e=>"321 lArr 123"})};function o(e){let t=a[e];return assert(t,`Can't find lambda definition for '${e}'`),t()}return{fromStr:o,get:e=>o(e)}}function opToAscii(e){switch(e){case"":return"o+";case"":return"o.";case"":return"ox";case"&":return'\\ "&"\\ ';case"@":return'\\ "@"\\ ';case"#":return'\\ "#"\\ ';case"":return"***";case"":return"nnn";case"":return"/_\\";default:return e}}function apply({fn:e,a:t,b:n,x:r,y:u}){return e(r,u)}function calc({def:def,a:a,b:b,x:x,y:y}){let fn=eval(def),r=apply({fn:fn,a:d2n(a),b:d2n(b),x:d2n(x),y:d2n(y)});return n2d$1(r)}function makeSqModel(e,{numberOfLinesInGeneratorCell:t}=Config){let{content:n,viewTemplate:r,options:u}=e,a=rand(t),o=({A:e,fmt:t,n:n,value:r,prefix:u,op:a})=>{let o=`${u}${e}${n}`,i=DFmt.format(r,t);return newVariable({name:o,view:`${"+"===a&&r.lt(0)?"":a}${i}`,value:r,fmt:t})};function i(e,{A:t,fmt:n}){let r=[],u=(e,u,a,i)=>{r.push(o({A:t,fmt:n,n:e,value:u,prefix:a,op:i}))};for(let t=1;t<e.length;t++){let n=e[t].value.minus(e[t-1].value),r=e[t].value.div(e[t-1].value),a=e[t-1].value.div(e[t].value);u(t,n,"+","+"),u(t,r,"*","xx"),u(t,a,"/","-:")}return r}function s({template:e,vars:t,variate:n=!1}){let r=e;return t.forEach((e=>r=e.toUniqueName(r))),t.forEach((e=>r=e.toView({str:r,variate:n}))),r}let c=e.problemId,l=function(){let e=range(n.numOfLines),t=u.get("formulas");return t&&(e=newCellAsRandomGenerator(t).all().map((e=>e-1)),console.log("Filtering formulas to ",e)),range(n.numOfLines).filter((t=>e.includes(t)))}(),f=function(e){let t=new Map;for(let r of e){let e=n.at("formula",r).splitTrim("|")[1]??"default",u=t.get(e)??[];u.push(r),t.set(e,u)}let r=randFrom([...t.keys()]);return t.get(r)}(l);assert(f.length>0,"Failed to group formulas in definition");let d=function(t){return t.map((t=>Formulas.makeFormula({args:n[t],options:e.options,genLnNo:a,nCount:e.nCount})))}(f),p=function(e){let t=e.map((e=>{let t=e.makeSequence(),n=e.makeVariables();return{formula:e,seq:t,vars:n,diffs:i(t,e)}})),n=t[0].seq.map(((e,n)=>t.map((e=>e.seq[n])))).flat(),r=DFmt.parse(t[0].formula.fmt,...t.map((e=>e.formula.fmt))),u=i(n,{A:"",fmt:r}),a=function(e,{A:t,fmt:n}){let r=[],u=(e,u,a,i)=>{r.push(o({A:t,fmt:n,n:e,value:u,prefix:a,op:i}))},a=e.filter((e=>e.name.startsWith("+")));for(let e=1;e<a.length;e++){let t=a[e].value.minus(a[e-1].value),n=a[e].value.div(a[e-1].value);u(e+1,t,"++","+"),u(e+1,n,"+*","xx")}return r}(u,{A:"",fmt:r});return u.concat(a,...t.map((e=>[e.seq,e.vars,e.diffs])).flat()).sort(((e,t)=>t.name.length-e.name.length))}(d),m=function(t){assert(e.answers.count>0,"No answers in definition");let n=e.answers.all().filter((e=>e.trim().length>0)).map(((e,n)=>({isRight:0==n,value:s({template:e,vars:t,variate:!0})}))).removeDuplicates(((e,t)=>e.value===t.value)),[r,...u]=n;return[r,...shuffle(u).take(3)]}(p),g=function(e,t){let n=r.map((t=>t.map((t=>s({template:t,vars:e})))));return n}(p),h=e.settings;return{problemId:c,content:n,settings:h,view:g,answers:m,options:u}}function makeCell({row:e,col:t,content:n,canBeQuestion:r=!1,stateNo:u,options:a}){let o=`${String.fromCharCode(65+t)}${e+1}`,i=function(e){return e?e.includes("|")?e.split("|"):[e,""]:["",""]}(n);return i[0]=function(e){if(!e.includes("?"))return e;if("?"===e)return e;let[t,n]=e.split(":");return r?`?${n?`:${n}`:""}`:e.replace("?","")}(i[0]),i[1]=i[1].replace("?",""),{name:o,states:i,stateNo:u,options:a}}function makeSqStore(e){let t=writable(0),n=e.view,r=e.options;let u=function(){let[u,a]=[n.length,n[0].length],o=[],i=e.content.formula.includes("lambda")||e.content.formula.includes("magic-box");for(let e=0;e<u;e++){let u=[];for(let o=0;o<a;o++){let a=n[e][o]??"";u.push(makeCell({row:e,col:o,content:a,stateNo:t,canBeQuestion:i,options:r}))}o.push(u)}return o}(),a=shuffle(e.answers.map((e=>({value:e.value,isRight:e.isRight,isClicked:writable(!1)}))));return{stateNo:t,view:n,sheet:u,answers:a,options:r}}function create_key_block$1(e){let t,n,r,u,a,o=e[4](e[2])+"";return{c(){t=element("span"),n=text(o),attr(t,"class",r="w-full h-full text-center "+e[0]+" "+e[1]+" svelte-1hcdu93"),set_style(t,"grid-area",e[5])},m(r,o){insert(r,t,o),append(t,n),u||(a=listen(t,"click",e[11]),u=!0)},p(e,u){4&u&&o!==(o=e[4](e[2])+"")&&set_data(n,o),3&u&&r!==(r="w-full h-full text-center "+e[0]+" "+e[1]+" svelte-1hcdu93")&&attr(t,"class",r)},d(e){e&&detach(t),u=!1,a()}}}function create_fragment$4(e){let t,n=e[3],r=create_key_block$1(e);return{c(){r.c(),t=empty()},m(e,n){r.m(e,n),insert(e,t,n)},p(e,[u]){8&u&&safe_not_equal(n,n=e[3])?(r.d(1),r=create_key_block$1(e),r.c(),r.m(t.parentNode,t)):r.p(e,u)},i:noop,o:noop,d(e){e&&detach(t),r.d(e)}}}Formulas.registerFactory("h-table",op_table),Formulas.registerFactory("v-table",op_table),Formulas.registerFactory("lambda",(({args:e,genLnNo:t,options:n})=>{let r=e.at("lambda"),u=e.atLnNo(["x0","y0","y1","y2","y3"],t),a=DFmt.parse(u),[o,i,s,c,l]=e.rand(["x0","y0","y1","y2","y3"],t),f=makeLambdas$1({args:e,genLnNo:t,options:n,fmt:a}),d=log.onerror((()=>f.fromStr(r)),(e=>_l(e,{def:r,_x0y0:u,fmt:a}))),p=d.apply(o,i),m=d.apply(p,s),g=d.apply(m,c),h=d.apply(g,l),_=(e,t)=>newVariable({name:t,view:DFmt.format(e,a),value:e,fmt:a}),D=(e,t,n)=>{let r=`how${e}`,[u,o]=DFmt.formats([t,n],a);return newVariable({name:r,view:d.how(u,o),value:t,fmt:a})};return{A:"",fmt:a,makeSequence:function(){return[_(o,"x0"),_(p,"x1"),_(m,"x2"),_(g,"x3"),_(h,"x4"),_(i,"y0"),_(s,"y1"),_(c,"y2"),_(l,"y3")]},makeVariables:function(){return[D(1,o,i),D(2,p,s),D(3,m,c),D(4,g,l)]}}})),Formulas.registerFactory(["+(a+)*(b+)","+(a+)+(b+)"],(({args:e,genLnNo:t,nCount:n})=>{let r=e.get("formula").includes(")*(")?(e,t)=>e.mul(t):(e,t)=>e.plus(t),u=e.subst,a=e.atLnNo(["a0","pa0","dpa","pb0","dpb"],t),o=u.split(":")[0],[i,s,c,l,f]=e.rand(["a0","pa0","dpa","pb0","dpb"],t),d=DFmt.parse(u,...a),p=(e,t)=>newVariable({name:`${o}${e}`,view:DFmt.format(t,d),value:t,fmt:d});return{A:o,fmt:d,makeSequence:function(){let[e,t,u]=[i,s,l],a=[p(0,e)];for(let o=1;o<=n;o++)o%2==1?(e=e.plus(t),t=t.plus(c)):(e=r(e,u),u=u.plus(f)),a.push(p(o,e));return a},makeVariables:function(){return[]}}})),Formulas.registerFactory("magic-box",(({args:e,genLnNo:t,options:n})=>{let{maxRetriesOnSameInput:r}=Config,u=e.at("lambda"),a=e.atLnNo(["a0","b0","c0","d0","e0"],t),o=DFmt.parse(a),[i,s,c,l,f]=takeIf(r,(()=>e.rand(["a0","b0","c0","d0","e0"],t)),(e=>e.hasUniqueValues())),d=makeLambdas({args:e,genLnNo:t,options:n,fmt:o}),p=log.onerror((()=>d.fromStr(u)),(e=>_l(e,{def:u,_a0b0:a,fmt:o}))),m=p.apply(i),g=p.apply(s),h=p.apply(c),_=p.apply(l),D=p.apply(f),$=(e,t)=>newVariable({name:t,view:DFmt.format(e,o),value:e,fmt:o}),y=e=>{let t=DFmt.format(e,o);return newVariable({name:"how",view:p.how(t),value:e,fmt:o})};return{A:"",fmt:o,makeSequence:function(){return[$(i,"a0"),$(s,"b0"),$(c,"c0"),$(l,"d0"),$(f,"e0"),$(m,"a1"),$(g,"b1"),$(h,"c1"),$(_,"d1"),$(D,"e1")]},makeVariables:function(){return[y(i)]}}})),Formulas.registerFactory("math-op",(({args:e,genLnNo:t,options:n})=>{let r=e.atLnNo(["a","b","x","y"],t),u=DFmt.parse(r),[a,o,i,s]=e.rand(["a","b","x","y"],t),[c,l,f]=e.atLnNo(["def","X","Y"],t),d=e.rand_str("op",t),p=e.lines("lambda"),m=calc({def:p[0],a:a,b:o,x:i,y:s}),g=calc({def:p[1],a:a,b:o,x:i,y:s}),h=calc({def:p[2],a:a,b:o,x:i,y:s}),_=calc({def:p[3],a:a,b:o,x:i,y:s}),[D,$]=DFmt.formats([a,o],u);c=c.replaceAll("a",D).replaceAll("b",$).replaceAll("X",l).replaceAll("Y",f);let y=opToAscii(d),v=(e,t)=>newVariable({name:t,view:DFmt.format(e,u),value:e,fmt:u}),b=(e,t)=>newVariable({name:t,view:e,value:n2d$1(0),fmt:u});return{A:"",fmt:u,makeSequence:function(){return[v(i,"x"),v(s,"y")]},makeVariables:function(){return[b(l,"X"),b(f,"Y"),b(D,"a"),b($,"b"),b(y,"op"),b(c,"def"),v(m,"r0"),v(g,"r1"),v(h,"r2"),v(_,"r3")]}}}));const tmpDivUnique="__//__";function instance$4(e,t,n){let r,u,a,o,i,s,c=e=>e.replaceAll("-:",tmpDivUnique).split(":")[1];function l(e){if(!e)return"";e=e.replaceAll("-:",tmpDivUnique);let[t,n]=e.split(":");return t=t.replaceAll(tmpDivUnique,"-:"),t}let{cell:f}=t,{name:d,states:p,stateNo:m,options:g}=f;component_subscribe(e,m,(e=>n(10,i=e)));let h=writable({});component_subscribe(e,h,(e=>n(3,s=e)));let _=g.get("text-seq")??"text-xl";return e.$$set=e=>{"cell"in e&&n(8,f=e.cell)},e.$$.update=()=>{1024&e.$$.dirty&&n(9,r=p[i]??""),512&e.$$.dirty&&n(2,u=l(r)),512&e.$$.dirty&&n(1,a=function(e,t){let n=c(e);do{if(!n)break;if(n.includes("g"))return"bg-green-100";if(n.includes("y"))return"bg-yellow-100";if(n.includes("r"))return"bg-red-100";if(n.includes("b"))return"bg-blue-100";if(n.includes("w"))return"bg-white"}while(0);return t}(r,"bg-white")),512&e.$$.dirty&&n(0,o=function(e,t){let n=c(e),r=g.get("text-diff")??"text-xs";do{if(!n)break;if(n.includes("1"))return r;if(n.includes("2"))return r}while(0);return t}(r,_)),1024&e.$$.dirty&&function(e,t){l(e[0])!==l(e[1])&&h.set({})}(p)},[o,a,u,s,e=>e.length>0?"`"+e+"`":"",d,m,h,f,r,i,function(t){bubble.call(this,e,t)}]}class Sq_Cell extends SvelteComponent{constructor(e){super(),init(this,e,instance$4,create_fragment$4,safe_not_equal,{cell:8})}}function get_each_context$1(e,t,n){const r=e.slice();return r[6]=t[n],r}function get_each_context_1(e,t,n){const r=e.slice();return r[9]=t[n],r}function create_each_block_1(e){let t,n;return t=new Sq_Cell({props:{cell:e[9]}}),t.$on("click",e[4]),{c(){create_component(t.$$.fragment)},m(e,r){mount_component(t,e,r),n=!0},p:noop,i(e){n||(transition_in(t.$$.fragment,e),n=!0)},o(e){transition_out(t.$$.fragment,e),n=!1},d(e){destroy_component(t,e)}}}function create_each_block$1(e){let t,n,r=e[6],u=[];for(let t=0;t<r.length;t+=1)u[t]=create_each_block_1(get_each_context_1(e,r,t));const a=e=>transition_out(u[e],1,1,(()=>{u[e]=null}));return{c(){for(let e=0;e<u.length;e+=1)u[e].c();t=empty()},m(e,r){for(let t=0;t<u.length;t+=1)u[t].m(e,r);insert(e,t,r),n=!0},p(e,n){if(2&n){let o;for(r=e[6],o=0;o<r.length;o+=1){const a=get_each_context_1(e,r,o);u[o]?(u[o].p(a,n),transition_in(u[o],1)):(u[o]=create_each_block_1(a),u[o].c(),transition_in(u[o],1),u[o].m(t.parentNode,t))}for(group_outros(),o=r.length;o<u.length;o+=1)a(o);check_outros()}},i(e){if(!n){for(let e=0;e<r.length;e+=1)transition_in(u[e]);n=!0}},o(e){u=u.filter(Boolean);for(let e=0;e<u.length;e+=1)transition_out(u[e]);n=!1},d(e){destroy_each(u,e),e&&detach(t)}}}function create_default_slot$2(e){let t,n,r=e[1],u=[];for(let t=0;t<r.length;t+=1)u[t]=create_each_block$1(get_each_context$1(e,r,t));const a=e=>transition_out(u[e],1,1,(()=>{u[e]=null}));return{c(){for(let e=0;e<u.length;e+=1)u[e].c();t=empty()},m(e,r){for(let t=0;t<u.length;t+=1)u[t].m(e,r);insert(e,t,r),n=!0},p(e,n){if(2&n){let o;for(r=e[1],o=0;o<r.length;o+=1){const a=get_each_context$1(e,r,o);u[o]?(u[o].p(a,n),transition_in(u[o],1)):(u[o]=create_each_block$1(a),u[o].c(),transition_in(u[o],1),u[o].m(t.parentNode,t))}for(group_outros(),o=r.length;o<u.length;o+=1)a(o);check_outros()}},i(e){if(!n){for(let e=0;e<r.length;e+=1)transition_in(u[e]);n=!0}},o(e){u=u.filter(Boolean);for(let e=0;e<u.length;e+=1)transition_out(u[e]);n=!1},d(e){destroy_each(u,e),e&&detach(t)}}}function create_fragment$3(e){let t,n;return t=new Grid({props:{layout:e[2],ga:e[0],bgColor:"bg-gray-100",clazz:"border border-gray-100",style:"grid-gap: 1px;",$$slots:{default:[create_default_slot$2]},$$scope:{ctx:e}}}),{c(){create_component(t.$$.fragment)},m(e,r){mount_component(t,e,r),n=!0},p(e,[n]){const r={};1&n&&(r.ga=e[0]),4096&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(transition_in(t.$$.fragment,e),n=!0)},o(e){transition_out(t.$$.fragment,e),n=!1},d(e){destroy_component(t,e)}}}function instance$3(e,t,n){let{ga:r}=t,{store:u}=t,{sheet:a}=u;let o=function(){let e=[],t="",n="",r="";return a.forEach(((n,u)=>{n.forEach((t=>{e[u]||(e[u]=""),e[u]+=`${t.name} `})),r+="1fr ",t+=`"${e[u]}" `})),a.length>0&&a[0].forEach((e=>n+="1fr ")),{areas:t,cols:n,rows:r}}();return e.$$set=e=>{"ga"in e&&n(0,r=e.ga),"store"in e&&n(3,u=e.store)},[r,a,o,u,function(t){bubble.call(this,e,t)}]}class Sq_Sheet extends SvelteComponent{constructor(e){super(),init(this,e,instance$3,create_fragment$3,safe_not_equal,{ga:0,store:3})}}function create_fragment$2(e){let t,n,r,u,a,o;return{c(){t=element("button"),n=text("`"),r=text(e[2]),u=text("`"),attr(t,"class",e[1]),set_style(t,"grid-area",e[0])},m(i,s){insert(i,t,s),append(t,n),append(t,r),append(t,u),a||(o=[action_destroyer(pulse.call(null,t)),action_destroyer(bounceOnDrag.call(null,t)),listen(t,"click",e[6])],a=!0)},p(e,[n]){2&n&&attr(t,"class",e[1]),1&n&&set_style(t,"grid-area",e[0])},i:noop,o:noop,d(e){e&&detach(t),a=!1,run_all(o)}}}function instance$2(e,t,n){let r,u,{ga:a}=t,{store:o}=t,{value:i,isClicked:s,isRight:c}=o;return component_subscribe(e,s,(e=>n(5,u=e))),e.$$set=e=>{"ga"in e&&n(0,a=e.ga),"store"in e&&n(4,o=e.store)},e.$$.update=()=>{32&e.$$.dirty&&n(1,r=u?c?"bg-green-200":"bg-red-200":"bg-gray-100")},[a,r,i,s,o,u,function(t){bubble.call(this,e,t)}]}class Sq_Ans extends SvelteComponent{constructor(e){super(),init(this,e,instance$2,create_fragment$2,safe_not_equal,{ga:0,store:4})}}function get_each_context(e,t,n){const r=e.slice();return r[29]=t[n],r[31]=n,r}function create_if_block_1(e){let t,n;return t=new Progress2({props:{ga:"prg",store:e[5]}}),{c(){create_component(t.$$.fragment)},m(e,r){mount_component(t,e,r),n=!0},p:noop,i(e){n||(transition_in(t.$$.fragment,e),n=!0)},o(e){transition_out(t.$$.fragment,e),n=!1},d(e){destroy_component(t,e)}}}function create_each_block(e){let t,n;return t=new Sq_Ans({props:{store:e[29],ga:`a${e[31]}`}}),t.$on("click",(function(){return e[15](e[31])})),{c(){create_component(t.$$.fragment)},m(e,r){mount_component(t,e,r),n=!0},p(n,r){e=n;const u={};1&r[0]&&(u.store=e[29]),t.$set(u)},i(e){n||(transition_in(t.$$.fragment,e),n=!0)},o(e){transition_out(t.$$.fragment,e),n=!1},d(e){destroy_component(t,e)}}}function create_key_block(e){let t,n,r,u;t=new Sq_Sheet({props:{ga:"sh",store:e[0]}}),t.$on("click",e[14]);let a=e[0].answers,o=[];for(let t=0;t<a.length;t+=1)o[t]=create_each_block(get_each_context(e,a,t));const i=e=>transition_out(o[e],1,1,(()=>{o[e]=null}));return{c(){create_component(t.$$.fragment),n=space();for(let e=0;e<o.length;e+=1)o[e].c();r=empty()},m(e,a){mount_component(t,e,a),insert(e,n,a);for(let t=0;t<o.length;t+=1)o[t].m(e,a);insert(e,r,a),u=!0},p(e,n){const u={};if(1&n[0]&&(u.store=e[0]),t.$set(u),2049&n[0]){let t;for(a=e[0].answers,t=0;t<a.length;t+=1){const u=get_each_context(e,a,t);o[t]?(o[t].p(u,n),transition_in(o[t],1)):(o[t]=create_each_block(u),o[t].c(),transition_in(o[t],1),o[t].m(r.parentNode,r))}for(group_outros(),t=a.length;t<o.length;t+=1)i(t);check_outros()}},i(e){if(!u){transition_in(t.$$.fragment,e);for(let e=0;e<a.length;e+=1)transition_in(o[e]);u=!0}},o(e){transition_out(t.$$.fragment,e),o=o.filter(Boolean);for(let e=0;e<o.length;e+=1)transition_out(o[e]);u=!1},d(e){destroy_component(t,e),e&&detach(n),destroy_each(o,e),e&&detach(r)}}}function create_if_block(e){let t,n,r={ga:"tm",seconds:e[4].settings.timer,onExpiration:e[16]};return t=new Timer({props:r}),e[17](t),{c(){create_component(t.$$.fragment)},m(e,r){mount_component(t,e,r),n=!0},p(e,n){t.$set({})},i(e){n||(transition_in(t.$$.fragment,e),n=!0)},o(e){transition_out(t.$$.fragment,e),n=!1},d(n){e[17](null),destroy_component(t,n)}}}function create_default_slot$1(e){let t,n,r,u,a,o,i=e[0];t=new Congrats({props:{}}),e[13](t);let s=e[3]&&create_if_block_1(e),c=create_key_block(e),l=e[7]&&create_if_block(e);return{c(){create_component(t.$$.fragment),n=space(),s&&s.c(),r=space(),c.c(),u=space(),l&&l.c(),a=empty()},m(e,i){mount_component(t,e,i),insert(e,n,i),s&&s.m(e,i),insert(e,r,i),c.m(e,i),insert(e,u,i),l&&l.m(e,i),insert(e,a,i),o=!0},p(e,n){t.$set({}),e[3]?s?(s.p(e,n),8&n[0]&&transition_in(s,1)):(s=create_if_block_1(e),s.c(),transition_in(s,1),s.m(r.parentNode,r)):s&&(group_outros(),transition_out(s,1,1,(()=>{s=null})),check_outros()),1&n[0]&&safe_not_equal(i,i=e[0])?(group_outros(),transition_out(c,1,1,noop),check_outros(),c=create_key_block(e),c.c(),transition_in(c,1),c.m(u.parentNode,u)):c.p(e,n),e[7]&&l.p(e,n)},i(e){o||(transition_in(t.$$.fragment,e),transition_in(s),transition_in(c),transition_in(l),o=!0)},o(e){transition_out(t.$$.fragment,e),transition_out(s),transition_out(c),transition_out(l),o=!1},d(o){e[13](null),destroy_component(t,o),o&&detach(n),s&&s.d(o),o&&detach(r),c.d(o),o&&detach(u),l&&l.d(o),o&&detach(a)}}}function create_fragment$1(e){let t,n;return t=new Grid({props:{layout:e[12],$$slots:{default:[create_default_slot$1]},$$scope:{ctx:e}}}),t.$on("click",e[18]),{c(){create_component(t.$$.fragment)},m(e,r){mount_component(t,e,r),n=!0},p(e,n){const r={};15&n[0]|2&n[1]&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(transition_in(t.$$.fragment,e),n=!0)},o(e){transition_out(t.$$.fragment,e),n=!1},d(e){destroy_component(t,e)}}}function instance$1(e,t,n){let r,u,a,o,i=!1,s=!1;onMount((()=>{applyAsciiMath(1e3)}));let c=log.onerror((()=>makeSqDefinition()),(e=>_l(e))),l=log.onerror((()=>makeSqModel(c)),(e=>_l(e))),f=log.onerror((()=>makeSqStore(l)),(e=>_l(e))),d=makeProgress({doneCount:l.settings.rounds,onDone:()=>(a.play(),void(s=!0))}),p=d.isOn;component_subscribe(e,p,(e=>n(3,u=e)));let m=c.settings.timer>0;function g(){d.addWork(),o.restart()}function h(){i&&$()}function _(){l=makeSqModel(c),n(0,f=makeSqStore(l)),i=!1,r.set(0),s&&d.addWork(),applyAsciiMath(200)}function D(){i&&_()}function $(){r.update((e=>0===e?1:0)),applyAsciiMath(100)}function y(){d.rightClick(),function(){let e=f.options.v2i("auto-next");e&&setTimeout((()=>D()),e)}()}function v(e){i?_():(f.answers[e].isRight?y():d.wrongClick(),i=!0,f.answers.forEach(((e,t)=>e.isClicked.set(f.answers[t].isRight))),f.answers[e].isClicked.set(!0),$())}let b={areas:'\n            "prg  prg  prg"\n            "sh   sh   sh "\n            "a0    .   a1 "\n            "a2    .   a3 "\n            "tm   tm   tm "\n        ',cols:"2fr 1fr 2fr",rows:"10px 10fr 2fr 2fr 10px"};return e.$$.update=()=>{1&e.$$.dirty[0]&&(r=f.stateNo)},[f,a,o,u,c,d,p,m,g,h,D,v,b,function(e){binding_callbacks[e?"unshift":"push"]((()=>{a=e,n(1,a)}))},()=>h(),e=>v(e),()=>g(),function(e){binding_callbacks[e?"unshift":"push"]((()=>{o=e,n(2,o)}))},()=>D()]}class Sq_View extends SvelteComponent{constructor(e){super(),init(this,e,instance$1,create_fragment$1,safe_not_equal,{},null,[-1,-1])}}function create_default_slot(e){let t,n,r,u,a,o,i;var s=e[0]();return s&&(n=construct_svelte_component(s,{})),u=new Powered({props:{ga:"pwrd",text:"Powered by gebemot.online"}}),o=new Version({props:{ga:"ver",v:"0.33.3"}}),{c(){t=element("div"),n&&create_component(n.$$.fragment),r=space(),create_component(u.$$.fragment),a=space(),create_component(o.$$.fragment),attr(t,"class","w-full h-full"),set_style(t,"grid-area","game")},m(e,s){insert(e,t,s),n&&mount_component(n,t,null),insert(e,r,s),mount_component(u,e,s),insert(e,a,s),mount_component(o,e,s),i=!0},p(e,r){if(s!==(s=e[0]())){if(n){group_outros();const e=n;transition_out(e.$$.fragment,1,0,(()=>{destroy_component(e,1)})),check_outros()}s?(n=construct_svelte_component(s,{}),create_component(n.$$.fragment),transition_in(n.$$.fragment,1),mount_component(n,t,null)):n=null}},i(e){i||(n&&transition_in(n.$$.fragment,e),transition_in(u.$$.fragment,e),transition_in(o.$$.fragment,e),i=!0)},o(e){n&&transition_out(n.$$.fragment,e),transition_out(u.$$.fragment,e),transition_out(o.$$.fragment,e),i=!1},d(e){e&&detach(t),n&&destroy_component(n),e&&detach(r),destroy_component(u,e),e&&detach(a),destroy_component(o,e)}}}function create_fragment(e){let t,n,r,u;return t=new Grid({props:{layout:e[1],$$slots:{default:[create_default_slot]},$$scope:{ctx:e}}}),r=new Logger({}),{c(){create_component(t.$$.fragment),n=space(),create_component(r.$$.fragment)},m(e,a){mount_component(t,e,a),insert(e,n,a),mount_component(r,e,a),u=!0},p(e,[n]){const r={};4&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){u||(transition_in(t.$$.fragment,e),transition_in(r.$$.fragment,e),u=!0)},o(e){transition_out(t.$$.fragment,e),transition_out(r.$$.fragment,e),u=!1},d(e){destroy_component(t,e),e&&detach(n),destroy_component(r,e)}}}function instance(e){return onMount((()=>{Anki.hideLoader(),initMath()})),[function(){try{let e=Anki.getConfig();switch(Mp3.buildMp3Library("assets",e.soundOn),e.game){case"plus-over":case"mul-div":return Main$4;case"gcd-lcm":return Main$3;case"zero":return Main$2;case"equ-abc":return Main$1;case"fr-pairs":return Main;case"w-problem":return WProblem_View;case"sequence":return Sq_View;default:return log.error(`Unknown game type: '${e.game}'`,(e=>_l(e))),Oops}}catch(e){log.error("Failed to loadGame",e,(e=>_l(e)))}},{areas:'\n            "game  game  game  game"\n            "pwrd  pwrd  .     ver"\n        ',cols:"1fr 1fr 1ft 1fr",rows:"98fr 2fr"}]}class App extends SvelteComponent{constructor(e){super(),init(this,e,instance,create_fragment,safe_not_equal,{})}}const app=new App({target:document.body});return app}();
//# sourceMappingURL=bundle.js.map
